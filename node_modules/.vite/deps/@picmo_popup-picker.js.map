{
  "version": 3,
  "sources": ["../../emojibase/esm/index.js", "../../picmo/src/util.ts", "../../picmo/src/data/DataStore.ts", "../../picmo/src/rules.ts", "../../picmo/src/data/InMemoryStore.ts", "../../picmo/src/data/emojiData.ts", "../../picmo/src/focusTrap.ts", "../../picmo/src/themes.ts", "../../picmo/src/views/view.ts", "../../picmo/src/icons/clock-solid.svg?raw", "../../picmo/src/icons/flag-solid.svg?raw", "../../picmo/src/icons/face-frown-open-solid.svg?raw", "../../picmo/src/icons/gamepad-solid.svg?raw", "../../picmo/src/icons/lightbulb-solid.svg?raw", "../../picmo/src/icons/mug-saucer-solid.svg?raw", "../../picmo/src/icons/plane-solid.svg?raw", "../../picmo/src/icons/robot-solid.svg?raw", "../../picmo/src/icons/face-sad-tear-solid.svg?raw", "../../picmo/src/icons/magnifying-glass-solid.svg?raw", "../../picmo/src/icons/face-grin-solid.svg?raw", "../../picmo/src/icons/icons-solid.svg?raw", "../../picmo/src/icons/tree-solid.svg?raw", "../../picmo/src/icons/user-group-solid.svg?raw", "../../picmo/src/icons/triangle-exclamation-solid.svg?raw", "../../picmo/src/icons/xmark-solid.svg?raw", "../../picmo/src/icons/index.ts", "../../picmo/src/Template.ts", "../../picmo/src/views/Image.ts", "../../picmo/src/renderers/renderer.ts", "../../picmo/src/renderers/native.ts", "../../picmo/src/i18n/lang-en.ts", "../../picmo/src/data/IndexedDbStore.ts", "../../picmo/src/webStorageShim.ts", "../../picmo/src/recents/RecentsProvider.ts", "../../picmo/src/recents/WebStorageProvider.ts", "../../picmo/src/recents/LocalStorageProvider.ts", "../../picmo/src/options.ts", "../../picmo/src/events.ts", "../../picmo/src/globalConfig.ts", "../../picmo/src/AppEvents.ts", "../../picmo/src/ExternalEvents.ts", "../../picmo/src/views/BaseEmojiCategory.ts", "../../picmo/src/views/Emoji.template.ts", "../../picmo/src/views/Emoji.ts", "../../picmo/src/focusGrid.ts", "../../picmo/src/views/EmojiContainer.template.ts", "../../picmo/src/views/EmojiContainer.ts", "../../picmo/src/views/EmojiCategory.template.ts", "../../picmo/src/views/EmojiCategory.ts", "../../picmo/src/views/RecentEmojiContainer.ts", "../../picmo/src/views/RecentEmojiCategory.template.ts", "../../picmo/src/views/RecentEmojiCategory.ts", "../../picmo/src/views/CustomEmojiCategory.template.ts", "../../picmo/src/views/CustomEmojiCategory.ts", "../../picmo/src/LazyLoader.ts", "../../picmo/src/views/EmojiArea.ts", "../../picmo/src/views/ErrorMessage.template.ts", "../../picmo/src/views/ErrorMessage.ts", "../../picmo/src/views/DataError.template.ts", "../../picmo/src/views/DataError.ts", "../../picmo/src/views/Preview.ts", "../../picmo/src/views/Search.template.ts", "../../picmo/src/views/Search.ts", "../../picmo/src/views/VariantPopup.template.ts", "../../picmo/src/views/VariantPopup.ts", "../../picmo/src/views/CategoryTab.template.ts", "../../picmo/src/views/CategoryTab.ts", "../../picmo/src/views/CategoryTabs.template.ts", "../../picmo/src/views/CategoryTabs.ts", "../../picmo/src/emojiSupport.ts", "../../picmo/src/views/EmojiPicker.template.ts", "../../picmo/src/views/EmojiPicker.ts", "../../picmo/src/viewFactory.ts", "../../picmo/src/i18n/bundle.ts", "../../style-inject/dist/style-inject.es.js", "../../picmo/src/injectStyles.ts", "../../picmo/src/createPicker.ts", "../../picmo/src/i18n/lang-de.ts", "../../picmo/src/i18n/lang-fi.ts", "../../picmo/src/i18n/lang-fr.ts", "../../picmo/src/i18n/lang-nl.ts", "../../picmo/src/i18n/lang-no.ts", "../../picmo/src/i18n/lang-sv.ts", "../../picmo/src/recents/SessionStorageProvider.ts", "../../picmo/src/recents/InMemoryProvider.ts", "../../picmo/src/index.ts", "../../node_modules/@floating-ui/core/dist/floating-ui.core.esm.js", "../../node_modules/@floating-ui/dom/dist/floating-ui.dom.esm.js", "../../@picmo/popup-picker/src/positioning.ts", "../../@picmo/popup-picker/src/options.ts", "../../@picmo/popup-picker/src/icons/close.svg?raw", "../../@picmo/popup-picker/src/popupPicker.ts", "../../@picmo/popup-picker/src/index.ts"],
  "sourcesContent": ["// Bundled with Packemon: https://packemon.dev\n// Platform: browser, Support: stable, Format: esm\n\n/**\n * Append a skin tone index (number) to the end of a shortcode.\n */\nfunction appendSkinToneIndex(shortcode, emoji, prefix = '') {\n  return `${shortcode}_${prefix}${Array.isArray(emoji.tone) ? emoji.tone.join('-') : emoji.tone}`;\n}\n\nconst SEQUENCE_REMOVAL_PATTERN = /200D|FE0E|FE0F/g; // Use numbers instead of string values, as the filesize is greatly reduced.\n\nconst TEXT = 0;\nconst EMOJI = 1;\nconst FEMALE = 0;\nconst MALE = 1;\nconst FULLY_QUALIFIED = 0;\nconst MINIMALLY_QUALIFIED = 1;\nconst UNQUALIFIED = 2;\nconst LIGHT_SKIN = 1;\nconst MEDIUM_LIGHT_SKIN = 2;\nconst MEDIUM_SKIN = 3;\nconst MEDIUM_DARK_SKIN = 4;\nconst DARK_SKIN = 5;\nconst GROUP_KEY_SMILEYS_EMOTION = 'smileys-emotion';\nconst GROUP_KEY_PEOPLE_BODY = 'people-body';\nconst GROUP_KEY_ANIMALS_NATURE = 'animals-nature';\nconst GROUP_KEY_FOOD_DRINK = 'food-drink';\nconst GROUP_KEY_TRAVEL_PLACES = 'travel-places';\nconst GROUP_KEY_ACTIVITIES = 'activities';\nconst GROUP_KEY_OBJECTS = 'objects';\nconst GROUP_KEY_SYMBOLS = 'symbols';\nconst GROUP_KEY_FLAGS = 'flags';\nconst GROUP_KEY_COMPONENT = 'component';\nconst SKIN_KEY_LIGHT = 'light';\nconst SKIN_KEY_MEDIUM_LIGHT = 'medium-light';\nconst SKIN_KEY_MEDIUM = 'medium';\nconst SKIN_KEY_MEDIUM_DARK = 'medium-dark';\nconst SKIN_KEY_DARK = 'dark'; // Important release versions and locales in generating accurate data.\n\nconst LATEST_EMOJI_VERSION = '14.0';\nconst LATEST_UNICODE_VERSION = '14.0.0';\nconst LATEST_CLDR_VERSION = '40';\nconst FIRST_UNICODE_EMOJI_VERSION = '6.0.0';\nconst EMOJI_VERSIONS = ['1.0', '2.0', '3.0', '4.0', '5.0', '11.0', '12.0', '12.1', '13.0', '13.1', '14.0'];\nconst UNICODE_VERSIONS = ['6.0', '6.1', '6.2', '6.3', '7.0', '8.0', '9.0', '10.0', '11.0', '12.0', '12.1', '13.0', '14.0'];\nconst SUPPORTED_LOCALES = ['da', // Danish\n'de', // German\n'en', // English\n'en-gb', // English (Great Britain)\n'es', // Spanish\n'es-mx', // Spanish (Mexico)\n'et', // Estonian\n'fi', // Finnish\n'fr', // French\n'hu', // Hungarian\n'it', // Italian\n'ja', // Japanese\n'ko', // Korean\n'lt', // Lithuanian\n'ms', // Malay\n'nb', // Norwegian\n'nl', // Dutch\n'pl', // Polish\n'pt', // Portuguese\n'ru', // Russian\n'sv', // Swedish\n'th', // Thai\n'uk', // Ukrainian\n'zh', // Chinese\n'zh-hant' // Chinese (Traditional)\n]; // Special options for emoticon permutations.\n\nconst EMOTICON_OPTIONS = {\n  // ðŸ§™â€â™‚ï¸ man mage\n  ':{>': {\n    withNose: false\n  },\n  // ðŸ’” broken heart\n  '</3': {\n    isFace: false\n  },\n  // â¤ï¸ red heart\n  '<3': {\n    isFace: false\n  },\n  // ðŸ¤˜ sign of the horns\n  '\\\\m/': {\n    isFace: false\n  },\n  '\\\\M/': {\n    isFace: false\n  },\n  // ðŸ‘¹ ogre\n  '0)': {\n    withNose: false\n  }\n};\n\nfunction getFetchUrl(path, version, cdnUrl) {\n  let fetchUrl = `https://cdn.jsdelivr.net/npm/emojibase-data@${version}/${path}`;\n\n  if (typeof cdnUrl === 'function') {\n    fetchUrl = cdnUrl(path, version);\n  } else if (typeof cdnUrl === 'string') {\n    fetchUrl = `${cdnUrl}/${path}`;\n  }\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!path || !path.endsWith('.json')) {\n      throw new Error('A valid JSON dataset is required to fetch.');\n    }\n\n    if (!fetchUrl || !/^https?:\\/\\//.test(fetchUrl) || !fetchUrl.endsWith('.json')) {\n      throw new Error('A valid CDN url is required to fetch.');\n    }\n\n    if (!version) {\n      throw new Error('A valid release version is required.');\n    }\n  }\n\n  return fetchUrl;\n}\n/**\n * This function will fetch `emojibase-data` JSON files from our CDN, parse them,\n * and return the response. It requires a file path relative to the `emojibase-data` package\n * as the 1st argument and an optional object of options as the 2rd argument.\n *\n * ```ts\n * import { fetchFromCDN } from 'emojibase';\n *\n * await fetchFromCDN('ja/compact.json', { version: '2.1.3' });\n * await fetchFromCDN('ja/compact.json', { cdnUrl: 'https://example.com/cdn/emojidata/latest' });\n * await fetchFromCDN('ja/compact.json', {\n *     cdnUrl: (path: string, version: string) => {\n *         return `https://example.com/cdn/emojidata/${version}/${path}`;\n *     }\n * });\n * ```\n */\n\n\nasync function fetchFromCDN(path, options = {}) {\n  const {\n    local = false,\n    version = 'latest',\n    cdnUrl,\n    ...opts\n  } = options;\n  const fetchUrl = getFetchUrl(path, version, cdnUrl);\n  const storage = local ? localStorage : sessionStorage;\n  const cacheKey = `emojibase/${version}/${path}`;\n  const cachedData = storage.getItem(cacheKey); // Check the cache first\n\n  if (cachedData) {\n    return Promise.resolve(JSON.parse(cachedData));\n  } // eslint-disable-next-line compat/compat\n\n\n  const response = await fetch(fetchUrl, {\n    credentials: 'omit',\n    mode: 'cors',\n    redirect: 'error',\n    ...opts\n  });\n\n  if (!response.ok) {\n    throw new Error('Failed to load Emojibase dataset.');\n  }\n\n  const data = await response.json();\n\n  try {\n    storage.setItem(cacheKey, JSON.stringify(data));\n  } catch {// Do not allow quota errors to break the app\n  }\n\n  return data;\n}\n\nconst ALIASES = {\n  discord: 'joypixels',\n  slack: 'iamcal'\n};\n/**\n * Fetches and returns localized shortcodes for the defined preset from our CDN.\n * The response is a mapping of emoji hexcodes to shortcodes (either a string or array of strings).\n * Uses `fetchFromCDN` under the hood.\n *\n * ```ts\n * import { fetchShortcodes } from 'emojibase';\n *\n * await fetchShortcodes('ja', 'cldr', { version: '2.1.3' });\n * ```\n */\n\nasync function fetchShortcodes(locale, preset, options) {\n  var _ALIASES$preset;\n\n  return fetchFromCDN(`${locale}/shortcodes/${(_ALIASES$preset = ALIASES[preset]) !== null && _ALIASES$preset !== void 0 ? _ALIASES$preset : preset}.json`, options);\n}\n/**\n * Will join shortcodes from multiple shortcode datasets into a single emoji object\n * using its hexcode. Will remove duplicates in the process.\n */\n\n\nfunction joinShortcodesToEmoji(emoji, shortcodeDatasets) {\n  if (shortcodeDatasets.length === 0) {\n    return emoji;\n  }\n\n  const list = new Set(emoji.shortcodes);\n  shortcodeDatasets.forEach(dataset => {\n    const shortcodes = dataset[emoji.hexcode];\n\n    if (Array.isArray(shortcodes)) {\n      shortcodes.forEach(code => list.add(code));\n    } else if (shortcodes) {\n      list.add(shortcodes);\n    }\n  });\n  emoji.shortcodes = [...list];\n\n  if (emoji.skins) {\n    emoji.skins.forEach(skin => {\n      joinShortcodesToEmoji(skin, shortcodeDatasets);\n    });\n  }\n\n  return emoji;\n}\n\nfunction flattenEmojiData(data, shortcodeDatasets = []) {\n  const emojis = [];\n  data.forEach(emoji => {\n    if (emoji.skins) {\n      // Dont include nested skins array\n      const {\n        skins,\n        ...baseEmoji\n      } = emoji;\n      emojis.push(joinShortcodesToEmoji(baseEmoji, shortcodeDatasets)); // Push each skin modification into the root list\n\n      skins.forEach(skin => {\n        const skinEmoji = { ...skin\n        }; // Inherit tags from parent if they exist\n\n        if (baseEmoji.tags) {\n          skinEmoji.tags = [...baseEmoji.tags];\n        }\n\n        emojis.push(joinShortcodesToEmoji(skinEmoji, shortcodeDatasets));\n      });\n    } else {\n      emojis.push(joinShortcodesToEmoji(emoji, shortcodeDatasets));\n    }\n  });\n  return emojis;\n}\n\nfunction joinShortcodes(emojis, shortcodeDatasets) {\n  if (shortcodeDatasets.length === 0) {\n    return emojis;\n  }\n\n  emojis.forEach(emoji => {\n    joinShortcodesToEmoji(emoji, shortcodeDatasets);\n  });\n  return emojis;\n}\n\nasync function fetchEmojis(locale, options = {}) {\n  const {\n    compact = false,\n    flat = false,\n    shortcodes: presets = [],\n    ...opts\n  } = options;\n  const emojis = await fetchFromCDN(`${locale}/${compact ? 'compact' : 'data'}.json`, opts);\n  let shortcodes = [];\n\n  if (presets.length > 0) {\n    shortcodes = await Promise.all(presets.map(preset => {\n      let promise;\n\n      if (preset.includes('/')) {\n        const [customLocale, customPreset] = preset.split('/');\n        promise = fetchShortcodes(customLocale, customPreset, opts);\n      } else {\n        promise = fetchShortcodes(locale, preset, opts);\n      } // Ignore as the primary dataset should still load\n\n\n      return promise.catch(() => ({}));\n    }));\n  }\n\n  return flat ? flattenEmojiData(emojis, shortcodes) : joinShortcodes(emojis, shortcodes);\n}\n/**\n * Fetches and returns localized messages for emoji related information like groups and sub-groups.\n * Uses `fetchFromCDN` under the hood.\n *\n * ```ts\n * import { fetchMessages } from 'emojibase';\n *\n * await fetchMessages('zh', { version: '2.1.3' });\n * ```\n */\n\n\nasync function fetchMessages(locale, options) {\n  return fetchFromCDN(`${locale}/messages.json`, options);\n}\n/**\n * This function will convert an array of numerical codepoints to a literal emoji Unicode character.\n *\n * ```ts\n * import { fromCodepointToUnicode } from 'emojibase';\n *\n * fromCodepointToUnicode([128104, 8205, 128105, 8205, 128103, 8205, 128102]); // ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦\n * ```\n */\n\n\nfunction fromCodepointToUnicode(codepoint) {\n  return String.fromCodePoint(...codepoint);\n}\n/**\n * This function will convert a hexadecimal codepoint to an array of numerical codepoints.\n * By default, it will split the hexcode using a dash, but can be customized with the 2nd argument.\n *\n * ```ts\n * import { fromHexcodeToCodepoint } from 'emojibase';\n *\n * fromHexcodeToCodepoint('270A-1F3FC'); // [9994, 127996]\n * fromHexcodeToCodepoint('270A 1F3FC', ' '); // [9994, 127996]\n * ```\n */\n\n\nfunction fromHexcodeToCodepoint(code, joiner = '-') {\n  return code.split(joiner).map(point => Number.parseInt(point, 16));\n}\n/**\n * This function will convert a literal emoji Unicode character into a dash separated\n * hexadecimal codepoint. Unless `false` is passed as the 2nd argument, zero width\n * joiner's and variation selectors are removed.\n *\n * ```ts\n * import { fromUnicodeToHexcode } from 'emojibase';\n *\n * fromUnicodeToHexcode('ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦'); // 1F468-1F469-1F467-1F466\n * fromUnicodeToHexcode('ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦', false); // 1F468-200D-1F469-200D-1F467-200D-1F466\n * ```\n */\n\n\nfunction fromUnicodeToHexcode(unicode, strip = true) {\n  const hexcode = [];\n  [...unicode].forEach(codepoint => {\n    var _codepoint$codePointA, _codepoint$codePointA2;\n\n    let hex = (_codepoint$codePointA = (_codepoint$codePointA2 = codepoint.codePointAt(0)) === null || _codepoint$codePointA2 === void 0 ? void 0 : _codepoint$codePointA2.toString(16).toUpperCase()) !== null && _codepoint$codePointA !== void 0 ? _codepoint$codePointA : '';\n\n    while (hex.length < 4) {\n      hex = `0${hex}`;\n    }\n\n    if (!strip || strip && !hex.match(SEQUENCE_REMOVAL_PATTERN)) {\n      hexcode.push(hex);\n    }\n  });\n  return hexcode.join('-');\n}\n/**\n * This function will generate multiple permutations of a base emoticon character.\n * The following permutations will occur:\n *\n * - `)` mouth will be replaced with `]` and `}`. The same applies to sad/frowning mouths.\n * - `/` mouth will be replaced with `\\`.\n * - `:` eyes will be replaced with `=`.\n * - Supports a `-` nose, by injecting between the eyes and mouth.\n * - Supports both uppercase and lowercase variants.\n *\n * ```ts\n * import { generateEmoticonPermutations } from 'emojibase';\n *\n * generateEmoticonPermutations(':)'); // =-), =-}, :-], =-], :-}, :-), =}, =], =), :}, :], :)\n * ```\n *\n * > The base emoticon must follow a set of naming guidelines to work properly.\n *\n * Furthermore, this function accepts an options object as the 2nd argument, as a means to customize\n * the output.\n *\n * - `isFace` (bool) - Toggles face permutations (mouth and eye variants). Defaults to `true`.\n * - `withNose` (bool) - Toggles nose inclusion. Defaults to `true`.\n *\n * ```ts\n * generateEmoticonPermutations(':)', { withNose: false }); // =}, =], =), :}, :], :)\n * generateEmoticonPermutations('\\\\m/', { isFace: false }); // \\m/, \\M/\n * ```\n */\n\n\nfunction generateEmoticonPermutations(emoticon, options = {}) {\n  const {\n    isFace = true,\n    withNose = true\n  } = options;\n  const list = [emoticon]; // Uppercase variant\n\n  if (emoticon.toUpperCase() !== emoticon) {\n    list.push(...generateEmoticonPermutations(emoticon.toUpperCase(), options));\n  }\n\n  if (isFace) {\n    // Backwards slash mouth variant\n    if (emoticon.includes('/')) {\n      list.push(...generateEmoticonPermutations(emoticon.replace('/', '\\\\'), options));\n    } // Bracket and curly brace mouth variants\n\n\n    if (emoticon.includes(')')) {\n      list.push(...generateEmoticonPermutations(emoticon.replace(')', ']'), options), ...generateEmoticonPermutations(emoticon.replace(')', '}'), options));\n    }\n\n    if (emoticon.includes('(')) {\n      list.push(...generateEmoticonPermutations(emoticon.replace('(', '['), options), ...generateEmoticonPermutations(emoticon.replace('(', '{'), options));\n    } // Eye variant\n\n\n    if (emoticon.includes(':')) {\n      list.push(...generateEmoticonPermutations(emoticon.replace(':', '='), options));\n    } // Nose variant for ALL\n\n\n    if (withNose) {\n      list.forEach(emo => {\n        if (!emo.includes('-')) {\n          list.push(`${emo.slice(0, -1)}-${emo.slice(-1)}`);\n        }\n      });\n    }\n  } // Sort from longest to shortest\n\n\n  list.sort((a, b) => b.length - a.length);\n  return [...new Set(list)];\n}\n\nconst STRIP_PATTERN = new RegExp(`(-| )?(${SEQUENCE_REMOVAL_PATTERN.source})`, 'g');\n/**\n * This function will strip zero width joiners (`200D`) and variation selectors\n * (`FE0E`, `FE0F`) from a hexadecimal codepoint.\n *\n * ```ts\n * import { stripHexcode } from 'emojibase';\n *\n * stripHexcode('1F468-200D-2695-FE0F'); // 1F468-2695\n * ```\n */\n\nfunction stripHexcode(hexcode) {\n  return hexcode.replace(STRIP_PATTERN, '');\n}\n\nexport { DARK_SKIN, EMOJI, EMOJI_VERSIONS, EMOTICON_OPTIONS, FEMALE, FIRST_UNICODE_EMOJI_VERSION, FULLY_QUALIFIED, GROUP_KEY_ACTIVITIES, GROUP_KEY_ANIMALS_NATURE, GROUP_KEY_COMPONENT, GROUP_KEY_FLAGS, GROUP_KEY_FOOD_DRINK, GROUP_KEY_OBJECTS, GROUP_KEY_PEOPLE_BODY, GROUP_KEY_SMILEYS_EMOTION, GROUP_KEY_SYMBOLS, GROUP_KEY_TRAVEL_PLACES, LATEST_CLDR_VERSION, LATEST_EMOJI_VERSION, LATEST_UNICODE_VERSION, LIGHT_SKIN, MALE, MEDIUM_DARK_SKIN, MEDIUM_LIGHT_SKIN, MEDIUM_SKIN, MINIMALLY_QUALIFIED, SEQUENCE_REMOVAL_PATTERN, SKIN_KEY_DARK, SKIN_KEY_LIGHT, SKIN_KEY_MEDIUM, SKIN_KEY_MEDIUM_DARK, SKIN_KEY_MEDIUM_LIGHT, SUPPORTED_LOCALES, TEXT, UNICODE_VERSIONS, UNQUALIFIED, appendSkinToneIndex, fetchEmojis, fetchFromCDN, fetchMessages, fetchShortcodes, flattenEmojiData, fromCodepointToUnicode, fromHexcodeToCodepoint, fromUnicodeToHexcode, generateEmoticonPermutations, joinShortcodes, joinShortcodesToEmoji, stripHexcode };\n//# sourceMappingURL=index.js.map\n", "import { EmojiRecord, PickerOptions } from './types';\n\nexport function getEmojiForEvent(event: Event, emojis: EmojiRecord[]): EmojiRecord | null {\n  const target = event.target as HTMLElement;\n  const emojiElement = target.closest('[data-emoji]') as HTMLElement;\n  if (emojiElement) {\n    const emoji = emojis.find(e => e.emoji === emojiElement.dataset.emoji);\n    if (emoji) {\n      return emoji;\n    }\n  }\n\n  return null;\n}\n\nexport function shouldAnimate(options: PickerOptions) {\n  const matcher = window.matchMedia?.('(prefers-reduced-motion: reduce)');\n  return options.animate && !matcher?.matches;\n}\n\nexport function caseInsensitiveIncludes(str: string, search: string) {\n  return str.toLowerCase().includes(search.toLowerCase());\n}\n\n/**\n * Creates a throttled version of a function.\n * \n * @param fn The function to throttle\n * @param wait The wait time in milliseconds\n * @returns a throttled version of fn\n */\nexport function throttle(fn: () => void, wait: number) {\n  let timeout: number | null = null;\n\n  return () => {\n    if (timeout) {\n      return;\n    }\n\n    timeout = window.setTimeout(() => {\n      fn();\n      timeout = null;\n    }, wait);\n  };\n}\n\n/**\n * Creates a debounced version of a function.\n *\n * @param fn the function to debounce\n * @param wait the wait time in milliseconds\n * @returns a debounced version of fn\n */\nexport function debounce(fn: (...args: any[]) => any, wait: number) {\n  let timeout: number | null = null;\n\n  return (...args: any[]): any => {\n    if (timeout) {\n      window.clearTimeout(timeout);\n    }\n\n    timeout = window.setTimeout(() => {\n      fn(...args);\n      timeout = null;\n    }, wait);\n  };\n}\n\nexport function animate(element: HTMLElement, keyframes: Keyframe[] | PropertyIndexedKeyframes, options: KeyframeAnimationOptions, pickerOptions: PickerOptions): Promise<Animation | void> {\n  if (shouldAnimate(pickerOptions) && element.animate) {\n    return element.animate(keyframes, options).finished;\n  }\n\n  // If animation isn't enabled or supported, find the final style state and\n  // apply it directly.\n  const propertyIndex = options.direction === 'normal' ? 1 : 0;\n  const finalState = Object.entries(keyframes).reduce((result, [key, values]) => {\n    return {\n      ...result,\n      [key]: values[propertyIndex]\n    }\n  }, {});\n  Object.assign(element.style, finalState);\n  return Promise.resolve();\n}\n\n/**\n * Takes a rendered HTML string and renders a DOM node from it.\n *\n * @param html the HTML text\n * @returns the generated HTMLElement\n */\n export function toElement<E extends Element = HTMLElement>(html: string): E {\n  const template = document.createElement('template');\n  template.innerHTML = html;\n\n  return template.content?.firstElementChild as E;\n}\n\nexport async function computeHash(obj: any) {\n  const arr = new TextEncoder().encode(obj);\n  const hashBuffer = await crypto.subtle.digest('SHA-256', arr);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n}\n\nexport function getPrefixedClasses(...classNames) {\n  return classNames.reduce((result, className) => ({\n    ...result,\n    [className]: prefixClassName(className)\n  }), {});\n}\n\nexport function prefixClassName(className) {\n  return `picmo__${className}`;\n}\n\nexport function empty(element: Element): Element {\n  while (element.firstChild) {\n    element.removeChild(element.firstChild);\n  }\n\n  return element;\n}\n\nexport function replaceChildren(parent: Element, ...children: Element[]) {\n  empty(parent).append(...children);\n}\n\nfunction isStorageAvailable(key) {\n  try {\n    window[key].length;\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n\nexport function isSessionStorageAvailable() {\n  return isStorageAvailable('sessionStorage');\n}\n\nexport function isLocalStorageAvailable() {\n  return isStorageAvailable('localStorage');\n}\n", "import { Emoji, GroupMessage, Locale } from 'emojibase';\nimport { PickerOptions, EmojiRecord, Category } from '../types';\nimport { caseInsensitiveIncludes } from '../util';\n\nexport type PopulateOptions = {\n  groups: GroupMessage[];\n  emojis: Emoji[];\n  emojisEtag?: string | null;\n  messagesEtag?: string | null;\n  hash?: string | null;\n}\n\ntype SearchableEmoji = {\n  label: string;\n  tags?: string[];\n}\n\nexport type Meta = {\n  emojisEtag?: string;\n  messagesEtag?: string;\n  hash?: string;\n}\n\nexport type DataStoreFactory = { \n  (locale: Locale): DataStore; \n  deleteDatabase(locale: Locale): void;\n}\n\n/**\n * Transforms an Emoji from emojibase into an EmojiRecord.\n * \n * @param emoji the Emoji from the database\n * @returns the equivalent EmojiRecord\n */\n export function getEmojiRecord(emoji: Emoji): EmojiRecord {\n  return {\n    emoji: emoji.emoji,\n    label: emoji.label,\n    tags: emoji.tags,\n    skins: emoji.skins?.map(skin => getEmojiRecord(skin)),\n    order: emoji.order,\n    custom: false,\n    hexcode: emoji.hexcode,\n    version: emoji.version\n  };\n}\n\n  /**\n   * Given an emoji, determine if the query matches.\n   * \n   * The emoji matches if the text query matches the name or one of its tags, and if it is in the array of\n   * categories (if given).\n   * \n   * @param emoji The emoji to check\n   * @param query The text query\n   * @param categories The categories to check\n   * @returns a boolean indicating whether or not the emoji matches the query\n   */\n   export function queryMatches(emoji: SearchableEmoji, query: string, categories?: Category[]) {\n    if (categories && !categories.some(category => category.order === (emoji as Emoji).group)) {\n      return false;\n    }\n\n    return (\n      caseInsensitiveIncludes(emoji.label, query) ||\n      emoji.tags?.some(tag => caseInsensitiveIncludes(tag, query))\n    );\n  }\n\nexport abstract class DataStore {\n  locale: Locale;\n\n  constructor(locale: Locale = 'en') {\n    this.locale = locale;\n  }\n\n  abstract open(): Promise<void>;\n  abstract delete(): Promise<void>;\n  abstract close(): void;\n  abstract getEmojiCount(): Promise<number>;\n  abstract getEtags(): Promise<Record<string, string | undefined>>;\n  abstract setMeta(meta): void;\n  abstract getHash(): Promise<string>;\n  abstract isPopulated(): Promise<boolean>;\n  abstract populate(options: PopulateOptions): Promise<void>;\n  abstract getCategories(options: PickerOptions): Promise<Category[]>;\n  abstract getEmojis(category: Category, emojiVersion: number): Promise<EmojiRecord[]>;\n  abstract searchEmojis(query: string, customEmojis: EmojiRecord[], emojiVersion: number, categories: Category[]): Promise<EmojiRecord[]>;\n}\n", "import { EmojiRecord } from './types';\nexport type EmojiProcessingRule = (emoji: EmojiRecord, version: number) => EmojiRecord | null;\n\nexport const rules: EmojiProcessingRule[] = [\n\n  // Prior to Emoji 14, the handshake emoji's skin tone variants was not standardized\n  // and will not render correctly as a native emoji. \n  (emoji: EmojiRecord, emojiVersion: number) => {\n    if (emoji.hexcode === '1F91D' && emojiVersion < 14) {\n      emoji.skins = [];\n    }\n\n    return emoji;\n  },\n\n  // Filter out variants that are not supported by the current version of the emoji.\n  // If a variant doesn't specify a version, it will be included. Only variants that\n  // specify a version that is greater than the current version will be filtered out.\n  (emoji: EmojiRecord, emojiVersion: number) => {\n    if (emoji.skins) {\n      emoji.skins = emoji.skins.filter((skin: EmojiRecord) => !skin.version || skin.version <= emojiVersion);\n    }\n\n    return emoji;\n  }\n];\n\nexport function applyRulesToEmoji(emoji: EmojiRecord, emojiVersion: number) {\n  if (rules.some(rule => rule(emoji, emojiVersion) === null)) {\n    return null;\n  }\n\n  return emoji;\n}\n\nexport function applyRules(emojis: EmojiRecord[], emojiVersion: number): EmojiRecord[] {\n  return emojis.filter(emoji => applyRulesToEmoji(emoji, emojiVersion) !== null);\n}\n", "import { Locale, Emoji, GroupMessage } from 'emojibase';\nimport { Meta, getEmojiRecord, PopulateOptions, DataStore, queryMatches } from './DataStore';\nimport { PickerOptions, EmojiRecord, Category, CategoryKey } from '../types';\n\nimport { applyRules } from '../rules';\n\nconst instances = {} as Record<Locale, InMemoryStore>;\n\nexport function InMemoryStoreFactory(locale: Locale): DataStore {\n  if (!instances[locale]) {\n    instances[locale] = new InMemoryStore(locale);\n  }\n  return instances[locale];\n}\n\nInMemoryStoreFactory.deleteDatabase = (locale: Locale) => {\n  // Not implemented for in memory datastore\n};\n\nexport class InMemoryStore extends DataStore {\n  private categories: GroupMessage[];\n  private emojis: Emoji[];\n  private meta: Meta;\n\n  open(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  delete(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  close(): void {\n    // Not implemented for in memory datastore\n  }\n\n  isPopulated(): Promise<boolean> {\n    return Promise.resolve(false);\n  }\n\n  getEmojiCount(): Promise<number> {\n    return Promise.resolve(this.emojis.length);\n  }\n\n  getEtags(): Promise<Record<string, string | undefined>> {\n    // Not implemented for in memory datastore\n    return Promise.resolve({ foo: 'bar'});\n  }\n\n  getHash(): Promise<string> {\n    // Not implemented for in memory datastore\n    return Promise.resolve('');\n  }\n\n  populate(options: PopulateOptions) {\n    this.categories = options.groups;\n    this.emojis = options.emojis;\n    return Promise.resolve();\n  }\n\n  getCategories(options: PickerOptions): Promise<Category[]> {\n      let categories: Category[] = this.categories.filter(category => category.key !== 'component') as Category[];\n\n      if (options.showRecents) {\n        categories.unshift({ key: 'recents', order: -1 });\n      }\n\n      if (options.custom?.length) {\n        categories.push({ key: 'custom', order: 10 });\n      }\n\n      if (options.categories) {\n        const includeList = options.categories as CategoryKey[];\n        categories = categories.filter(category => includeList.includes(category.key));\n        categories.sort((a: Category, b: Category) => includeList.indexOf(a.key) - includeList.indexOf(b.key));\n      } else {\n        categories.sort((a: Category, b: Category) => a.order - b.order);\n      }\n\n      return Promise.resolve(categories);\n  }\n\n  getEmojis(category: Category, emojiVersion: number): Promise<EmojiRecord[]> {\n    const emojiResults = this.emojis\n      .filter(emoji => emoji.group === category.order)\n      .filter((e: Emoji) => e.version <= emojiVersion)\n      .sort((a: Emoji, b: Emoji) => {\n        if (a.order != null && b.order != null) {\n          return a.order - b.order;\n        }\n\n        return 0;\n      }).map(getEmojiRecord);\n\n    return Promise.resolve(applyRules(emojiResults, emojiVersion));\n  }\n\n  searchEmojis(query: string, customEmojis: EmojiRecord[], emojiVersion: number, categories: Category[]): Promise<EmojiRecord[]> {\n    const matchingEmojis = this.emojis\n      .filter(emoji => queryMatches(emoji, query, categories) && emoji.version <= emojiVersion)\n      .map(getEmojiRecord);\n\n    const matchingCustom = customEmojis.filter(emoji => queryMatches(emoji, query, categories));\n\n    const results = [\n      ...applyRules(matchingEmojis, emojiVersion),\n      ...matchingCustom\n    ];\n\n    return Promise.resolve(results);\n  }\n\n  setMeta(meta: Meta) {\n    this.meta = meta;\n  }\n}", "import { Locale, MessagesDataset, fetchMessages, fetchEmojis, Emoji } from 'emojibase';\n// import { Database } from './db';\nimport { DataStoreFactory, DataStore } from './DataStore';\nimport { computeHash, isSessionStorageAvailable } from '../util';\nimport { createStorage } from '../webStorageShim';\nimport { InMemoryStoreFactory } from './InMemoryStore';\n\n/**\n * Generates the URLs for emoji data for a given emojibase version and locale.\n * \n * @param version the emojibase version (usually 'latest' is what you want)\n * @param locale the locale for the data\n * @returns an object containing the two URLs\n */\nfunction getCdnUrls(version, locale) {\n  const base = `https://cdn.jsdelivr.net/npm/emojibase-data@${version}/${locale}`;\n\n  return {\n    emojisUrl: `${base}/data.json`,\n    messagesUrl: `${base}/messages.json`,\n  };\n}\n\n/**\n * Gets the ETag for the given URL by making a HEAD request.\n * \n * @param url the URL to check\n * @returns the ETag value, or null if no ETag was found\n */\nasync function getEtag(url: string): Promise<string | null> {\n  try {\n    const response = await fetch(url, { method: 'HEAD' });\n    return response.headers.get('etag');\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Gets the ETags for the emoji and message data.\n * \n * @param emojisUrl the URL of the emoji data\n * @param messagesUrl the URL of the message data\n * @returns a Promise that resolves to an array of the ETag values\n */\nfunction getEtags(locale): Promise<Array<string | null>> {\n  const { emojisUrl, messagesUrl } = getCdnUrls('latest', locale);\n\n  try {\n    return Promise.all([\n      getEtag(emojisUrl),\n      getEtag(messagesUrl),\n    ]);\n  } catch (error) {\n    return Promise.all([null, null]);\n  }\n}\n\n/**\n * Checks if the category or emoji data is out of date.\n * \n * This is determined by checking the ETag of the data from the CDN, and downloading the latest if the\n * ETags don't match.\n * \n * @param db the database\n * @param emojisEtag the ETag of the emojis data\n * @param messagesEtag the ETag of the messages data\n */\nasync function checkUpdates(db: DataStore, emojisEtag: string, messagesEtag: string) {\n  let etags;\n\n  try {\n    etags = await db.getEtags();\n  } catch (error) {\n    etags = {};\n  }\n\n  const { storedEmojisEtag, storedMessagesEtag } = etags;\n\n  // If either ETag does not match, repopulate the database with the latest CDN data\n  if (messagesEtag !== storedMessagesEtag || emojisEtag !== storedEmojisEtag) {\n    const [messages, emojis] = await Promise.all([fetchMessages(db.locale), fetchEmojis(db.locale)]);\n    await db.populate({\n      groups: messages.groups, \n      emojis,\n      emojisEtag,\n      messagesEtag\n    });\n  }\n}\n\n/**\n * Checks for a new version of local emoji data. This is done by comparing the stored hash with the \n * newly computed one.\n * \n * @param db The database\n * @param hash The hash of the local emoji data\n * @returns true if there is a hash mismatch and a database update is required\n */\nasync function checkLocalUpdates(db: DataStore, hash: string) {\n  const storedHash = await db.getHash();\n  return hash !== storedHash;\n}\n\n/**\n * Opens the database.\n * \n * @param locale the database locale\n * @param existingDb any existing database to use\n * @returns Promise that resolves to the database instance\n */\nasync function openDatabase(locale: Locale, factory: DataStoreFactory, existingDb?: DataStore): Promise<DataStore> {\n  let db = existingDb || factory(locale);\n  try {\n    await db.open();\n  } catch (error) {\n    console.warn('[picmo] IndexedDB not available, falling back to InMemoryStoreFactory');\n    db = InMemoryStoreFactory(locale);\n  }\n\n  return db;\n}\n\n/**\n * Initializes an emoji database with data from the CDN.\n * \n * @param locale the locale for the database\n * @param existingDb any existing database to repopulate\n * @returns a Promise that resolves to a fully populated database instance\n */\nasync function initDatabaseFromCdn(locale: Locale, factory: DataStoreFactory, existingDb?: DataStore) {\n  if (!isSessionStorageAvailable() && typeof window !== 'undefined') {\n    throw new Error('Session storage is required to use CDN emoji data.');\n  }\n\n  const db = await openDatabase(locale, factory, existingDb);\n  const [emojisEtag, messagesEtag] = await getEtags(locale);\n\n  if (!(await db.isPopulated())) {\n    const [messages, emojis] = await Promise.all([fetchMessages(locale), fetchEmojis(locale)]);\n    await db.populate({ groups: messages.groups, emojis, emojisEtag, messagesEtag });\n  } else if (emojisEtag && messagesEtag) {\n    await checkUpdates(db, emojisEtag, messagesEtag);\n  }\n\n  return db;\n}\n\n/**\n * Initializes an emoji database with local data from the emojibase-data package.\n * \n * @param locale the locale\n * @param messages the messages dataset\n * @param emojis the emoji dataset\n * @param existingDb any existing database to repopulate\n * @returns a Promise that resolves to a fully populated database instance\n */\nasync function initDatabaseWithLocalData(locale: Locale, factory: DataStoreFactory, messages: MessagesDataset, emojis: Emoji[], existingDb?: DataStore) {\n  const db = await openDatabase(locale, factory, existingDb);\n\n  const hash = await computeHash(emojis);\n  if (!(await db.isPopulated()) || await checkLocalUpdates(db, hash)) {\n    await db.populate({ groups: messages.groups, emojis, hash });\n  }\n\n  return db;\n}\n\n/**\n * Public API for initializing a database.\n * \n * @param locale the locale\n * @param staticMessages local messages dataset, if any\n * @param staticEmojis local emoji dataset, if any\n * @param existingDb any existing database to repopulate\n * @returns a Promise that resolves to the database instance\n */\nexport async function initDatabase(locale: Locale, factory: DataStoreFactory, staticMessages?: MessagesDataset, staticEmojis?: Emoji[], existingDb?: DataStore) {\n  if (staticMessages && staticEmojis) {\n    return initDatabaseWithLocalData(locale, factory, staticMessages, staticEmojis, existingDb);\n  } else {\n    return initDatabaseFromCdn(locale, factory, existingDb);\n  }\n}\n\n/**\n * Deletes a database instance for a locale.\n * @param locale the locale to delete\n */\nexport function deleteDatabase(factory: DataStoreFactory, locale: Locale) {\n  factory.deleteDatabase(locale);\n}\n", "export class FocusTrap {\n  private rootElement: HTMLElement;\n\n  constructor() {\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n  }\n\n  activate(rootElement: HTMLElement) {\n    this.rootElement = rootElement;\n    this.rootElement.addEventListener('keydown', this.handleKeyDown);\n  }\n\n  deactivate() {\n    this.rootElement?.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  get focusableElements(): NodeListOf<HTMLElement> {\n    return this.rootElement.querySelectorAll<HTMLElement>('input, [tabindex=\"0\"]');\n  }\n\n  get lastFocusableElement(): HTMLElement {\n    return this.focusableElements[this.focusableElements.length - 1];\n  }\n\n  get firstFocusableElement(): HTMLElement {\n    return this.focusableElements[0];\n  }\n\n  checkFocus(event: KeyboardEvent, referenceElement: HTMLElement, targetElement: HTMLElement) {\n    if (event.target === referenceElement) {\n      targetElement.focus();\n      event.preventDefault();\n    }\n  }\n\n  handleKeyDown(event: KeyboardEvent) {\n    if (event.key === 'Tab') {\n      this.checkFocus(\n        event,\n        event.shiftKey ? this.firstFocusableElement : this.lastFocusableElement,\n        event.shiftKey ? this.lastFocusableElement : this.firstFocusableElement\n      );\n    }\n  }\n}", "import { getPrefixedClasses } from './util';\n\nconst {\n  light: lightTheme,\n  dark: darkTheme,\n  auto: autoTheme\n} = getPrefixedClasses('light', 'dark', 'auto');\n\nexport { lightTheme, darkTheme, autoTheme };\n", "import { Template, TemplateData } from '../Template';\nimport { AppEvent, AppEventKey } from '../AppEvents';\nimport { Events, EventArgs, EventCallback, AsyncEventCallback } from '../events';\nimport { ViewFactory } from '../viewFactory';\nimport { Bundle } from '../i18n/bundle';\nimport { Renderer } from '../renderers/renderer';\nimport { DataStore } from '../data/DataStore';\nimport { EmojiRecord, PickerOptions } from '../types';\nimport { shouldAnimate } from '../util';\n\ntype UIEventListenerBinding = {\n  target?: string;\n  event: string;\n  handler: EventCallback;\n  options?: AddEventListenerOptions;\n};\n\ntype KeyBindings = Record<string, (KeyboardEvent?) => void>;\n\ntype AppEvents = {\n  [key in AppEvent]?: EventCallback | AsyncEventCallback;\n};\n\ntype ClassMappings = Record<string, string>;\ntype UIElementSelectors = Record<string, string>;\ntype UIElementMappings = Record<string, HTMLElement>;\n\ntype ViewOptions = {\n  template: Template;\n  classes?: ClassMappings;\n  parent?: HTMLElement;\n};\nexport abstract class View {\n  el: HTMLElement;\n  isDestroyed = false;\n\n  private template: Template;\n  private classes?: ClassMappings;\n\n  protected appEvents: AppEvents = {};\n  protected uiEvents: UIEventListenerBinding[] = [];\n  protected keyBindings: KeyBindings;\n  protected uiElements: UIElementSelectors = {};\n  protected emojiData: DataStore;\n  protected emojiDataPromise: Promise<DataStore>;\n  protected options: PickerOptions;\n  protected customEmojis: EmojiRecord[];\n\n  protected events: Events<AppEvent>;\n  protected i18n: Bundle;\n  protected renderer: Renderer;\n  protected pickerId: string;\n\n  protected parent?: HTMLElement;\n\n  viewFactory: ViewFactory;\n\n  ui: UIElementMappings = {};\n\n  constructor({ template, classes, parent }: ViewOptions) {\n    this.template = template;\n    this.classes = classes;\n    this.parent = parent;\n\n    this.keyBindingHandler = this.keyBindingHandler.bind(this);\n  }\n\n  initialize() {\n    this.bindAppEvents();\n  }\n\n  setCustomEmojis(customEmojis: EmojiRecord[]) {\n    this.customEmojis = customEmojis;\n  }\n\n  setEvents(events: Events<AppEvent>) {\n    this.events = events;\n  }\n\n  setPickerId(pickerId: string) {\n    this.pickerId = pickerId;\n  }\n\n  emit(event: AppEventKey, ...args: EventArgs) {\n    this.events.emit(event, ...args);\n  }\n\n  setI18n(i18n: Bundle) {\n    this.i18n = i18n;\n  }\n\n  setRenderer(renderer: Renderer) {\n    this.renderer = renderer;\n  }\n\n  setEmojiData(emojiDataPromise: Promise<DataStore>) {\n    this.emojiDataPromise = emojiDataPromise;\n    emojiDataPromise.then(emojiData => {\n      this.emojiData = emojiData;\n    });\n  }\n\n  updateEmojiData(emojiData: DataStore) {\n    this.emojiData = emojiData;\n    this.emojiDataPromise = Promise.resolve(emojiData);\n  }\n\n  setOptions(options: PickerOptions) {\n    this.options = options;\n  }\n\n  animateShow?: () => Promise<Animation | void | Animation[] | (Animation | void)[] >;\n\n  renderSync(templateData: TemplateData = {}): HTMLElement {\n    this.el = this.template.renderSync({\n      classes: this.classes,\n      i18n: this.i18n,\n      pickerId: this.pickerId,\n      ...templateData\n    }) as HTMLElement;\n\n    this.postRender();\n    return this.el;\n  }\n\n  async render(templateData: TemplateData = {}): Promise<HTMLElement> {\n    await this.emojiDataPromise;\n\n    this.el = await this.template.renderAsync({\n      classes: this.classes,\n      i18n: this.i18n,\n      pickerId: this.pickerId,\n      ...templateData\n    });\n    this.postRender();\n    return this.el;\n  }\n\n  private postRender() {\n    this.bindUIElements();\n    this.bindKeyBindings();\n    this.bindUIEvents();\n    this.scheduleShowAnimation();\n  }\n\n  private bindAppEvents() {\n    Object.keys(this.appEvents).forEach(event => {\n      this.events.on(event as AppEventKey, this.appEvents[event], this);\n    });\n\n    this.events.on('data:ready', this.updateEmojiData, this);\n  }\n\n  private unbindAppEvents() {\n    Object.keys(this.appEvents).forEach(event => {\n      this.events.off(event as AppEventKey, this.appEvents[event]);\n    });\n\n    this.events.off('data:ready', this.updateEmojiData);\n  }\n\n  private keyBindingHandler(event: KeyboardEvent) {\n    const handler = this.keyBindings[event.key];\n    if (handler) {\n      handler.call(this, event);\n    }\n  }\n\n  private bindKeyBindings() {\n    if (this.keyBindings) {\n      this.el.addEventListener('keydown', this.keyBindingHandler);\n    }\n  }\n\n  private unbindKeyBindings() {\n    if (this.keyBindings) {\n      this.el.removeEventListener('keydown', this.keyBindingHandler);\n    }\n  }\n\n  private bindUIElements() {\n    this.ui = Object.keys(this.uiElements).reduce((result, key) => ({\n      ...result,\n      [key]: this.el.querySelector<HTMLElement>(this.uiElements[key])\n    }), {});\n  }\n\n  private bindUIEvents() {\n    this.uiEvents.forEach((binding: UIEventListenerBinding) => {\n      binding.handler = binding.handler.bind(this);\n\n      const target = binding.target ? this.ui[binding.target] : this.el;\n      target.addEventListener(binding.event, binding.handler, binding.options);\n    });\n  }\n\n  private unbindUIEvents() {\n    this.uiEvents.forEach((binding: UIEventListenerBinding) => {\n      const target = binding.target ? this.ui[binding.target] : this.el;\n      target.removeEventListener(binding.event, binding.handler);\n    });\n  }\n\n  destroy() {\n    this.unbindAppEvents();\n    this.unbindUIEvents();\n    this.unbindKeyBindings();\n\n    this.el.remove();\n    this.isDestroyed = true;\n  }\n\n  private scheduleShowAnimation() {\n    if (this.parent) {\n      const observer = new MutationObserver(list => {\n        const [record] = list;\n        if (record.type === 'childList' && record.addedNodes[0] === this.el) {\n          if (shouldAnimate(this.options) && this.animateShow) {\n            this.animateShow();\n          }\n          observer.disconnect\n        }\n      });\n\n      observer.observe(this.parent as Node, { childList: true });\n    }\n  }\n\n  static childEvent(target: string, event: string, handler: EventCallback, options: AddEventListenerOptions = {}): UIEventListenerBinding {\n    return { target, event, handler, options };\n  }\n\n  static uiEvent(event: string, handler: EventCallback, options: AddEventListenerOptions = {}): UIEventListenerBinding {\n    return { event, handler, options };\n  }\n\n  static byClass(className: string): string {\n    return `.${className}`;\n  }\n}\n", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240zM336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176zM259.9 369.4C288.8 369.4 316.2 375.2 340.6 385.5C352.9 390.7 366.7 381.3 361.4 369.1C344.8 330.9 305.6 303.1 259.9 303.1C214.3 303.1 175.1 330.8 158.4 369.1C153.1 381.3 166.1 390.6 179.3 385.4C203.7 375.1 231 369.4 259.9 369.4L259.9 369.4z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 640 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M448 64H192C85.96 64 0 149.1 0 256s85.96 192 192 192h256c106 0 192-85.96 192-192S554 64 448 64zM247.1 280h-32v32c0 13.2-10.78 24-23.98 24c-13.2 0-24.02-10.8-24.02-24v-32L136 279.1C122.8 279.1 111.1 269.2 111.1 256c0-13.2 10.85-24.01 24.05-24.01L167.1 232v-32c0-13.2 10.82-24 24.02-24c13.2 0 23.98 10.8 23.98 24v32h32c13.2 0 24.02 10.8 24.02 24C271.1 269.2 261.2 280 247.1 280zM431.1 344c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40s39.1 17.88 39.1 40S454.1 344 431.1 344zM495.1 248c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40c22.12 0 39.1 17.88 39.1 40S518.1 248 495.1 248z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 640 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M512 32H120c-13.25 0-24 10.75-24 24L96.01 288c0 53 43 96 96 96h192C437 384 480 341 480 288h32c70.63 0 128-57.38 128-128S582.6 32 512 32zM512 224h-32V96h32c35.25 0 64 28.75 64 64S547.3 224 512 224zM560 416h-544C7.164 416 0 423.2 0 432C0 458.5 21.49 480 48 480h480c26.51 0 48-21.49 48-48C576 423.2 568.8 416 560 416z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 576 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M482.3 192C516.5 192 576 221 576 256C576 292 516.5 320 482.3 320H365.7L265.2 495.9C259.5 505.8 248.9 512 237.4 512H181.2C170.6 512 162.9 501.8 165.8 491.6L214.9 320H112L68.8 377.6C65.78 381.6 61.04 384 56 384H14.03C6.284 384 0 377.7 0 369.1C0 368.7 .1818 367.4 .5398 366.1L32 256L.5398 145.9C.1818 144.6 0 143.3 0 142C0 134.3 6.284 128 14.03 128H56C61.04 128 65.78 130.4 68.8 134.4L112 192H214.9L165.8 20.4C162.9 10.17 170.6 0 181.2 0H237.4C248.9 0 259.5 6.153 265.2 16.12L365.7 192H482.3z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 640 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M9.375 233.4C3.375 239.4 0 247.5 0 256v128c0 8.5 3.375 16.62 9.375 22.62S23.5 416 32 416h32V224H32C23.5 224 15.38 227.4 9.375 233.4zM464 96H352V32c0-17.62-14.38-32-32-32S288 14.38 288 32v64H176C131.8 96 96 131.8 96 176V448c0 35.38 28.62 64 64 64h320c35.38 0 64-28.62 64-64V176C544 131.8 508.3 96 464 96zM256 416H192v-32h64V416zM224 296C201.9 296 184 278.1 184 256S201.9 216 224 216S264 233.9 264 256S246.1 296 224 296zM352 416H288v-32h64V416zM448 416h-64v-32h64V416zM416 296c-22.12 0-40-17.88-40-40S393.9 216 416 216S456 233.9 456 256S438.1 296 416 296zM630.6 233.4C624.6 227.4 616.5 224 608 224h-32v192h32c8.5 0 16.62-3.375 22.62-9.375S640 392.5 640 384V256C640 247.5 636.6 239.4 630.6 233.4z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\">\\n  <defs>\\n    <radialGradient gradientUnits=\\\"userSpaceOnUse\\\" cy=\\\"10%\\\" id=\\\"gradient-0\\\">\\n      <stop offset=\\\"0\\\" stop-color=\\\"hsl(50, 100%, 50%)\\\" />\\n      <stop offset=\\\"1\\\" stop-color=\\\"hsl(50, 100%, 60%)\\\" />\\n    </radialGradient>\\n  </defs>\\n  <!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->\\n  <ellipse stroke=\\\"#000\\\" fill=\\\"rgba(0, 0, 0, 0.6)\\\" cx=\\\"172.586\\\" cy=\\\"207.006\\\" rx=\\\"39.974\\\" ry=\\\"39.974\\\"/>\\n  <ellipse stroke=\\\"#000\\\" fill=\\\"rgba(0, 0, 0, 0.6)\\\" cx=\\\"334.523\\\" cy=\\\"207.481\\\" rx=\\\"39.974\\\" ry=\\\"39.974\\\"/>\\n  <ellipse stroke=\\\"#000\\\" fill=\\\"rgba(0, 0, 0, 0.6)\\\" cx=\\\"313.325\\\" cy=\\\"356.208\\\" rx=\\\"91.497\\\" ry=\\\"59.893\\\"/>\\n  <path fill=\\\"#55a7ff\\\" d=\\\"M 159.427 274.06 L 102.158 363.286 L 124.366 417.011 L 160.476 423.338 L 196.937 414.736 L 218.502 375.214\\\"></path>\\n  <path fill=\\\"url(#gradient-0)\\\" d=\\\"M256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0zM256 352C290.9 352 323.2 367.8 348.3 394.9C354.3 401.4 364.4 401.7 370.9 395.7C377.4 389.7 377.7 379.6 371.7 373.1C341.6 340.5 301 320 256 320C247.2 320 240 327.2 240 336C240 344.8 247.2 352 256 352H256zM208 369C208 349 179.6 308.6 166.4 291.3C163.2 286.9 156.8 286.9 153.6 291.3C140.6 308.6 112 349 112 369C112 395 133.5 416 160 416C186.5 416 208 395 208 369H208zM303.6 208C303.6 225.7 317.1 240 335.6 240C353.3 240 367.6 225.7 367.6 208C367.6 190.3 353.3 176 335.6 176C317.1 176 303.6 190.3 303.6 208zM207.6 208C207.6 190.3 193.3 176 175.6 176C157.1 176 143.6 190.3 143.6 208C143.6 225.7 157.1 240 175.6 240C193.3 240 207.6 225.7 207.6 208z\\\" />\\n</svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M500.3 443.7l-119.7-119.7c27.22-40.41 40.65-90.9 33.46-144.7C401.8 87.79 326.8 13.32 235.2 1.723C99.01-15.51-15.51 99.01 1.724 235.2c11.6 91.64 86.08 166.7 177.6 178.9c53.8 7.189 104.3-6.236 144.7-33.46l119.7 119.7c15.62 15.62 40.95 15.62 56.57 0C515.9 484.7 515.9 459.3 500.3 443.7zM79.1 208c0-70.58 57.42-128 128-128s128 57.42 128 128c0 70.58-57.42 128-128 128S79.1 278.6 79.1 208z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256.3 331.8C208.9 331.8 164.1 324.9 124.5 312.8C112.2 309 100.2 319.7 105.2 331.5C130.1 390.6 188.4 432 256.3 432C324.2 432 382.4 390.6 407.4 331.5C412.4 319.7 400.4 309 388.1 312.8C348.4 324.9 303.7 331.8 256.3 331.8H256.3zM176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176zM336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M500.3 7.251C507.7 13.33 512 22.41 512 31.1V175.1C512 202.5 483.3 223.1 447.1 223.1C412.7 223.1 383.1 202.5 383.1 175.1C383.1 149.5 412.7 127.1 447.1 127.1V71.03L351.1 90.23V207.1C351.1 234.5 323.3 255.1 287.1 255.1C252.7 255.1 223.1 234.5 223.1 207.1C223.1 181.5 252.7 159.1 287.1 159.1V63.1C287.1 48.74 298.8 35.61 313.7 32.62L473.7 .6198C483.1-1.261 492.9 1.173 500.3 7.251H500.3zM74.66 303.1L86.5 286.2C92.43 277.3 102.4 271.1 113.1 271.1H174.9C185.6 271.1 195.6 277.3 201.5 286.2L213.3 303.1H239.1C266.5 303.1 287.1 325.5 287.1 351.1V463.1C287.1 490.5 266.5 511.1 239.1 511.1H47.1C21.49 511.1-.0019 490.5-.0019 463.1V351.1C-.0019 325.5 21.49 303.1 47.1 303.1H74.66zM143.1 359.1C117.5 359.1 95.1 381.5 95.1 407.1C95.1 434.5 117.5 455.1 143.1 455.1C170.5 455.1 191.1 434.5 191.1 407.1C191.1 381.5 170.5 359.1 143.1 359.1zM440.3 367.1H496C502.7 367.1 508.6 372.1 510.1 378.4C513.3 384.6 511.6 391.7 506.5 396L378.5 508C372.9 512.1 364.6 513.3 358.6 508.9C352.6 504.6 350.3 496.6 353.3 489.7L391.7 399.1H336C329.3 399.1 323.4 395.9 321 389.6C318.7 383.4 320.4 376.3 325.5 371.1L453.5 259.1C459.1 255 467.4 254.7 473.4 259.1C479.4 263.4 481.6 271.4 478.7 278.3L440.3 367.1zM116.7 219.1L19.85 119.2C-8.112 90.26-6.614 42.31 24.85 15.34C51.82-8.137 93.26-3.642 118.2 21.83L128.2 32.32L137.7 21.83C162.7-3.642 203.6-8.137 231.6 15.34C262.6 42.31 264.1 90.26 236.1 119.2L139.7 219.1C133.2 225.6 122.7 225.6 116.7 219.1H116.7z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 448 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M413.8 447.1L256 448l0 31.99C256 497.7 241.8 512 224.1 512c-17.67 0-32.1-14.32-32.1-31.99l0-31.99l-158.9-.0099c-28.5 0-43.69-34.49-24.69-56.4l68.98-79.59H62.22c-25.41 0-39.15-29.8-22.67-49.13l60.41-70.85H89.21c-21.28 0-32.87-22.5-19.28-37.31l134.8-146.5c10.4-11.3 28.22-11.3 38.62-.0033l134.9 146.5c13.62 14.81 2.001 37.31-19.28 37.31h-10.77l60.35 70.86c16.46 19.34 2.716 49.12-22.68 49.12h-15.2l68.98 79.59C458.7 413.7 443.1 447.1 413.8 447.1z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 640 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M224 256c70.7 0 128-57.31 128-128S294.7 0 224 0C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3c-95.73 0-173.3 77.6-173.3 173.3C0 496.5 15.52 512 34.66 512H413.3C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304zM479.1 320h-73.85C451.2 357.7 480 414.1 480 477.3C480 490.1 476.2 501.9 470 512h138C625.7 512 640 497.6 640 479.1C640 391.6 568.4 320 479.1 320zM432 256C493.9 256 544 205.9 544 144S493.9 32 432 32c-25.11 0-48.04 8.555-66.72 22.51C376.8 76.63 384 101.4 384 128c0 35.52-11.93 68.14-31.59 94.71C372.7 243.2 400.8 256 432 256z\\\"/></svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\">\\n  <defs>\\n    <radialGradient id=\\\"radial\\\" cy=\\\"85%\\\">\\n      <stop offset=\\\"20%\\\" stop-color=\\\"var(--color-secondary)\\\" />\\n      <stop offset=\\\"100%\\\" stop-color=\\\"var(--color-primary)\\\" />\\n    </radialGradient>\\n  </defs>\\n  <!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->\\n  <path fill=\\\"url('#radial')\\\" d=\\\"M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z\\\" />\\n</svg>\"", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 320 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z\\\"/></svg>\"", "import { prefixClassName, toElement } from '../util';\nimport { CategoryKey } from '../types';\n\nimport clock from './clock-solid.svg?raw';\nimport flag from './flag-solid.svg?raw';\nimport frown from './face-frown-open-solid.svg?raw';\nimport gamepad from './gamepad-solid.svg?raw';\nimport lightbulb from './lightbulb-solid.svg?raw';\nimport mug from './mug-saucer-solid.svg?raw';\nimport plane from './plane-solid.svg?raw';\nimport robot from './robot-solid.svg?raw';\nimport sad from './face-sad-tear-solid.svg?raw';\nimport search from './magnifying-glass-solid.svg?raw';\nimport smiley from './face-grin-solid.svg?raw';\nimport symbols from './icons-solid.svg?raw';\nimport tree from './tree-solid.svg?raw';\nimport users from './user-group-solid.svg?raw';\nimport warning from './triangle-exclamation-solid.svg?raw';\nimport xmark from './xmark-solid.svg?raw';\n\nfunction createIcon(iconName: string, svg: string): SVGElement {\n  const el = toElement<SVGSVGElement>(svg);\n  el.dataset.icon = iconName;\n  el.classList.add(prefixClassName('icon'));\n  return el;\n}\n\nexport type IconSize = 'small' | 'medium' | 'large' | '2x' | '3x' | '4x' | '5x';\n\nconst icons = {\n  clock, \n  flag,\n  frown,\n  gamepad, \n  lightbulb, \n  mug, \n  plane, \n  robot, \n  sad,\n  search,\n  smiley, \n  symbols, \n  tree,\n  users, \n  warning, \n  xmark,\n};\n\nexport { icons };\n\nexport const categoryIcons: Record<CategoryKey, string> = {\n  'recents': 'clock',\n  'smileys-emotion': 'smiley',\n  'people-body': 'users',\n  'animals-nature': 'tree',\n  'food-drink': 'mug',\n  'activities': 'gamepad',\n  'travel-places': 'plane',\n  'objects': 'lightbulb',\n  'symbols': 'symbols',\n  'flags': 'flag',\n  'custom': 'robot'\n};\n\nexport function icon(name: string, size?: IconSize): Element {\n  if (!(name in icons)) {\n    console.warn(`Unknown icon: \"${name}\"`);\n    return document.createElement('div');\n  }\n\n  const icon = createIcon(name, icons[name]);\n  if (size) {\n    icon.classList.add(prefixClassName(`icon-${size}`));\n  }\n\n  return icon;\n}\n", "import { icon, IconSize } from './icons';\nimport { View } from './views/view';\nimport { toElement } from './util';\n\nexport type TemplateData = Record<string, any>;\ntype ViewData = Record<string, View>;\n\ntype RenderMode = 'sync' | 'async';\n\ntype TemplateOptions = {\n  mode: RenderMode;\n}\n\nconst defaultOptions: TemplateOptions = {\n  mode: 'sync'\n};\n\nexport class Template<E extends HTMLElement = HTMLElement> {\n  #templateFn: (TemplateData) => string;\n  #mode: RenderMode;\n\n  constructor(templateFn: (TemplateData) => string, options: Partial<TemplateOptions> = {}) {\n    this.#templateFn = templateFn;\n    this.#mode = options.mode || defaultOptions.mode;\n  }\n\n  renderSync(data: TemplateData = {}): E {\n    const result = toElement<E>(this.#templateFn(data));\n    this.#bindPlaceholders(result, data);\n    this.#bindIcons(result);\n    this.#renderChildViews(result, data);\n    return result;\n  }\n\n  async renderAsync(data: TemplateData = {}): Promise<E> {\n    const result = toElement<E>(this.#templateFn(data));\n    this.#bindPlaceholders(result, data);\n    this.#bindIcons(result);\n    await this.#renderChildViews(result, data);\n    return result;\n  }\n\n  render(data: TemplateData): E | Promise<E> {\n    return this.#mode === 'sync' ? this.renderSync(data) : this.renderAsync(data);\n  }\n\n  async #renderChildViews(result: E, data: ViewData) {\n    const placeholders = result.querySelectorAll<HTMLElement>('[data-view]');\n\n    const asyncViews: Promise<HTMLElement>[] = [];\n\n    for (const placeholder of placeholders) {\n      const view = data[placeholder.dataset.view as string];\n      if (view) {\n        if (placeholder.dataset.render !== 'sync') {\n          asyncViews.push(view.render().then(result => {\n            placeholder.replaceWith(result);\n            return result;\n          }));\n        } else {\n          placeholder.replaceWith(view.renderSync());\n        }\n      } else {\n        placeholder.remove();\n      }\n    }\n\n    return Promise.all(asyncViews);\n  }\n\n  #bindIcons(result: E) {\n    const icons = result.querySelectorAll<HTMLElement>('i[data-icon]');\n    icons.forEach((placeholder: HTMLElement) => {\n      const { icon: iconKey, size } = placeholder.dataset;\n      placeholder.replaceWith(icon(iconKey as string, size as IconSize));\n    })\n  }\n\n  #bindPlaceholders(result: E, data: TemplateData): E {\n    const placeholders = result.querySelectorAll<HTMLElement>('[data-placeholder]');\n    \n    placeholders.forEach((placeholder: HTMLElement) => {\n      const key = placeholder.dataset.placeholder;\n\n      if (key && data[key]) {\n        const replacement = data[key];\n        placeholder.replaceWith(...[replacement].flat());\n      } else {\n        console.warn(`Missing placeholder element for key \"${key}\"`);\n      }\n    });\n\n    return result;\n  }\n}\n", "import { View } from './view';\nimport { Template } from '../Template';\nimport { getPrefixedClasses } from '../util';\n\nconst classes = getPrefixedClasses(\n  'imagePlaceholder',\n  'placeholder'\n);\n\nconst template = new Template(({ classes }) => /* html */`\n  <div class=\"${classes.placeholder} ${classes.imagePlaceholder}\"></div>\n`);\n\ntype ImageOptions = {\n  classNames?: string;\n};\n\nexport class Image extends View {\n  private classNames?: string;\n\n  constructor({ classNames }: ImageOptions = {}) {\n    super({ template, classes });\n    this.classNames = classNames;\n  }\n\n  load(src: string | Promise<string>) {\n    const img = document.createElement('img');\n    if (this.classNames) {\n      img.className = this.classNames;\n    }\n\n    img.addEventListener('load', () => {\n      this.el.replaceWith(img);\n    }, { once: true });\n\n    Promise.resolve(src).then(src => img.src = src);\n  }\n\n  renderSync() {\n    super.renderSync();\n    if (this.classNames) {\n      const classNames = this.classNames.split(' ');\n      classNames.forEach(className => this.el.classList.add(className));\n    }\n\n    return this.el;\n  }\n}\n", "import { LazyLoader } from '../LazyLoader';\nimport { CustomEmoji, EmojiRecord, EmojiSelection } from '../types';\nimport { View } from '../views/view';\nimport { Image } from '../views/Image';\nimport { getPrefixedClasses } from '../util';\n\nconst classes = getPrefixedClasses('customEmoji');\n\nexport type RenderTask = {\n  content: View | Element;\n  resolver?: () => Element;\n}\n\nexport abstract class Renderer {\n  abstract render(emoji: EmojiRecord, classNames?: string): RenderTask;\n  abstract emit(emoji: EmojiRecord): EmojiSelection | Promise<EmojiSelection>;\n\n  renderElement(content: Element): RenderTask {\n    return { content };\n  }\n\n  renderImage(classNames = '', urlResolver: () => string | Promise<string>): RenderTask {\n    const image = new Image({ classNames });\n    image.renderSync();\n\n    const resolver = () => {\n      image.load(urlResolver());\n      return image.el;\n    }\n\n    return { content: image, resolver };\n  }\n\n  doRender(emoji: EmojiRecord, lazyLoader?: LazyLoader, classNames?: string): Element {\n    if (emoji.custom) {\n      return this.renderCustom(emoji as CustomEmoji, lazyLoader, classNames);\n    }\n\n    const { content, resolver } = this.render(emoji, classNames);\n    const contentElement = content instanceof Element ? content : content.el;\n\n    // if (lazyLoader && resolver) {\n    //   return lazyLoader.lazyLoad(contentElement, resolver)\n    // }\n\n    if (resolver) {\n      resolver();\n    }\n    return contentElement;\n  }\n\n  doEmit(emoji: EmojiRecord): EmojiSelection | Promise<EmojiSelection> {\n    if (emoji.custom) {\n      return this.emitCustom(emoji as CustomEmoji);\n    }\n\n    return this.emit(emoji);\n  }\n\n  emitCustom({ url, label, emoji, data }: CustomEmoji): EmojiSelection {\n    return { url, label, emoji, data };\n  }\n\n  renderCustom(emoji: CustomEmoji, lazyLoader?: LazyLoader, additionalClasses = ''): Element {\n    const classNames = [classes.customEmoji, additionalClasses].join(' ').trim();\n\n    const { content, resolver } = this.renderImage(classNames, () => emoji.url);\n    const contentElement = content instanceof Element ? content : content.el;\n\n    if (resolver) {\n      resolver();\n    }\n\n    return contentElement;\n  }\n}\n", "import { Renderer } from './renderer';\nimport { EmojiRecord, EmojiSelection } from '../types';\nimport { Template } from '../Template';\n\nconst template = new Template(({ emoji }) => /* html */ `<span>${emoji}</span>`);\n\nexport class NativeRenderer extends Renderer {\n  render(emoji: EmojiRecord) {\n    return this.renderElement(template.renderSync({ emoji: emoji.emoji }));\n  }\n\n  emit({ emoji, hexcode, label }: EmojiRecord): EmojiSelection {\n    return { emoji, hexcode, label };\n  }\n}\n", "export default {\n  'categories.activities': 'Activities',\n  'categories.animals-nature': 'Animals & Nature',\n  'categories.custom': 'Custom',\n  'categories.flags': 'Flags',\n  'categories.food-drink': 'Food & Drink',\n  'categories.objects': 'Objects',\n  'categories.people-body': 'People & Body',\n  'categories.recents': 'Recently Used',\n  'categories.smileys-emotion': 'Smileys & Emotion',\n  'categories.symbols': 'Symbols',\n  'categories.travel-places': 'Travel & Places',\n  'error.load': 'Failed to load emojis',\n  'recents.clear': 'Clear recent emojis',\n  'recents.none': 'You haven\\'t selected any emojis yet.',\n  'retry': 'Try again',\n  'search.clear': 'Clear search',\n  'search.error': 'Failed to search emojis',\n  'search.notFound': 'No results found',\n  'search': 'Search emojis...'\n};\n", "import { GroupMessage, Emoji, Locale } from 'emojibase';\nimport { PickerOptions, EmojiRecord, Category, CategoryKey } from '../types';\nimport { applyRules } from '../rules';\nimport { queryMatches, getEmojiRecord, DataStore } from './DataStore';\n\n// Base database name. It will have the locale appended to it.\nconst DATABASE_NAME = 'PicMo';\n\nexport function IndexedDbStoreFactory(locale: Locale): DataStore {\n  return new IndexedDbStore(locale);\n}\n\nIndexedDbStoreFactory.deleteDatabase = (locale: Locale) => {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.deleteDatabase(`${DATABASE_NAME}-${locale}`);\n    request.addEventListener('success', resolve);\n    request.addEventListener('error', reject);\n  });\n};\n\nexport class IndexedDbStore extends DataStore {\n  private db: IDBDatabase;\n\n  /**\n   * Creates/opens the database.\n   *\n   * There are three data stores:\n   *\n   * - category: stores the categories\n   * - emoji: stores the emoji data itself\n   * - meta: stores metadata such as the ETags\n   *\n   * @returns a Promise that resolves when the database is ready\n   */\n  async open(): Promise<void> {\n    const request = indexedDB.open(`${DATABASE_NAME}-${this.locale}`);\n\n    return new Promise((resolve, reject) => {\n      request.addEventListener('success', (event: any) => {\n        this.db = event.target?.result;\n        resolve();\n      });\n\n      request.addEventListener('error', reject);\n\n      request.addEventListener('upgradeneeded', async (event: any) => {\n        this.db = event.target?.result;\n\n        this.db.createObjectStore('category', { keyPath: 'order' });\n\n        const emojiStore = this.db.createObjectStore('emoji', { keyPath: 'emoji' });\n        emojiStore.createIndex('category', 'group');\n        emojiStore.createIndex('version', 'version');\n\n        this.db.createObjectStore('meta');\n      });\n    });\n  }\n\n  async delete() {\n    this.close();\n    const request = indexedDB.deleteDatabase(`${DATABASE_NAME}-${this.locale}`);\n    await this.waitForRequest(request);\n  }\n\n  close() {\n    this.db.close();\n  }\n\n  async getEmojiCount(): Promise<number> {\n    const transaction = this.db.transaction('emoji', 'readonly');\n    const store = transaction.objectStore('emoji');\n    const result = await this.waitForRequest(store.count());\n    return result.target.result;\n  }\n\n  /**\n   * Gets the ETags stored in the meta datastore.\n   * @returns a Promise that resolves to the ETag data\n   */\n  async getEtags(): Promise<Record<string, string | undefined>> {\n    const transaction = this.db.transaction('meta', 'readonly');\n    const store = transaction.objectStore('meta');\n    const [emojisEtag, messagesEtag] = await Promise.all([\n      this.waitForRequest(store.get('emojisEtag')),\n      this.waitForRequest(store.get('messagesEtag'))\n    ]);\n\n    return {\n      storedEmojisEtag: emojisEtag.target.result,\n      storedMessagesEtag: messagesEtag.target.result\n    };\n  }\n\n  /**\n   * Stores ETag values for the emoji and message data.\n   * @param emojisEtag the ETag for the emoji data\n   * @param messagesEtag the ETag for the message data\n   */\n  async setMeta(meta) {\n    const transaction = this.db.transaction('meta', 'readwrite');\n    const store = transaction.objectStore('meta');\n\n    return new Promise(resolve => {\n      transaction.oncomplete = resolve;\n\n      const properties = Object.keys(meta).filter(Boolean);\n      properties.forEach(property => {\n        store.put(meta[property], property);\n      });\n    });\n  }\n\n  async getHash() {\n    const transaction = this.db.transaction('meta', 'readonly');\n    const store = transaction.objectStore('meta');\n    const result = await this.waitForRequest(store.get('hash'));\n    return result.target.result;\n  }\n\n  /**\n   * Determines whether or not the database is populated.\n   *\n   * @returns a Promise that resolves to a boolean indicating the populated state\n   */\n  async isPopulated(): Promise<boolean> {\n    const transaction = this.db.transaction('category', 'readonly');\n    const store = transaction.objectStore('category');\n    const categoryCountResult = await this.waitForRequest(store.count());\n    const categoryCount = categoryCountResult.target.result;\n    return categoryCount > 0;\n  }\n\n  /**\n   * Removes any current data and re-populates the data stores with the given data.\n   *\n   * @param groups the group message data\n   * @param emojis the emoji data\n   * @param emojisEtag the emoji data ETag\n   * @param messagesEtag the message data ETag\n   * @returns a Promise that resolves when all data has been written\n   */\n  async populate({\n    groups,\n    emojis,\n    emojisEtag,\n    messagesEtag,\n    hash\n  }: {\n    groups: GroupMessage[];\n    emojis: Emoji[];\n    emojisEtag?: string | null;\n    messagesEtag?: string | null;\n    hash?: string | null;\n  }) {\n    // Wipe out any old data first\n    await this.removeAllObjects('category', 'emoji');\n\n    const tasks = [\n      this.addObjects('category', groups),\n      this.addObjects('emoji', emojis),\n      this.setMeta({ emojisEtag, messagesEtag, hash })\n    ];\n\n    await Promise.all(tasks);\n  }\n\n  /**\n   * Gets the emoji categories.\n   *\n   * If an include list is specified, only those categories will be returned - and will be in the same sort order.\n   * Otherwise, all categories (except 'component') are returned.\n   *\n   * @param include an array of CategoryKeys to include\n   * @returns an arrya of all categories, or only the ones specified if include is given\n   */\n  async getCategories(options: PickerOptions): Promise<Category[]> {\n    const transaction = this.db.transaction('category', 'readonly');\n    const categoryStore = transaction.objectStore('category');\n    const result = await this.waitForRequest(categoryStore.getAll());\n    let categories = result.target.result.filter(category => category.key !== 'component');\n\n    if (options.showRecents) {\n      categories.unshift({ key: 'recents', order: -1 });\n    }\n\n    if (options.custom?.length) {\n      categories.push({ key: 'custom', order: 10 });\n    }\n\n    if (options.categories) {\n      const includeList = options.categories as CategoryKey[];\n      categories = categories.filter(category => includeList.includes(category.key));\n      categories.sort((a: Category, b: Category) => includeList.indexOf(a.key) - includeList.indexOf(b.key));\n    } else {\n      categories.sort((a: Category, b: Category) => a.order - b.order);\n    }\n\n    return categories;\n  }\n\n  /**\n   * Gets all emojis for a particular category and emoji version.\n   *\n   * @param category the category to get emojis for\n   * @param emojiVersion the maximum version for returned emojis\n   * @returns a Promise that resolves to an array of the EmojiRecord data\n   */\n  async getEmojis(category: Category, emojiVersion: number): Promise<EmojiRecord[]> {\n    const transaction = this.db.transaction('emoji', 'readonly');\n    const emojiStore = transaction.objectStore('emoji');\n    const groupsIndex = emojiStore.index('category');\n    const result = await this.waitForRequest(groupsIndex.getAll(category.order));\n    const emojis = result.target.result as Emoji[];\n    const records = emojis\n      .filter((e: Emoji) => e.version <= emojiVersion)\n      .sort((a: Emoji, b: Emoji) => {\n        if (a.order != null && b.order != null) {\n          return a.order - b.order;\n        }\n\n        return 0;\n      })\n      .map(getEmojiRecord);\n\n    return applyRules(records, emojiVersion);\n  }\n\n  /**\n   * Searches the database for emojis.\n   *\n   * @param query the text query\n   * @param customEmojis the custom emojis\n   * @param emojiVersion the maximum emoji version for search results\n   * @param categories the categories to search\n   * @returns a Promise that resolves to the matching EmojiRecords\n   */\n  async searchEmojis(\n    query: string,\n    customEmojis: EmojiRecord[],\n    emojiVersion: number,\n    categories: Category[]\n  ): Promise<EmojiRecord[]> {\n    const results: EmojiRecord[] = [];\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction('emoji', 'readonly');\n      const emojiStore = transaction.objectStore('emoji');\n      const request = emojiStore.openCursor();\n\n      request.addEventListener('success', (event: any) => {\n        const cursor: IDBCursorWithValue = event.target?.result;\n        if (!cursor) {\n          return resolve([\n            // matching emojis from the database\n            ...applyRules(results, emojiVersion),\n\n            // matching custom emojis\n            ...customEmojis.filter(emoji => queryMatches(emoji, query))\n          ]);\n        }\n\n        const emoji = cursor.value as Emoji;\n        if (queryMatches(emoji, query, categories) && emoji.version <= emojiVersion) {\n          results.push(getEmojiRecord(emoji));\n        }\n\n        cursor.continue();\n      });\n\n      request.addEventListener('error', (error: Event) => {\n        reject(error);\n      });\n    });\n  }\n\n  /**\n   * Waits for a request to complete.\n   *\n   * @param request the request\n   * @returns a Promise that resolves when the request succeeds, or rejects if it fails\n   */\n  async waitForRequest(request: IDBRequest): Promise<any> {\n    return new Promise((resolve, reject) => {\n      request.onsuccess = resolve;\n      request.onerror = reject;\n    });\n  }\n\n  /**\n   * Wraps an operation in an IndexedDB transaction.\n   *\n   * @param storeName the data store(s) to use\n   * @param mode the transaction mode\n   * @param callback a callback containing the work to do in the transaction\n   * @returns a Promise that resolves when the transaction completes, or rejects if it fails\n   */\n  protected withTransaction(\n    storeName: string | string[],\n    mode: IDBTransactionMode = 'readwrite',\n    callback: (transaction: IDBTransaction) => void\n  ) {\n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction(storeName, mode);\n      transaction.oncomplete = resolve;\n      transaction.onerror = reject;\n\n      callback(transaction);\n    });\n  }\n\n  /**\n   * Removes all entries from one or more stores.\n   * @param storeNames the stores to clear\n   * @return a Promise that resolves when the clear is complete\n   */\n  protected async removeAllObjects(...storeNames: string[]) {\n    const transaction = this.db.transaction(storeNames, 'readwrite');\n    const stores = storeNames.map(storeName => transaction.objectStore(storeName));\n    await Promise.all(stores.map(store => this.waitForRequest(store.clear())));\n  }\n\n  /**\n   * Adds a collection of objects to a data store.\n   *\n   * @param storeName the store to populate\n   * @param objects the objects to add\n   * @returns a Promise that resolves when the add is complete, or rejects if it fails\n   */\n  protected async addObjects(storeName: string, objects: any[]) {\n    return this.withTransaction(storeName, 'readwrite', transaction => {\n      const store = transaction.objectStore(storeName);\n      objects.forEach(object => {\n        store.add(object);\n      });\n    });\n  }\n}\n", "// A super basic in-memory WebStorage emulation. This is required in\n// some environments where localStorage/sessionStorage are not allowed.\nexport function createStorage(): Storage {\n  let data = {};\n\n  return {\n    getItem: key => data[key],\n    setItem: (key, value) => data[key] = value,\n    length: Object.keys(data).length,\n    clear: () => data = {},\n    key: index => Object.keys(data)[index],\n    removeItem: key => delete data[key]\n  };\n}", "import { EmojiRecord } from '../types';\n\nexport abstract class RecentsProvider {\n  abstract clear(): void;\n  abstract getRecents(maxCount: number): Array<EmojiRecord>;\n  abstract addOrUpdateRecent(emoji: EmojiRecord, maxCount: number): void;\n}\n", "import { EmojiRecord } from '../types';\nimport { RecentsProvider } from './RecentsProvider';\n\nconst STORAGE_KEY = 'PicMo:recents';\n\nexport abstract class WebStorageProvider extends RecentsProvider {\n     storage: Storage;\n\n  constructor(storage: Storage) {\n    super();\n    this.storage = storage;\n  }\n\n  clear(): void {\n    this.storage.removeItem(STORAGE_KEY);\n  }\n\n  getRecents(maxCount: number): Array<EmojiRecord> {\n    try {\n      const recents = JSON.parse(this.storage.getItem(STORAGE_KEY) ?? '[]');\n      return recents.slice(0, maxCount);\n    } catch (error) { // storage is not available, no recents\n      return [];\n    }\n  }\n\n  addOrUpdateRecent(emoji: EmojiRecord, maxCount: number) {\n    // Add the new recent to the beginning of the list, removing it if it exists already\n    const recents = [\n      emoji,\n      ...this.getRecents(maxCount).filter(recent => recent.hexcode !== emoji.hexcode)\n    ].slice(0, maxCount);\n    \n    try {\n      this.storage.setItem(STORAGE_KEY, JSON.stringify(recents));\n    } catch (error) {\n      console.warn('storage is not available, recent emojis will not be saved');\n    }\n  }\n}\n", "import { isLocalStorageAvailable } from '../util';\nimport { createStorage } from '../webStorageShim';\nimport { WebStorageProvider } from './WebStorageProvider';\n\nexport class LocalStorageProvider extends WebStorageProvider {\n  constructor() {\n    super(isLocalStorageAvailable() ? localStorage : createStorage());\n  }\n}\n", "import { PickerOptions } from './types';\nimport { lightTheme } from './themes';\nimport { NativeRenderer } from './renderers/native';\nimport en from './i18n/lang-en';\nimport { IndexedDbStoreFactory } from './data/IndexedDbStore';\nimport { LocalStorageProvider } from './recents/LocalStorageProvider';\n\nconst defaultOptions: Partial<PickerOptions> = {\n  dataStore: IndexedDbStoreFactory,\n  theme: lightTheme,\n\n  animate: true,\n\n  showCategoryTabs: true,\n  showPreview: true,\n  showRecents: true,\n  showSearch: true,\n  showVariants: true,\n\n  emojisPerRow: 8,\n  visibleRows: 6,\n\n  emojiVersion: 'auto',\n  i18n: en,\n  locale: 'en',\n\n  maxRecents: 50,\n\n  custom: []\n};\n\nexport function getOptions(options: Partial<PickerOptions> = {}): PickerOptions {\n  return { \n    ...defaultOptions,\n    ...options,\n    renderer: options.renderer || new NativeRenderer(),\n    recentsProvider: options.recentsProvider || new LocalStorageProvider()\n  } as PickerOptions;\n}\n", "export type AsyncEventCallback = (...args: any[]) => Promise<void>;\nexport type EventCallback = (...args: any[]) => void;\nexport type EventArgs = any[];\n\nexport type EventKey<T> = Extract<T, string>;\n\nexport type EventBinding = {\n  context?: any;\n  handler: EventCallback;\n  once?: boolean;\n};\n\nexport type EventHandlerRecord<T> = {\n  event: EventKey<T>;\n  handler: EventCallback;\n};\n\nexport class Events<T> {\n  #events: Map<string, EventBinding[]> = new Map();\n  \n  #getBindings(event: EventKey<T>): EventBinding[] {\n    if (!this.#events.has(event)) {\n      this.#events.set(event, []);\n    }\n\n    return this.#events.get(event) as EventBinding[];\n  }\n\n  #addListener(event: EventKey<T>, handler: EventCallback, context?: any, once = false) {\n    const bindings = this.#getBindings(event);\n    bindings.push({ context, handler, once });\n  }\n\n  on(event: EventKey<T>, handler: EventCallback, context?: any) {\n    this.#addListener(event, handler, context);\n  }\n\n  once(event: EventKey<T>, handler: EventCallback, context?: any) {\n    this.#addListener(event, handler, context, true);\n  }\n\n  off(event: EventKey<T>, handler: EventCallback) {\n    const bindings = this.#getBindings(event);\n    this.#events.set(event, bindings.filter(h => h.handler !== handler));\n  }\n\n  emit(event: EventKey<T>, ...args: EventArgs) {\n    const bindings = this.#getBindings(event);\n    bindings.forEach((binding: EventBinding) => {\n      binding.handler.apply(binding.context, args);\n      if (binding.once) {\n        this.off(event, binding.handler);\n      }\n    });\n  }\n\n  removeAll() {\n    this.#events.clear();\n  }\n}\n", "export default {\n  injectStyles: true\n};\n", "import { Events, EventKey } from './events';\n\nexport type AppEvent =\n  | 'data:ready'\n  | 'error'\n  | 'reinitialize'\n  | 'emoji:select'\n  | 'content:show'\n  | 'preview:show'\n  | 'preview:hide'\n  | 'variantPopup:hide'\n  | 'category:select'\n  | 'category:next'\n  | 'category:previous'\n  | 'recent:add'\n  | 'focus:change';\n\nexport type AppEventKey = EventKey<AppEvent>;\n\nexport class AppEvents extends Events<AppEvent> {}\n", "import { Events, EventKey } from './events';\n\nexport type ExternalEvent = \n  'emoji:select' |\n  'data:ready';\n\nexport type ExternalEventKey = EventKey<ExternalEvent>;\n\nexport class ExternalEvents extends Events<ExternalEvent> {}\n", "import { View } from './view';\nimport { Template } from '../Template';\nimport { EmojiContainer } from './EmojiContainer';\nimport { Category, EmojiFocusTarget } from '../types';\nimport { LazyLoader } from '../LazyLoader';\nimport { getPrefixedClasses } from '../util';\n\ntype BaseEmojiCategoryOptions = {\n  category: Category;\n  showVariants: boolean;\n  lazyLoader?: LazyLoader;\n  template: Template;\n}\n\nexport const classes = getPrefixedClasses(\n  'emojiCategory',\n  'categoryName',\n  'noRecents',\n  'recentEmojis'\n);\n\nexport abstract class BaseEmojiCategory extends View {\n  category: Category;\n  protected showVariants: boolean;\n  protected lazyLoader?: LazyLoader;\n  protected emojiContainer: EmojiContainer;\n\n  protected baseUIElements = {\n    categoryName: View.byClass(classes.categoryName)\n  }\n\n  setActive(active: boolean, focusTarget?: EmojiFocusTarget, performFocus?: boolean) {\n    this.emojiContainer.setActive(active, focusTarget, performFocus);\n  }\n\n  constructor({ template, category, showVariants, lazyLoader }: BaseEmojiCategoryOptions) {\n    super({ template, classes });\n\n    this.category = category;\n    this.showVariants = showVariants;\n    this.lazyLoader = lazyLoader;\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classes, emoji }) => /* html */`\n  <button\n    type=\"button\"\n    class=\"${classes.emojiButton}\"\n    title=\"${emoji.label}\"\n    data-emoji=\"${emoji.emoji}\"\n    tabindex=\"-1\">\n    <div data-placeholder=\"emojiContent\"></div>\n  </button>\n`);", "import { LazyLoader } from '../LazyLoader';\n\nimport { View } from './view';\n\nimport { CategoryKey, EmojiRecord } from '../types';\n\nimport template from './Emoji.template';\nimport { getPrefixedClasses } from '../util';\n\nconst classes = getPrefixedClasses('emojiButton');\n\n\ntype EmojiOptions = {\n  emoji: EmojiRecord\n  lazyLoader?: LazyLoader;\n  category?: CategoryKey;\n};\n\nexport class Emoji extends View {\n  private emoji: EmojiRecord\n  private lazyLoader?: LazyLoader;\n  private category?: CategoryKey;\n\n  constructor({ emoji, lazyLoader, category }: EmojiOptions) {\n    super({ template, classes });\n\n    this.emoji = emoji;\n    this.lazyLoader = lazyLoader;\n    this.category = category;\n  }\n\n  initialize() {\n    this.uiEvents = [\n      View.uiEvent('focus', this.handleFocus)\n    ];\n    \n    super.initialize();\n  }\n\n  private handleFocus() {\n    if (this.category) {\n      this.events.emit('focus:change', this.category);\n    }\n  }\n\n  activateFocus(performFocus?: boolean) {\n    this.el.tabIndex = 0;\n    if (performFocus) {\n      this.el.focus();\n    }\n  }\n\n  deactivateFocus() {\n    this.el.tabIndex = -1;\n  }\n\n  renderSync(): HTMLElement {\n    return super.renderSync({\n      emoji: this.emoji,\n      emojiContent: this.renderer.doRender(this.emoji, this.lazyLoader)\n    });\n  }\n}\n", "import { Events } from './events';\n\ntype FocusGridEvent = 'focus:change' | 'focus:underflow' | 'focus:overflow';\n\nexport type FocusChangeEvent = {\n  from: number;\n  to: number;\n  performFocus: boolean;\n};\n\ntype Cell = {\n  row: number;\n  column: number;\n};\n\n/**\n * Represents an array of emojis as a grid with rows and columns as they appear in the UI.\n * This makes focus traversal calculations less complex in the EmojiContainer.\n * \n * The grid is given a flat array of emojis for the current category and the number of columns. It will create\n * a virtual grid structure mapping those emojis to rows of the desired length.\n * \n * The focus can be traversed left, right, up, and down, or to a specific row and column coordinate. Later, the currently\n * selected grid cell can be translated back to the index in the original emoji array.\n * \n * The grid emits three events:\n * - focus:change - when the focused cell changes\n *                  Event properties: from (the previous index), to (the new index), and performFocus (whether to focus the new cell)\n * \n * - focus:underflow - when the focus tries to move below the first emoji in the category\n *                     Event properties: index (the current index within the grid)\n * \n * - focus:overflow - when the focus tries to move beyond the last emoji in the category\n *                     Event properties: index (the current index within the grid)\n */\n export class FocusGrid {\n  private focusedRow: number;\n  private focusedColumn: number;\n  private rowCount: number;\n  private columnCount: number;\n  private emojiCount: number;\n  private wrap: boolean;\n\n  private events = new Events<FocusGridEvent>();\n\n  /** Maps focus traversal keys to their associated handlers. */\n  private keyHandlers = {\n    ArrowLeft: this.focusPrevious.bind(this),\n    ArrowRight: this.focusNext.bind(this),\n    ArrowUp: this.focusUp.bind(this),\n    ArrowDown: this.focusDown.bind(this)\n  };\n\n  /**\n   * Creates a FocusGrid.\n   * \n   * @param columnCount The number of columns in the emoji picker.\n   * @param emojiCount The total number of emojis in this category.\n   * @param initialRow The initial focused row.\n   * @param initialColumn The initial focused column.\n   */\n  constructor(columnCount: number, emojiCount: number, initialRow = 0, initialColumn = 0, wrap = false) {\n    this.rowCount = Math.ceil(emojiCount / columnCount);\n    this.columnCount = columnCount;\n    this.focusedRow = initialRow;\n    this.focusedColumn = initialColumn;\n    this.emojiCount = emojiCount;\n    this.wrap = wrap;\n\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n  }\n\n  /**\n   * Removes all bound event listeners.\n   */\n  destroy() {\n    this.events.removeAll();\n  }\n\n  /**\n   * Public API for listening for focus events.\n   */\n  on(event: FocusGridEvent, handler: (...args: any[]) => void) {\n    this.events.on(event, handler);\n  }\n\n  /**\n   * Handles keydown events that are forwarded from the EmojiContainer and executes\n   * the appropriate focus function.\n   * @param event the KeyboardEvent that occurred\n   */\n  handleKeyDown(event: KeyboardEvent) {\n    if (event.key in this.keyHandlers) {\n      event.preventDefault();\n      this.keyHandlers[event.key]();\n    }\n  }\n\n  /**\n   * Sets the focused cell to a specific row and, optionally, column. If no column is specified,\n   * the focused column remains unchanged.\n   * \n   * The `performFocus` flag determines whether the focus should be moved to the new cell. If it\n   * is false, the focused element will be changed but the actual focus() call will not be triggered yet.\n   * \n   * @param row The new focused row\n   * @param column The new focused column, if specified\n   * @param performFocus Whether or not to perform the actual focus operation.\n   */\n  setCell(row: number, column?: number, performFocus = true) {\n    const previousIndex = this.getIndex();\n    this.focusedRow = row;\n\n    if (column !== undefined) {\n      // If the column exceeds the column count, focus the last column.\n      this.focusedColumn = Math.min(this.columnCount, column);\n    }\n\n    // If the given cell is out of bounds, focus to the last cell.\n    if (this.focusedRow >= this.rowCount || this.getIndex() >= this.emojiCount) {\n      this.focusedRow = this.rowCount - 1;\n      this.focusedColumn = (this.emojiCount % this.columnCount) - 1;\n    }\n\n    this.events.emit('focus:change', { from: previousIndex, to: this.getIndex(), performFocus });\n  }\n\n  setFocusedIndex(index: number, performFocus = true) {\n    const row = Math.floor(index / this.columnCount);\n    const column = index % this.columnCount;\n    this.setCell(row, column, performFocus);\n  }\n\n  /**\n   * Moves the focus to the next cell in the current row.\n   * Emits `focus:overflow` if there is no next cell. \n   */\n  focusNext() {\n    if (this.focusedColumn < this.columnCount - 1 && this.getIndex() < this.emojiCount - 1) {\n      this.setCell(this.focusedRow, this.focusedColumn + 1);\n    } else if (this.focusedRow < this.rowCount - 1) {\n      this.setCell(this.focusedRow + 1, 0);\n    } else if (this.wrap) {\n      this.setCell(0, 0);\n    } else {\n      this.events.emit('focus:overflow', 0);\n    }\n  }\n\n  /**\n   * Moves the focus to the previous cell in the current row.\n   * Emits `focus:underflow` if there is no previous cell.\n   */\n  focusPrevious() {\n    if (this.focusedColumn > 0) {\n      this.setCell(this.focusedRow, this.focusedColumn - 1);\n    } else if (this.focusedRow > 0) {\n      this.setCell(this.focusedRow - 1, this.columnCount - 1);\n    } else if (this.wrap) {\n      this.setCell(this.rowCount - 1, this.columnCount - 1);\n    } else {\n      this.events.emit('focus:underflow', this.columnCount - 1);\n    }\n  }\n\n  /**\n   * Moves the focus to the cell directly above the current one.\n   * Emits `focus:underflow` if the current cell is in the first row.\n   */\n  focusUp() {\n    if (this.focusedRow > 0) {\n      this.setCell(this.focusedRow - 1, this.focusedColumn);\n    } else {\n      this.events.emit('focus:underflow', this.focusedColumn);\n    }\n  }\n\n  /**\n   * Moves the focus to the cell directly below the current one.\n   * Emits `focus:overflow` if the current cell is in the last row.\n   */\n  focusDown() {\n    if (this.focusedRow < this.rowCount - 1) {\n      this.setCell(this.focusedRow + 1, this.focusedColumn);\n    } else {\n      this.events.emit('focus:overflow', this.focusedColumn);\n    }\n  }\n\n  /**\n   * Moves the focus to a specific emoji in the category.\n   * @param index the index of the emoji to focus on\n   */\n  focusToIndex(index: number) {\n    this.setCell(Math.floor(index / this.columnCount), index % this.columnCount);\n  }\n\n  /**\n   * Gets the index in the emoji array of the currently focused cell.\n   * @returns the currently focused cell's index\n   */\n  getIndex(): number {\n    return (this.focusedRow * this.columnCount) + this.focusedColumn;\n  }\n\n  /**\n   * Gets the row and column of the currently focused cell.\n   * @returns the row and column data\n   */\n  getCell(): Cell {\n    return { row: this.focusedRow, column: this.focusedColumn };\n  }\n\n  /**\n   * Gets the total number of rows in the grid\n   * @returns the number of rows in the grid\n   */\n  getRowCount() {\n    return this.rowCount;\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classes }) => /* html */`\n  <div class=\"${classes.emojiContainer}\">\n    <div data-placeholder=\"emojis\"></div>\n  </div>\n`);\n", "import { Emoji } from './Emoji';\nimport { LazyLoader } from '../LazyLoader';\nimport { getEmojiForEvent, getPrefixedClasses } from '../util';\nimport { View } from './view';\nimport { CategoryKey, EmojiFocusTarget, EmojiRecord } from '../types';\nimport { FocusGrid, FocusChangeEvent } from '../focusGrid';\n\nimport template from './EmojiContainer.template';\n\nconst classes = getPrefixedClasses('emojiContainer');\n\ntype EmojiContainerOptions = {\n  emojis: EmojiRecord[];\n  showVariants: boolean;\n  preview: boolean;\n  lazyLoader?: LazyLoader;\n  category?: CategoryKey;\n  fullHeight?: boolean;\n};\n\n/**\n * An EmojiContainer contains all the emojis in a given category.\n * \n * It manages keybaord focus for all emojis in the category.\n */\nexport class EmojiContainer extends View {\n  protected emojis: EmojiRecord[];\n  protected showVariants: boolean;\n  protected preview: boolean;\n  protected lazyLoader?: LazyLoader;\n  private category?: CategoryKey;\n  private grid: FocusGrid;\n  emojiViews: Emoji[];\n  emojiElements: HTMLElement[];\n  fullHeight = false;\n\n  constructor({ emojis, showVariants, preview = true, lazyLoader, category, fullHeight = false }: EmojiContainerOptions) {\n    super({ template, classes });\n\n    this.showVariants = showVariants;\n    this.lazyLoader = lazyLoader;\n    this.preview = preview;\n    this.emojis = emojis;\n    this.category = category;\n    this.fullHeight = fullHeight;\n\n    this.setFocus = this.setFocus.bind(this);\n    this.triggerNextCategory = this.triggerNextCategory.bind(this);\n    this.triggerPreviousCategory = this.triggerPreviousCategory.bind(this);\n  }\n\n  initialize() {\n    this.grid = new FocusGrid(this.options.emojisPerRow, this.emojiCount, 0, 0, !this.category);\n    this.grid.on('focus:change', this.setFocus);\n    this.grid.on('focus:overflow', this.triggerNextCategory);\n    this.grid.on('focus:underflow', this.triggerPreviousCategory);\n\n    this.uiEvents = [\n      View.uiEvent('click', this.selectEmoji),\n      View.uiEvent('keydown', this.grid.handleKeyDown)\n    ];\n\n    if (this.preview) {\n      this.uiEvents.push(\n        View.uiEvent('mouseover', this.showPreview),\n        View.uiEvent('mouseout', this.hidePreview),\n        View.uiEvent('focus', this.showPreview, { capture: true }),\n        View.uiEvent('blur', this.hidePreview, { capture: true })\n      );\n    }\n\n    super.initialize();\n  }\n\n  /**\n   * Marks the specified cell in the emoji grid as focused.\n   * \n   * @param focusTarget The target emoji to make focusable.\n   * @param performFocus Whether or not to actually focus the new target.\n   */\n  private setFocusedView(focusTarget: EmojiFocusTarget | undefined, performFocus?: boolean): void {\n    if (!focusTarget) {\n      return;\n    }\n\n    if (typeof focusTarget === 'string') {\n      const index = this.emojis.findIndex(emoji => emoji.emoji === focusTarget);\n      this.grid.setFocusedIndex(index, false);\n\n      setTimeout(() => {\n        const targetView = this.emojiViews[index].el;\n        targetView.scrollIntoView();\n\n        // Need to scroll up a bit to offset the sticky header\n        const header = targetView.parentElement?.previousElementSibling as HTMLElement;\n        const emojiArea = targetView.parentElement?.parentElement?.parentElement as HTMLElement;\n        emojiArea.scrollTop -= header?.offsetHeight ?? 0;\n      });\n    } else if (focusTarget.row === 'first' || focusTarget.row === 0) {\n      this.grid.setCell(0, focusTarget.offset, performFocus);\n    } else if (focusTarget.row === 'last') {\n      this.grid.setCell(this.grid.getRowCount() - 1, focusTarget.offset, performFocus);\n    }\n  }\n\n  /**\n   * Sets the active state of this category's emojis. If a category is active, its emojis\n   * are focusable.\n   * \n   * @param active the desired active state\n   * @param focusTarget the target emoji to make focusable if active is true\n   * @param performFocus whether or not to actually focus the new target if active is true\n   */\n  setActive(active: boolean, focusTarget?: EmojiFocusTarget, performFocus?: boolean) {\n    if (active) {\n      this.setFocusedView(focusTarget, performFocus);\n    } else {\n      this.emojiViews[this.grid.getIndex()]?.deactivateFocus();\n    }\n  }\n\n  renderSync(): HTMLElement {\n    this.emojiViews = this.emojis.map(emoji =>\n      this.viewFactory.create(Emoji, {\n        emoji,\n        category: this.category,\n        lazyLoader: this.lazyLoader,\n        renderer: this.renderer\n      })\n    );\n\n    this.emojiElements = this.emojiViews.map(view => view.renderSync());\n\n    return super.renderSync({\n      emojis: this.emojiElements,\n      i18n: this.i18n\n    });\n  }\n\n  destroy() {\n    super.destroy();\n    this.emojiViews.forEach(view => view.destroy());\n    this.grid.destroy();\n  }\n\n  /**\n   * Causes the previous category to become active/focusable due to a focus:underflow event.\n   * @param column the currently focused column\n   */\n  private triggerPreviousCategory(column: number) {\n    this.events.emit('category:previous', column);\n  }\n\n  /**\n   * Causes the next category to become active/focusable due to a focus:overflow event.\n   * @param column the currently focused column\n   */\n  private triggerNextCategory(column: number) {\n    if (this.category) {\n      this.events.emit('category:next', column);\n    }\n  }\n\n  /**\n   * Reacts to a focus:change event from the grid.\n   * \n   * The current emoji is deactivated, and the new emoji is activated.\n   * An event is then emitted which will pause the scroll listener in the main emoji area,\n   * otherwise the active category tab can get out of sync.\n   * \n   * @param event The focus:change event.\n   */\n  private setFocus({ from, to, performFocus }: FocusChangeEvent) {\n    this.emojiViews[from]?.deactivateFocus();\n    this.emojiViews[to]?.activateFocus(performFocus);\n  }\n\n  private selectEmoji(event: Event) {\n    // Prevent the document click listener from firing, which in some cases\n    // can cause the picker to close even when it's configured not to.\n    event.stopPropagation();\n    const emoji = getEmojiForEvent(event, this.emojis);\n    if (emoji) {\n      this.events.emit('emoji:select', {\n        emoji,\n        showVariants: this.showVariants\n      });\n    }\n  }\n\n  private showPreview(event: Event) {\n    const target = event.target as HTMLElement;\n    const button = target.closest('button');\n    const content = button?.firstElementChild;\n    \n    const emoji = getEmojiForEvent(event, this.emojis);\n    if (emoji) {\n      this.events.emit('preview:show', emoji, content?.cloneNode(true));\n    }\n  }\n\n  private hidePreview(event: Event) {\n    const emoji = getEmojiForEvent(event, this.emojis);\n    if (emoji) {\n      this.events.emit('preview:hide');\n    }\n  }\n\n  get emojiCount(): number {\n    return this.emojis.length;\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classes, category, pickerId, icon, i18n }) => /* html */`\n  <section class=\"${classes.emojiCategory}\" role=\"tabpanel\" aria-labelledby=\"${pickerId}-category-${category.key}\">\n    <h3 data-category=\"${category.key}\" class=\"${classes.categoryName}\">\n      <i data-icon=\"${icon}\"></i>\n      ${i18n.get(`categories.${category.key}`, category.message || category.key)}\n    </h3>\n    <div data-view=\"emojis\" data-render=\"sync\"></div>\n  </section>\n`);\n", "import { BaseEmojiCategory } from './BaseEmojiCategory';\nimport { EmojiContainer } from './EmojiContainer';\nimport { LazyLoader } from '../LazyLoader';\nimport { categoryIcons } from '../icons';\nimport { Category } from '../types';\nimport template from './EmojiCategory.template';\n\ntype EmojiCategoryOptions = {\n  category: Category;\n  showVariants: boolean;\n  lazyLoader?: LazyLoader;\n  emojiVersion: number;\n};\nexport class EmojiCategory extends BaseEmojiCategory {\n  private emojiVersion: number;\n\n  constructor({ category, showVariants, lazyLoader, emojiVersion }: EmojiCategoryOptions) {\n    super({ category, showVariants, lazyLoader, template });\n\n    this.showVariants = showVariants;\n    this.lazyLoader = lazyLoader;\n    this.emojiVersion = emojiVersion;\n  }\n\n  initialize() {\n    this.uiElements = { ...this.baseUIElements };\n    super.initialize();\n  }\n\n  async render(): Promise<HTMLElement> {\n    await this.emojiDataPromise;\n    const emojis = await this.emojiData.getEmojis(this.category, this.emojiVersion);\n\n    this.emojiContainer = this.viewFactory.create(EmojiContainer, {\n      emojis,\n      showVariants: this.showVariants,\n      lazyLoader: this.lazyLoader,\n      category: this.category.key\n    });\n\n    return super.render({\n      category: this.category,\n      emojis: this.emojiContainer,\n      emojiCount: emojis.length,\n      icon: categoryIcons[this.category.key]\n    });\n  }\n}\n", "import { EmojiContainer } from './EmojiContainer';\nimport { Emoji as EmojiView } from './Emoji';\nimport { EmojiRecord } from '../types';\n\nexport class RecentEmojiContainer extends EmojiContainer {\n  constructor({ category, emojis, preview = true, lazyLoader }) {\n    super({ category, emojis, showVariants: false, preview, lazyLoader });\n  }\n\n  async addOrUpdate(emoji: EmojiRecord): Promise<void> {\n    // If the emoji already exists, remove it as it is being moved to the front\n    const existing = this.el.querySelector(`[data-emoji=\"${emoji.emoji}\"]`);\n    if (existing) {\n      this.el.removeChild(existing);\n      this.emojis = this.emojis.filter(e => e !== emoji);\n    }\n    \n    // Add the new emoji to the beginning of the list\n    const newView = this.viewFactory.create(EmojiView, { emoji });\n    this.el.insertBefore(newView.renderSync(), this.el.firstChild);\n    this.emojis = [\n      emoji,\n      ...this.emojis.filter(e => e !== emoji)\n    ];\n\n    // Prune the list to the maximum length\n    if (this.emojis.length > this.options.maxRecents) {\n      this.emojis = this.emojis.slice(0, this.options.maxRecents);\n      const excess = this.el.childElementCount - this.options.maxRecents;\n      for (let i = 0; i < excess; i++) {\n        if (this.el.lastElementChild) {\n          this.el.removeChild(this.el.lastElementChild);\n        }\n      }\n    }\n  }\n}", "import { Template } from '../Template';\n\nexport default new Template(({ emojiCount, classes, category, pickerId, icon, i18n }) => /* html */`\n  <section class=\"${classes.emojiCategory}\" role=\"tabpanel\" aria-labelledby=\"${pickerId}-category-${category.key}\">\n    <h3 data-category=\"${category.key}\" class=\"${classes.categoryName}\">\n      <i data-icon=\"${icon}\"></i>\n      ${i18n.get(`categories.${category.key}`, category.message || category.key)}\n    </h3>\n    <div data-empty=\"${emojiCount === 0}\" class=\"${classes.recentEmojis}\">\n      <div data-view=\"emojis\" data-render=\"sync\"></div>\n    </div>\n    <div class=\"${classes.noRecents}\">\n      ${i18n.get('recents.none')}\n    </div>\n  </section>\n`, { mode: 'async' });", "import { View } from './view';\nimport { BaseEmojiCategory, classes } from './BaseEmojiCategory';\nimport { RecentEmojiContainer } from './RecentEmojiContainer';\nimport { Category, EmojiRecord } from '../types';\nimport { LazyLoader } from '../LazyLoader';\nimport { categoryIcons } from '../icons';\nimport template from './RecentEmojiCategory.template';\nimport { RecentsProvider } from '../recents/RecentsProvider';\n\ntype RecentEmojiCategoryOptions = {\n  category: Category;\n  provider: RecentsProvider;\n  lazyLoader?: LazyLoader;\n};\nexport class RecentEmojiCategory extends BaseEmojiCategory {\n  emojiContainer: RecentEmojiContainer;\n  private provider: RecentsProvider;\n\n  constructor({ category, lazyLoader, provider }: RecentEmojiCategoryOptions) {\n    super({ category, showVariants: false, lazyLoader, template });\n    this.provider = provider;\n  }\n\n  initialize() {\n    this.uiElements = {\n      ...this.baseUIElements,\n      recents: View.byClass(classes.recentEmojis),\n    };\n\n    this.appEvents = {\n      'recent:add': this.addRecent\n    };\n\n    super.initialize();\n  }\n\n  async addRecent(recent: EmojiRecord) {\n    await this.emojiContainer.addOrUpdate(recent);\n    this.ui.recents.dataset.empty = 'false';\n  }\n\n  async render(): Promise<HTMLElement> {\n    const recents = this.provider?.getRecents(this.options.maxRecents);\n\n    this.emojiContainer = this.viewFactory.create(RecentEmojiContainer, {\n      emojis: recents,\n      showVariants: false,\n      lazyLoader: this.lazyLoader,\n      category: this.category.key\n    });\n\n    await super.render({\n      category: this.category,\n      emojis: this.emojiContainer,\n      emojiCount: recents.length,\n      icon: categoryIcons[this.category.key]\n    });\n    \n    return this.el;\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classes, category, pickerId, icon, i18n }) => /* html */`\n  <section class=\"${classes.emojiCategory}\" role=\"tabpanel\" aria-labelledby=\"${pickerId}-category-${category.key}\">\n    <h3 data-category=\"${category.key}\" class=\"${classes.categoryName}\">\n      <i data-icon=\"${icon}\"></i>\n      ${i18n.get(`categories.${category.key}`, category.message || category.key)}\n    </h3>\n    <div data-view=\"emojis\" data-render=\"sync\"></div>\n  </section>\n`);", "import { EmojiContainer } from './EmojiContainer';\nimport { BaseEmojiCategory } from './BaseEmojiCategory';\nimport { LazyLoader } from '../LazyLoader';\nimport { Category } from '../types';\nimport { categoryIcons } from '../icons';\nimport template from './CustomEmojiCategory.template';\n\ntype CustomEmojiCategoryOptions = {\n  category: Category;\n  lazyLoader?: LazyLoader;\n}\nexport class CustomEmojiCategory extends BaseEmojiCategory {\n  constructor({ category, lazyLoader }: CustomEmojiCategoryOptions) {\n    super({ template, showVariants: false, lazyLoader, category})\n  }\n\n  initialize() {\n    this.uiElements = { ...this.baseUIElements };\n    super.initialize();\n  }\n\n  async render(): Promise<HTMLElement> {\n    this.emojiContainer = this.viewFactory.create(EmojiContainer, {\n      emojis: this.customEmojis,\n      showVariants: this.showVariants,\n      lazyLoader: this.lazyLoader,\n      category: this.category.key\n    });\n\n    return super.render({\n      category: this.category,\n      emojis: this.emojiContainer,\n      emojiCount: this.customEmojis.length,\n      icon: categoryIcons[this.category.key]\n    });\n  }\n}", "type Callback = () => void;\n\nexport class LazyLoader {\n  private elements: Map<Element, Callback> = new Map();\n\n  lazyLoad(placeholder: HTMLElement, callback: Callback): HTMLElement {\n    this.elements.set(placeholder, callback);\n    return placeholder;\n  }\n\n  observe(root: HTMLElement): void {\n    if (window.IntersectionObserver) {\n      const observer = new IntersectionObserver(\n        entries => {\n          entries\n            .filter(entry => entry.intersectionRatio > 0)\n            .map(entry => entry.target)\n            .forEach(element => {\n              const callback = this.elements.get(element);\n              callback?.();\n              observer.unobserve(element);\n            });\n        },\n        {\n          root\n        }\n      );\n\n      this.elements.forEach((callback, element) => {\n        observer.observe(element);\n      });\n    } else {\n      this.elements.forEach(callback => {\n        callback();\n      });\n    }\n  }\n}\n", "import { View } from './view';\nimport { CategoryTabs } from './CategoryTabs';\nimport { EmojiCategory } from './EmojiCategory';\nimport { RecentEmojiCategory } from './RecentEmojiCategory';\nimport { CustomEmojiCategory } from './CustomEmojiCategory';\nimport { getPrefixedClasses, throttle } from '../util';\nimport { LazyLoader } from '../LazyLoader';\nimport { Category, CategoryKey, EmojiFocusTarget } from '../types';\nimport { Template } from '../Template';\n\nimport { SetActiveOptions } from './CategoryTab';\nconst classes = getPrefixedClasses('emojiArea');\n\nconst template = new Template(({ classes }) => /* html */`\n  <div class=\"${classes.emojiArea}\">\n    <div data-placeholder=\"emojis\"></div>\n  </div>\n`, { mode: 'async' });\n\nconst categoryClasses = {\n  recents: RecentEmojiCategory,\n  custom: CustomEmojiCategory\n};\n\nfunction getCategoryClass(category: Category) {\n  return categoryClasses[category.key] || EmojiCategory;\n}\n\ntype ScrollListenerState = \n  'active' | // handle scroll events\n  'suspend' | // don't handle scroll events\n  'resume'; // skip current scroll event then re-enable for the next one\n\ntype CategoryFocusTarget = 'button' | EmojiFocusTarget;\n\ntype SelectCategoryOptions = {\n  focus?: CategoryFocusTarget;\n  scroll?: 'animate' | 'jump';\n  performFocus?: boolean;\n};\n\nfunction getFocusTarget(focus: CategoryFocusTarget | undefined): EmojiFocusTarget | undefined {\n  if (!focus || focus === 'button') {\n    return {\n      row: 'first',\n      offset: 0\n    };\n  }\n\n  return focus;\n}\n\ntype EmojiAreaOptions = {\n  categoryTabs?: CategoryTabs;\n  categories: Category[];\n  emojiVersion: number;\n}\n\n/**\n * The EmojiArea is the main view of the picker, it contains all the categories and their emojis inside\n * a main scrollable area.\n */\nexport class EmojiArea extends View {\n  private selectedCategory = 0;\n  private categoryTabs?: CategoryTabs;\n  private categories: Category[];\n  private emojiVersion: number;\n\n  private observer: ResizeObserver;\n\n  private scrollListenerState: ScrollListenerState = 'active';\n  private lazyLoader = new LazyLoader();\n\n  emojiCategories: EmojiCategory[];\n\n  constructor({ categoryTabs, categories, emojiVersion }: EmojiAreaOptions) {\n    super({ template, classes });\n\n    this.categoryTabs = categoryTabs;\n    this.categories = categories;\n    this.emojiVersion = emojiVersion;\n\n    this.handleScroll = throttle(this.handleScroll.bind(this), 100);\n  }\n\n  initialize() {\n    this.appEvents = { \n      'category:select': this.handleCategorySelect,\n      'category:previous': this.focusPreviousCategory,\n      'category:next': this.focusNextCategory,\n      'focus:change': this.updateFocusedCategory\n    };\n    this.uiElements = { emojis: View.byClass(classes.emojiArea) };\n    this.uiEvents = [ View.uiEvent('scroll', this.handleScroll) ]\n\n    super.initialize();\n  }\n\n  get focusableEmoji(): HTMLElement {\n    return this.el.querySelector<HTMLElement>('[tabindex=\"0\"]') as HTMLElement;\n  }\n\n  async render(): Promise<HTMLElement> {\n    this.emojiCategories = this.categories.map(this.createCategory, this);\n\n    const categoryEmojiElements = {};\n    this.categories.forEach((category, index) => {\n      categoryEmojiElements[`emojis-${category.key}`] = this.emojiCategories[index];\n    });\n\n    await super.render({\n      emojis: await Promise.all(this.emojiCategories.map(category => category.render()))\n    });\n\n    this.lazyLoader.observe(this.el);\n\n    return this.el;\n  }\n\n  destroy() {\n    super.destroy();\n    this.emojiCategories.forEach(category => {\n      this.observer?.unobserve(category.el);\n      category.destroy();\n    });\n  }\n\n  private handleCategorySelect(category: CategoryKey, options?: SelectCategoryOptions) {\n\n    // On touch devices, if there is a \"momentum scroll\" in progress, we need to stop it so we can jump to the selected category\n    this.el.style.overflow = 'hidden';\n    this.selectCategory(category, options);\n    this.el.style.overflow = 'auto';\n  }\n\n  private createCategory(category: Category): EmojiCategory {\n    const Category = getCategoryClass(category);\n\n    return this.viewFactory.create(Category, {\n      category,\n      showVariants: true,\n      lazyLoader: this.lazyLoader,\n      emojiVersion: this.emojiVersion,\n      provider: this.options.recentsProvider\n    });\n  }\n\n  private determineInitialCategory() {\n    if (this.options.initialCategory) {\n      if (this.categories.find(c => c.key === this.options.initialCategory)) {\n        return this.options.initialCategory;\n      }\n    }\n\n    return this.categories.find(c => c.key !== 'recents')?.key;\n  }\n\n  private determineFocusTarget(category) {\n    const categoryView = this.emojiCategories.find(c => c.category.key === category);\n    if (this.options.initialEmoji && categoryView?.el.querySelector(`[data-emoji=\"${this.options.initialEmoji}\"]`)) {\n      return this.options.initialEmoji;\n    }\n\n    return 'button'\n  }\n\n  reset(performFocus = true): void {\n    this.events.emit('preview:hide');\n\n    const category = this.determineInitialCategory();\n    if (category) {\n      this.selectCategory(category, { \n        focus: this.determineFocusTarget(category),\n        performFocus, \n        scroll: 'jump' \n      });\n\n      this.selectedCategory = this.getCategoryIndex(category);\n    }\n  }\n\n  /**\n   * Given a category key, returns the index of the category in the categories array.\n   * @param key \n   * @returns \n   */\n  private getCategoryIndex(key: CategoryKey): number {\n    return this.categories.findIndex(category => category.key === key);\n  }\n\n  private focusPreviousCategory(column: number) {\n    if (this.selectedCategory > 0) {\n      this.focusCategory(this.selectedCategory - 1, { row: 'last', offset: column ?? this.options.emojisPerRow });\n    }\n  }\n\n  private focusNextCategory(column: number) {\n    if (this.selectedCategory < this.categories.length - 1) {\n      this.focusCategory(this.selectedCategory + 1, { row: 'first', offset: column ?? 0 });\n    }\n  }\n\n  /**\n   * Changes the focused category.\n   * \n   * @param category the index of the category\n   * @param focusTarget the desired focus target in the new category\n   */\n  private focusCategory(category: number, focusTarget: CategoryFocusTarget) {\n    this.selectCategory(category, {\n      focus: focusTarget,\n      performFocus: true\n    });\n  }\n\n  /**\n   * Changes the current category, optionally animating, scrolling, and changing the focus.\n   * \n   * Supported options are:\n   * - focus: The target element that should become focusable\n   * - performFocus: Whether or not to actually focus the new focusable element\n   * - scroll: Whether the scrolling should be immediate (jump), animated (animate), or none (undefined).\n   * - animate: Whether or not to animate active indicator under the button.\n   * \n   * @param category The key or index of the category to select.\n   * @param options The options for the category selection.\n   */\n  private async selectCategory(category: CategoryKey | number, options: SelectCategoryOptions = {}): Promise<void> {\n    this.scrollListenerState = 'suspend';\n    const { focus, performFocus, scroll } = {\n      performFocus: false,\n      ...options\n    };\n\n    this.emojiCategories[this.selectedCategory].setActive(false);\n\n    const categoryIndex = this.selectedCategory = typeof category === 'number' ? category : this.getCategoryIndex(category);\n    this.categoryTabs?.setActiveTab(this.selectedCategory, {\n      performFocus,\n      scroll: focus === 'button'\n    })\n    // this.categoryTabs?.setActiveTab(this.selectedCategory, performFocus, focus === 'button');\n    const targetPosition = this.emojiCategories[categoryIndex].el.offsetTop;\n    this.emojiCategories[categoryIndex].setActive(true, getFocusTarget(focus), focus !== 'button' && performFocus);\n\n    if (scroll) {\n      this.el.scrollTop = targetPosition;\n    }\n\n    this.scrollListenerState = 'resume';\n  }\n\n  /**\n   * Updates the category tabs to reflect the currently focused category.\n   * @param category the key of the currently focused category\n   */\n  private updateFocusedCategory(category: CategoryKey) {\n    // Do nothing if this is already the focused category\n    if (this.categories[this.selectedCategory].key === category) {\n      return;\n    }\n\n    this.scrollListenerState = 'suspend';\n    this.selectedCategory = this.getCategoryIndex(category);\n    this.categoryTabs?.setActiveTab(this.selectedCategory, {\n      changeFocusable: false,\n      performFocus: false\n    });\n    this.scrollListenerState = 'resume';\n  }\n\n  /**\n   * On scroll, checks the new scroll position and highlights a new category if necessary.\n   */\n  handleScroll(): void {\n    // Do nothing if we are in the 'suspend' state or if category tabs are disabled.\n    if (this.scrollListenerState === 'suspend' || !this.categoryTabs) {\n      return;\n    }\n\n    // If we are in the 'resume' state, don't handle the scroll but re-enable the listener for the\n    // next scroll event.\n    if (this.scrollListenerState === 'resume') {\n      this.scrollListenerState = 'active';\n      return;\n    }\n\n    const currentPosition = this.el.scrollTop;\n    const maxScroll = this.el.scrollHeight - this.el.offsetHeight;    \n\n    const targetCategory = this.emojiCategories.findIndex((category: EmojiCategory, index: number) => {\n      return currentPosition < (this.emojiCategories[index + 1])?.el.offsetTop;\n    });\n\n    const options: SetActiveOptions = {\n      changeFocusable: false,\n      performFocus: false,\n      scroll: false\n    };\n\n    if (currentPosition === 0) {\n      this.categoryTabs.setActiveTab(0, options);\n    } else if (Math.floor(currentPosition) === Math.floor(maxScroll) || targetCategory < 0) {\n      this.categoryTabs.setActiveTab(this.categories.length - 1, options);\n    } else {\n      this.categoryTabs.setActiveTab(targetCategory, options);\n    }\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classList, classes, icon, message }) => /* html */`\n<div class=\"${classList}\" role=\"alert\">\n  <div class=\"${classes.iconContainer}\"><i data-size=\"10x\" data-icon=\"${icon}\"></i></div>\n  <h3 class=\"${classes.title}\">${message}</h3>\n</div>\n`);\n", "import { View } from './view';\nimport { Template } from '../Template';\nimport errorTemplate from './ErrorMessage.template';\nimport { getPrefixedClasses } from '../util';\n\ntype ErrorMessageOptions = {\n  message: string;\n  icon?: string;\n  template?: Template;\n  className?: string;\n};\n\nconst classes = getPrefixedClasses('error', 'iconContainer', 'title');\n\nexport class ErrorMessage extends View {\n  private message: string;\n  private icon: string;\n  private className?: string;\n\n  constructor({ message, icon = 'warning', template = errorTemplate, className }: ErrorMessageOptions) {\n    super({ template, classes });\n\n    this.message = message;\n    this.icon = icon;\n    this.className = className;\n  }\n\n  renderSync() {\n    const classList = [classes.error, this.className].join(' ').trim();\n    return super.renderSync({ message: this.message, icon: this.icon, classList });\n  }\n}", "import { Template } from '../Template';\n\nexport default new Template(({ classList, classes, icon, i18n, message }) => /* html */`\n  <div class=\"${classList}\" role=\"alert\">\n    <div class=\"${classes.icon}\"><i data-size=\"10x\" data-icon=\"${icon}\"></i></div>\n    <h3 class=\"${classes.title}\">${message}</h3>\n    <button type=\"button\">${i18n.get('retry')}</button>\n  </div>\n`);\n", "import { View } from './view';\nimport { ErrorMessage } from './ErrorMessage';\nimport { initDatabase } from '../data/emojiData';\n\nimport template from './DataError.template';\nimport { getPrefixedClasses } from '../util';\n\nconst classes = getPrefixedClasses('dataError');\n\ntype DataErrorOptions = {\n  message: string;\n};\n\nexport class DataError extends ErrorMessage {\n  constructor({ message }: DataErrorOptions) {\n    super({ message, template, className: classes.dataError });\n  }\n\n  initialize() {\n    this.uiElements = { retryButton: 'button' };\n    this.uiEvents = [View.childEvent('retryButton', 'click', this.onRetry)];\n\n    super.initialize();\n  }\n\n  private async onRetry() {\n    if (this.emojiData) {\n      await this.emojiData.delete();\n    } else {\n      await this.options.dataStore.deleteDatabase(this.options.locale);\n    }\n\n    this.events.emit('reinitialize');\n    const db = await initDatabase(this.options.locale, this.options.dataStore, this.options.messages, this.options.emojiData, this.emojiData);\n    this.viewFactory.setEmojiData(db);\n    this.events.emit('data:ready', db);\n  }\n}\n", "import { View } from './view';\nimport { EmojiRecord } from '../types';\n\nimport { Template } from '../Template';\nimport { getPrefixedClasses, empty, replaceChildren } from '../util';\n\nconst classes = getPrefixedClasses(\n  'preview',\n  'previewEmoji',\n  'previewName',\n  'tagList',\n  'tag'\n);\n\nconst tagTemplate = new Template(({ classes, tag }) => /* html */`\n  <li class=\"${classes.tag}\">${tag}</li>\n`);\n\nconst template = new Template(({ classes }) => /* html */`\n  <div class=\"${classes.preview}\">\n    <div class=\"${classes.previewEmoji}\"></div>\n    <div class=\"${classes.previewName}\"></div>\n    <ul class=\"${classes.tagList}\"></ul>\n  </div>\n`);\n\nexport class EmojiPreview extends View {\n  constructor() {\n    super({ template, classes });\n  }\n\n  initialize() {\n    this.uiElements = {\n      emoji: View.byClass(classes.previewEmoji), \n      name: View.byClass(classes.previewName),\n      tagList: View.byClass(classes.tagList)\n    };\n\n    this.appEvents = {\n      'preview:show': this.showPreview,\n      'preview:hide': this.hidePreview\n    };\n\n    super.initialize();\n  }\n\n  private showPreview(emoji: EmojiRecord, content: HTMLElement) {\n    replaceChildren(this.ui.emoji, content);\n    this.ui.name.textContent = emoji.label;\n    if (emoji.tags) {\n      this.ui.tagList.style.display = 'flex';\n      const tags = emoji.tags.map(tag => tagTemplate.renderSync({ tag, classes }) as HTMLElement);\n      replaceChildren(this.ui.tagList, ...tags);\n    }\n  }\n\n  private hidePreview() {\n    empty(this.ui.emoji);\n    empty(this.ui.name);\n    empty(this.ui.tagList);\n  }\n}\n", "import { Template } from '../Template';\n\nexport const clearSearchButtonTemplate = new Template<HTMLButtonElement>(({ classes, i18n }) => /* html */`\n  <button title=\"${i18n.get('search.clear')}\" class=\"${classes.clearSearchButton}\">\n    <i data-icon=\"xmark\"></i>\n  </button>\n`);\n\nexport const searchTemplate = new Template(({ classes, i18n }) => /* html */`\n<div class=\"${classes.searchContainer}\">\n  <input class=\"${classes.searchField}\" placeholder=\"${i18n.get('search')}\">\n  <span class=\"${classes.searchAccessory}\"></span>\n</div>\n`, { mode: 'async' });", "import { View } from './view';\n\nimport { icon } from '../icons';\n\nimport { EmojiContainer } from './EmojiContainer';\nimport { ErrorMessage } from './ErrorMessage';\n\nimport { debounce, getPrefixedClasses, replaceChildren } from '../util';\nimport { LazyLoader } from '../LazyLoader';\nimport { Category } from '../types';\n\nimport { clearSearchButtonTemplate, searchTemplate } from './Search.template';\n\ntype SearchOptions = {\n  categories: Category[];\n  emojiVersion: number;\n};\n\nconst classes = getPrefixedClasses(\n  'searchContainer',\n  'searchField',\n  'clearButton',\n  'searchAccessory',\n  'clearSearchButton',\n  'notFound'\n);\n\nexport class Search extends View {\n  private categories: Category[];\n  private emojiVersion: number;\n\n  private searchIcon: Element;\n  private clearSearchButton: HTMLButtonElement;\n  private resultsContainer: EmojiContainer | null;\n  private notFoundMessage: ErrorMessage;\n  private errorMessage: ErrorMessage;\n\n  searchField: HTMLInputElement;\n\n  constructor({ categories, emojiVersion }: SearchOptions) {\n    super({ template: searchTemplate, classes });\n\n    this.categories = categories.filter((category: Category) => category.key !== 'recents');\n    this.emojiVersion = emojiVersion;\n\n    this.search = debounce(this.search.bind(this), 100);\n  }\n\n  initialize() {\n    this.uiElements = {\n      searchField: View.byClass(classes.searchField),\n      searchAccessory: View.byClass(classes.searchAccessory)\n    };\n\n    this.uiEvents = [\n      View.childEvent('searchField', 'keydown', this.onKeyDown),\n      View.childEvent('searchField', 'input', this.onSearchInput)\n    ];\n\n    super.initialize();\n  }\n\n  async render(): Promise<HTMLElement> {\n    await super.render();\n\n    this.searchIcon = icon('search');\n\n    this.notFoundMessage = this.viewFactory.create(ErrorMessage, { \n      message: this.i18n.get('search.notFound'),\n      className: classes.notFound,\n      icon: 'sad' \n    });\n    this.notFoundMessage.renderSync();\n\n    this.errorMessage = this.viewFactory.create(ErrorMessage, { message: this.i18n.get('search.error') });\n    this.errorMessage.renderSync();\n\n    this.clearSearchButton = clearSearchButtonTemplate.render({\n      classes,\n      i18n: this.i18n\n    }) as HTMLButtonElement;\n\n    this.clearSearchButton.addEventListener('click', (event: MouseEvent) => this.onClearSearch(event));\n\n    this.searchField = this.ui.searchField as HTMLInputElement;\n\n    this.showSearchIcon();\n\n    return this.el;\n  }\n\n  private showSearchIcon() {\n    this.showSearchAccessory(this.searchIcon);\n  }\n\n  private showClearSearchButton() {\n    this.showSearchAccessory(this.clearSearchButton);\n  }\n\n  private showSearchAccessory(accessory: Element) {\n    replaceChildren(this.ui.searchAccessory, accessory);\n  }\n\n  clear(): void {\n    (this.searchField as HTMLInputElement).value = '';\n    this.showSearchIcon();\n  }\n\n  focus(): void {\n    this.searchField.focus();\n  }\n\n  onClearSearch(event: Event): void {\n    event.stopPropagation();\n\n    this.searchField.value = '';\n    this.resultsContainer?.destroy();\n    this.resultsContainer = null;\n\n    this.showSearchIcon();\n\n    this.events.emit('content:show');\n    this.searchField.focus();\n  }\n\n  handleResultsKeydown(event: KeyboardEvent): void {\n    if (this.resultsContainer) {\n      if (event.key === 'Escape') {\n        this.onClearSearch(event);\n      }\n    }\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    if (event.key === 'Escape' && this.searchField.value) {\n      this.onClearSearch(event);\n    } else if ((event.key === 'Enter' || event.key === 'ArrowDown') && this.resultsContainer) {\n      event.preventDefault();\n      this.resultsContainer.el.querySelector<HTMLElement>('[tabindex=\"0\"]')?.focus();\n    }\n  }\n\n  onSearchInput(event: Event): void {\n    if (this.searchField.value) {\n      this.showClearSearchButton();\n      this.search();\n    } else {\n      this.onClearSearch(event);\n    }\n  }\n\n  async search() {\n    if (!this.searchField.value) {\n      return;\n    }\n\n    try {\n      const searchResults = await this.emojiData.searchEmojis(\n        this.searchField.value,\n        this.customEmojis, \n        this.emojiVersion,\n        this.categories\n      );\n\n      this.events.emit('preview:hide');\n\n      if (searchResults.length) {\n        const lazyLoader = new LazyLoader();\n        this.resultsContainer = this.viewFactory.create(EmojiContainer, {\n          emojis: searchResults,\n          fullHeight: true,\n          showVariants: true,\n          lazyLoader\n        });\n\n        this.resultsContainer.renderSync();\n        if (this.resultsContainer?.el) {\n          lazyLoader.observe(this.resultsContainer.el);\n          this.resultsContainer.setActive(true, { row: 0, offset: 0}, false);\n\n          this.resultsContainer.el.addEventListener('keydown', event => this.handleResultsKeydown(event));\n\n          this.events.emit('content:show', this.resultsContainer);\n        }\n      } else {\n        this.events.emit('content:show', this.notFoundMessage);\n      }\n    } catch (error) {\n      this.events.emit('content:show', this.errorMessage);\n    }\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classes }) => /* html */`\n  <div class=\"${classes.variantOverlay}\">\n    <div class=\"${classes.variantPopup}\">\n      <div data-view=\"emojis\" data-render=\"sync\"></div>\n    </div>\n  </div>\n`);\n", "import { View } from './view';\n\nimport { EmojiContainer } from './EmojiContainer';\nimport { EmojiRecord } from '../types';\nimport { animate, getPrefixedClasses } from '../util';\nimport { FocusTrap } from '../focusTrap';\n\nimport template from './VariantPopup.template';\n\nconst classes = getPrefixedClasses(\n  'variantOverlay',\n  'variantPopup'\n);\n\ntype VariantPopupOptions = {\n  emoji: EmojiRecord;\n  parent: HTMLElement;\n};\n\nconst animationOptions = {\n  easing: 'ease-in-out',\n  duration: 250,\n  fill: 'both' as FillMode\n};\n\nconst overlayAnimation = {\n  opacity: [0, 1]\n};\n\nconst popupAnimation = {\n  opacity: [0, 1],\n  transform: ['scale3d(0.8, 0.8, 0.8)', 'scale3d(1, 1, 1)']\n};\n\nexport class VariantPopup extends View {\n  private focusedEmojiIndex = 0;\n\n  private emoji: EmojiRecord;\n  private renderedEmojis: HTMLElement[];\n\n  private emojiContainer: EmojiContainer;\n  private focusTrap = new FocusTrap();\n\n  constructor({ emoji, parent }: VariantPopupOptions) {\n    super({ template, classes, parent });\n\n    this.emoji = emoji;\n  }\n\n  initialize() {\n      this.uiElements = {\n        popup: View.byClass(classes.variantPopup)\n      };\n\n      this.uiEvents = [\n        View.uiEvent('click', this.handleClick),\n        View.uiEvent('keydown', this.handleKeydown)\n      ]\n\n      super.initialize();\n  }\n\n  animateShow = () => \n    Promise.all([\n      animate(this.el, overlayAnimation, animationOptions, this.options),\n      animate(this.ui.popup, popupAnimation, animationOptions, this.options)\n    ]);\n\n  animateHide() {\n    const hideOptions: KeyframeAnimationOptions = { ...animationOptions, direction: 'reverse' };\n\n    return Promise.all([\n      animate(this.el, overlayAnimation, hideOptions, this.options),\n      animate(this.ui.popup, popupAnimation, hideOptions, this.options),\n    ]);\n  }\n\n  private async hide() {\n    await this.animateHide();\n    this.events.emit('variantPopup:hide');\n  }\n\n  private handleKeydown(event: KeyboardEvent) {\n    if (event.key === 'Escape') {\n      this.hide();\n      event.stopPropagation();\n    }\n  }\n\n  private handleClick(event): void {\n    if (!this.ui.popup.contains(event.target as Node)) {\n      this.hide();\n    }\n  }\n\n  getEmoji(index: number): Element {\n    return this.renderedEmojis[index];\n  }\n\n  setFocusedEmoji(newIndex: number): void {\n    const currentFocusedEmoji = this.getEmoji(this.focusedEmojiIndex) as HTMLElement;\n    currentFocusedEmoji.tabIndex = -1;\n\n    this.focusedEmojiIndex = newIndex;\n    const newFocusedEmoji = this.getEmoji(this.focusedEmojiIndex) as HTMLElement;\n    newFocusedEmoji.tabIndex = 0;\n    newFocusedEmoji.focus();\n  }\n\n  destroy() {\n    this.emojiContainer.destroy();\n    this.focusTrap.deactivate();\n    super.destroy();\n  }\n\n  renderSync(): HTMLElement {\n    const baseEmoji = {\n      ...this.emoji,\n      skins: null\n    };\n\n    const variants = (this.emoji.skins || []).map(variant => ({\n      ...variant,\n      label: this.emoji.label,\n      tags: this.emoji.tags\n    }));\n\n    const emojis = [baseEmoji, ...variants];\n    this.emojiContainer = this.viewFactory.create(EmojiContainer, {\n      emojis,\n      preview: false\n    })\n\n    super.renderSync({ emojis: this.emojiContainer });\n\n    if (emojis.length < this.options.emojisPerRow) {\n      this.el.style.setProperty('--emojis-per-row', emojis.length.toString());\n    }\n\n    return this.el;\n  }\n\n  activate() {\n    this.emojiContainer.setActive(true, { row: 0, offset: 0}, true);\n    this.focusTrap.activate(this.el);\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classes, i18n, category, pickerId, icon }) => /* html */`\n<li class=\"${classes.categoryTab}\">\n  <button\n    aria-selected=\"false\"\n    role=\"tab\"\n    class=\"${classes.categoryButton}\"\n    tabindex=\"-1\"\n    title=\"${i18n.get(`categories.${category.key}`, category.message || category.key)}\"\n    type=\"button\"\n    data-category=\"${category.key}\"\n    id=\"${pickerId}-category-${category.key}\"\n  >\n    <i data-icon=\"${icon}\"></i>\n</li>\n`);\n", "import { View } from './view';\n\nimport { Category } from '../types';\n\nimport template from './CategoryTab.template';\nimport { getPrefixedClasses } from '../util';\n\n\nconst classes = getPrefixedClasses(\n  'categoryTab', \n  'categoryTabActive', \n  'categoryButton'\n);\n\ntype CategoryTabOptions = {\n  category: Category;\n  icon: Element;\n}\n\nexport type SetActiveOptions = {\n  changeFocusable?: boolean;\n  performFocus?: boolean;\n  scroll?: boolean;\n}\n\nexport class CategoryTab extends View {\n  category: Category;\n  private icon: Element;\n  \n  isActive = false;\n\n  constructor({ category, icon }: CategoryTabOptions) {\n    super({ template, classes });\n\n    this.category = category;\n    this.icon = icon;\n  }\n\n  initialize() {\n    this.uiElements = {\n      button: View.byClass(classes.categoryButton)\n    }\n\n    this.uiEvents = [\n      View.childEvent('button', 'click', this.selectCategory),\n      View.childEvent('button', 'focus', this.selectCategory)\n    ];\n\n    super.initialize();\n  }\n\n  renderSync(): HTMLElement {\n    super.renderSync({\n      category: this.category,\n      icon: this.icon\n    });\n\n    this.ui.button.ariaSelected = 'false';\n\n    return this.el;\n  }\n\n  /**\n   * Sets the active state of the tab.\n   * \n   * @param isActive The new active state\n   * @param changeFocus Whether or not to change the active focusable element to the tab button\n   * @param scroll Whether or not to scroll to the new category\n   */\n  setActive(active: boolean, options: SetActiveOptions = {}) {\n    const { changeFocusable, performFocus, scroll } = {\n      changeFocusable: true,\n      performFocus: true,\n      scroll: true,\n      ...options\n    };\n\n    this.el.classList.toggle(classes.categoryTabActive, active);\n\n    if (changeFocusable) {\n      this.ui.button.tabIndex = active ? 0 : -1;\n      this.ui.button.ariaSelected = active.toString();\n    }\n\n    if (active && performFocus) {\n      this.ui.button.focus();\n\n      if (scroll) {\n        this.events.emit('category:select', this.category.key, { scroll: 'animate', focus: 'button', performFocus: false });\n      }\n    }\n\n    this.isActive = active;\n  }\n\n  private selectCategory() {\n    if (!this.isActive) {\n      this.events.emit('category:select', this.category.key, { scroll: 'animate', focus: 'button', performFocus: true });\n    }\n  }\n}\n", "import { Template } from '../Template';\n\nexport default new Template(({ classes }) => /* html */`\n  <div class=\"${classes.categoryButtonsContainer}\">\n    <ul role=\"tablist\" class=\"${classes.categoryButtons}\">\n      <div data-placeholder=\"tabs\"></div>\n    </ul>\n  </div>\n`);", "import { View } from './view';\n\nimport { CategoryTab, SetActiveOptions } from './CategoryTab';\nimport { categoryIcons } from '../icons';\nimport { Category } from '../types';\n\nimport template from './CategoryTabs.template';\nimport { getPrefixedClasses } from '../util';\n\ntype CategoryTabsOptions = {\n  categories: Category[];\n}\n\nconst classes = getPrefixedClasses('categoryButtons', 'categoryButtonsContainer');\n\nexport class CategoryTabs extends View {\n  private categories: Category[];\n  private tabViews: CategoryTab[];\n  private activeCategoryIndex = 0;\n\n  constructor({ categories }: CategoryTabsOptions) {\n    super({ template, classes });\n\n    this.categories = categories;\n  }\n\n  initialize() {\n    this.keyBindings = {\n      ArrowLeft: this.stepSelectedTab(-1),\n      ArrowRight: this.stepSelectedTab(1)\n    };\n\n    this.uiEvents = [\n      View.uiEvent('scroll', this.checkOverflow)\n    ];\n\n    super.initialize();\n  }\n\n  checkOverflow() {\n    // Check the difference to account for fractional pixels in the scroll position\n    const hasOverflowRight = Math.abs(this.el.scrollLeft - (this.el.scrollWidth - this.el.offsetWidth)) > 1;\n    const hasOverflowLeft = this.el.scrollLeft > 0;\n\n    this.el.className = 'categoryButtonsContainer';\n    if (hasOverflowLeft && hasOverflowRight) {\n      this.el.classList.add('has-overflow-both');\n    } else if (hasOverflowLeft) {\n      this.el.classList.add('has-overflow-left');\n    } else if (hasOverflowRight) {\n      this.el.classList.add('has-overflow-right');\n    }\n  }\n\n  renderSync(): HTMLElement {\n    this.tabViews = this.categories.map(category => \n      this.viewFactory.create(CategoryTab, { category, icon: categoryIcons[category.key] }));\n    \n    super.renderSync({\n      tabs: this.tabViews.map(view => view.renderSync())\n    });\n\n    return this.el;\n  }\n\n  get currentCategory(): Category {\n    return this.categories[this.activeCategoryIndex];\n  }\n\n  get currentTabView(): CategoryTab {\n    return this.tabViews[this.activeCategoryIndex];\n  }\n\n  setActiveTab(index: number, options: SetActiveOptions = {}): void {\n    this.checkOverflow();\n\n    const oldCategory = this.currentTabView;\n    const newCategory = this.tabViews[index];\n\n    oldCategory.setActive(false, options);\n    newCategory.setActive(true, options);\n    this.activeCategoryIndex = index;\n  }\n\n  private getTargetCategory(index: number): number {\n    if (index < 0) {\n      return this.categories.length - 1;\n    }\n\n    if (index >= this.categories.length) {\n      return 0;\n    }\n\n    return index;\n  }\n  \n  private stepSelectedTab(step: number) {\n    return () => {\n      const newIndex = this.activeCategoryIndex + step;\n      this.setActiveTab(this.getTargetCategory(newIndex), {\n        changeFocusable: true,\n        performFocus: true\n      });\n    };\n  }\n}\n", "// Representative emojis for each emoji version. If a given emoji is supported,\n// we assume the system supports that emoji version.\nconst TEST_EMOJIS = [\n  { version: 15, emoji: String.fromCodePoint(0x1FAE8) },\n  { version: 14, emoji: String.fromCodePoint(0x1F6DD) },\n  { version: 13, emoji: String.fromCodePoint(0x1FAC1) },\n  { version: 12, emoji: String.fromCodePoint(0x1F9A9) },\n  { version: 11, emoji: String.fromCodePoint(0x1F9B7) },\n  { version: 5, emoji: String.fromCodePoint(0x1F92A) }, \n  { version: 4, emoji: String.fromCodePoint(0x2695) },\n  { version: 3, emoji: String.fromCodePoint(0x1F922) },\n  { version: 2, emoji: String.fromCodePoint(0x1F5E8) },\n  { version: 1, emoji: String.fromCodePoint(0x1F600) }\n];\n\n/**\n * Determines the latest emoji version that is supported by the browser.\n * @returns the supported emoji version number\n */\nexport function determineEmojiVersion() {\n  const supportedEmoji = TEST_EMOJIS.find(emoji => supportsEmoji(emoji.emoji));\n  return supportedEmoji?.version ?? 1;\n}\n\n/**\n * Checks if the given emoji is rendered correctly by the browser.\n * \n * @param emoji the emoji to attempt to render\n * @returns true if the emoji renders correctly, false otherwise\n */\nfunction supportsEmoji(emoji: string) {\n  const context = document.createElement('canvas').getContext('2d');\n\n  if (context) {\n    context.textBaseline = 'top';\n    context.font = '32px Arial';\n    context.fillText(emoji, 0, 0);\n\n    return context.getImageData(16, 16, 1, 1).data[0] !== 0;\n  }\n}\n", "import { Template } from '../Template';\n\nfunction repeat(count, content) {\n  return Array.from({ length: count }, () => content).join('');\n}\n\nfunction header({ showHeader, classes }) {\n  return showHeader ? /* html */`\n    <header class=\"${classes.header}\">\n      <div data-view=\"search\"></div>\n      <div data-view=\"categoryTabs\" data-render=\"sync\"></div>\n    </header>\n  ` : '';\n}\n\nfunction renderPicker(data) {\n  const { classes, theme, className = ''} = data;\n  return /* html */`\n    <div class=\"picmo__picker ${classes.picker} ${theme} ${className}\">\n      ${header(data)}\n      <div class=\"${classes.content}\">\n        <div data-view=\"emojiArea\"></div>\n      </div>\n      <div data-view=\"preview\"></div>\n    </div>\n  `;\n}\n\nfunction renderPlaceholder(data) {\n  const { emojiCount, classes, theme, className, categoryCount } = data;\n\n  const search = ({ showSearch, classes }) => showSearch ? /* html */`\n    <div class=\"${classes.searchSkeleton}\">\n      <div class=\"${classes.searchInput} ${classes.placeholder}\"></div>\n    </div>\n  ` : '';\n\n  const categoryTabs = ({ showCategoryTabs, classes }) => showCategoryTabs ? /* html */`\n    <div class=\"${classes.categoryTabsSkeleton}\">\n      ${repeat(categoryCount, /* html */`<div class=\"${classes.placeholder} ${classes.categoryTab}\"></div>`)}\n    </div>\n  ` : '';\n\n  const header = ({ showHeader, classes }) => showHeader ? /* html */`\n    <header class=\"${classes.headerSkeleton}\">\n      ${search(data)}\n      ${categoryTabs(data)}\n    </header>\n  ` : '';\n\n  const preview = ({ showPreview, classes }) => showPreview ? /* html */`\n    <div class=\"${classes.previewSkeleton}\">\n      <div class=\"${classes.placeholder} ${classes.previewEmoji}\"></div>\n      <div class=\"${classes.placeholder} ${classes.previewName}\"></div>\n      <ul class=\"${classes.tagList}\">\n        ${repeat(3, /* html */`<li class=\"${classes.placeholder} ${classes.tag}\"></li>`)}\n      </ul>\n    </div>\n  ` : '';\n\n  return /* html */`\n    <div class=\"picmo__picker ${classes.skeleton} ${classes.picker} ${theme} ${className}\">\n      ${header(data)}\n      <div class=\"${classes.contentSkeleton}\">\n        <div class=\"${classes.placeholder} ${classes.categoryName}\"></div>\n        <div class=\"${classes.emojiGrid}\">\n          ${repeat(emojiCount, /* html */`<div class=\"${classes.placeholder} ${classes.emoji}\"></div>`)}\n        </div>\n      </div>\n      ${preview(data)}\n    </div>\n  `;\n}\n\nexport default new Template(data => {\n  return data.isLoaded ? renderPicker(data) : renderPlaceholder(data);\n});\n", "import { ExternalEvent, ExternalEvents } from '../ExternalEvents';\n\nimport { View } from './view';\nimport { EmojiArea } from './EmojiArea';\nimport { DataError } from './DataError';\nimport { EmojiPreview } from './Preview';\nimport { Search } from './Search';\nimport { VariantPopup } from './VariantPopup';\nimport { CategoryTabs } from './CategoryTabs';\nimport { setProvider } from '../recents';\nimport { DataStore } from '../data/DataStore';\nimport { EventCallback } from '../events';\n\nimport { determineEmojiVersion } from '../emojiSupport';\n\nimport { Category, EmojiRecord, UpdatableOptions } from '../types';\nimport { LATEST_EMOJI_VERSION } from 'emojibase';\n\nimport template from './EmojiPicker.template';\nimport { getPrefixedClasses, replaceChildren } from '../util';\n\nconst classes = getPrefixedClasses(\n  'picker',\n  'skeleton',\n  'placeholder',\n  'searchSkeleton',\n  'searchInput',\n  'categoryTabsSkeleton',\n  'headerSkeleton',\n  'categoryTab',\n  'contentSkeleton',\n  'categoryName',\n  'emojiGrid',\n  'emoji',\n  'previewSkeleton',\n  'previewEmoji',\n  'previewName',\n  'tagList',\n  'tag',\n  'overlay',\n  'content',\n  'fullHeight',\n  'pluginContainer',\n  'header'\n);\n\nconst variableNames = {\n  emojisPerRow: '--emojis-per-row',\n  visibleRows: '--row-count',\n  emojiSize: '--emoji-size'\n};\n\n/**\n * The main emoji picker view. Contains the full picker UI and an event emitter to react to\n * emoji selection events.\n */\nexport class EmojiPicker extends View {\n  pickerReady = false;\n\n  private categories: Category[];\n\n  private categoryTabs: CategoryTabs;\n  private search: Search;\n  private emojiArea: EmojiArea;\n  private preview: EmojiPreview;\n  private variantPopup: VariantPopup | null;\n  private emojiVersion: number;\n\n  private currentView: View;\n\n  private externalEvents = new ExternalEvents();\n\n  constructor() {\n    super({ template, classes });\n  }\n\n  initialize() {\n    this.uiElements = {\n      pickerContent: View.byClass(classes.content),\n      header: View.byClass(classes.header)\n    };\n\n    this.uiEvents = [\n      View.uiEvent('keydown', this.handleKeyDown)\n    ];\n\n    this.appEvents = {\n      error: this.onError,\n      reinitialize: this.reinitialize,\n      'data:ready': this.onDataReady,\n      'content:show': this.showContent,\n      'variantPopup:hide': this.hideVariantPopup,\n      'emoji:select': this.selectEmoji\n    };\n\n    super.initialize();\n    setProvider(this.options.recentsProvider);\n  }\n\n  /**\n   * Destroys the picker when it is no longer needed.\n   * After calling this method, the picker will no longer be usable.\n   *\n   * @returns a Promise that resolves when the destroy is complete.\n   */\n  destroy(): void {\n    super.destroy();\n    this.search?.destroy();\n    this.emojiArea.destroy();\n    this.categoryTabs?.destroy();\n    this.events.removeAll();\n    this.externalEvents.removeAll();\n  }\n\n  /**\n   * Convenience method to clear the recents using the configured recents provider.\n   */\n  clearRecents() {\n    this.options.recentsProvider.clear();\n  }\n\n  /**\n   * Listens for a picker event.\n   *\n   * @param event The event to listen for\n   * @param callback The callback to call when the event is triggered\n   */\n   addEventListener(event: ExternalEvent, callback: EventCallback) {\n    this.externalEvents.on(event, callback);\n  }\n\n  /**\n   * Removes a recent emoji from the picker.\n   *\n   * @param event The event to stop listening for\n   * @param callback The previously bound event listener\n   */\n  removeEventListener(event: ExternalEvent, callback: EventCallback) {\n    this.externalEvents.off(event, callback);\n  }\n\n  /**\n   * Finishes setting up the picker view once the data is ready.\n   * This will only be called if the emoji data is available and all\n   * emoji picker views have been rendered.\n   *\n   * This is the last thing to happen before the emoji picker UI becomes visible.\n   */\n  initializePickerView() {\n    if (this.pickerReady) {\n      this.showContent();\n      this.emojiArea.reset(false);\n    }\n  }\n\n  private handleKeyDown(event: KeyboardEvent) {\n    const isShortcut = event.ctrlKey || event.metaKey;\n    if (event.key === 's' && isShortcut && this.search) {\n      event.preventDefault();\n      this.search.focus();\n    }\n  }\n\n  /**\n   * Builds the three sections of the picker:\n   *\n   * - preview area (if enabled in options)\n   * - search area (if enabled in options)\n   * - emoji area (always shown)\n   *\n   * @returns an array containing the three child views. The preview and search\n   *          views are optional, and will be undefined if they are not enabled.\n   */\n  private buildChildViews(): [EmojiPreview, Search, EmojiArea, CategoryTabs] {\n    if (this.options.showPreview) {\n      this.preview = this.viewFactory.create(EmojiPreview);\n    }\n\n    if (this.options.showSearch) {\n      this.search = this.viewFactory.create(Search, {\n        categories: this.categories,\n        emojiVersion: this.emojiVersion\n      });\n    }\n\n    if (this.options.showCategoryTabs) {\n      this.categoryTabs = this.viewFactory.create(CategoryTabs, {\n        categories: this.categories\n      });\n    }\n\n    this.currentView = this.emojiArea = this.viewFactory.create(EmojiArea, {\n      categoryTabs: this.categoryTabs,\n      categories: this.categories,\n      emojiVersion: this.emojiVersion\n    });\n\n    return [this.preview, this.search, this.emojiArea, this.categoryTabs];\n  }\n\n  /**\n   * Sets any CSS variables corresponding to options that were set.\n   */\n  private setStyleProperties() {\n    if (!this.options.showSearch) {\n      this.el.style.setProperty('--search-height-full', '0px');\n    }\n\n    if (!this.options.showCategoryTabs) {\n      this.el.style.setProperty('--category-tabs-height', '0px');\n      this.el.style.setProperty('--category-tabs-offset', '0px');\n    }\n\n    if (!this.options.showPreview) {\n      this.el.style.setProperty('--emoji-preview-height-full', '0px');\n    }\n\n    Object.keys(variableNames).forEach(key => {\n      if (this.options[key]) {\n        this.el.style.setProperty(variableNames[key], this.options[key].toString());\n      }\n    });\n  }\n\n  private updateStyleProperty(option: string, value: any) {\n    this.el.style.setProperty(variableNames[option], value.toString());\n  }\n\n  private reinitialize() {\n    this.renderSync();\n  }\n\n  private onError(error: Error) {\n    const errorView = this.viewFactory.createWithOptions({ data: false }, DataError, { message: this.i18n.get('error.load') });\n    const height = this.el.offsetHeight || 375;\n    this.el.style.height = `${height}px`;\n    replaceChildren(this.el, errorView.renderSync());\n    throw error;\n  }\n\n  /**\n   * Called when the emoji database is ready to be used.\n   *\n   * This will replace the loader placeholder with the full picker UI.\n   */\n  private async onDataReady(db: DataStore) {\n    // Save the current el so we can replace it in the DOM after the new render.\n    const currentView = this.el;\n\n    try {\n      if (db) {\n        this.emojiData = db;\n      } else {\n        await this.emojiDataPromise;\n      }\n\n      if (this.options.emojiVersion === 'auto') {\n        this.emojiVersion = determineEmojiVersion() || parseFloat(LATEST_EMOJI_VERSION);\n      } else {\n        this.emojiVersion = this.options.emojiVersion;\n      }\n\n      this.categories = await this.emojiData.getCategories(this.options);\n\n      const [preview, search, emojiArea, categoryTabs] = this.buildChildViews();\n\n      await super.render({\n        isLoaded: true,\n        search,\n        categoryTabs,\n        emojiArea,\n        preview,\n        showHeader: Boolean(this.search || this.categoryTabs),\n        theme: this.options.theme,\n        className: this.options.className\n      });\n\n      this.el.style.setProperty('--category-count', this.categories.length.toString());\n\n      this.pickerReady = true;\n\n      currentView.replaceWith(this.el);\n      this.setStyleProperties();\n      this.initializePickerView();\n\n      this.setInitialFocus();\n\n      this.externalEvents.emit('data:ready');\n    } catch (error) {\n      this.events.emit('error', error);\n    }\n  }\n\n  /**\n   * Renders the picker.\n   *\n   * @returns the root element of the picker\n   */\n  renderSync(): HTMLElement {\n    let categoryCount = this.options.categories?.length || 10;\n    if (this.options.showRecents) {\n      categoryCount += 1;\n    }\n\n    super.renderSync({\n      isLoaded: false,\n      theme: this.options.theme,\n      className: this.options.className,\n      showSearch: this.options.showSearch,\n      showPreview: this.options.showPreview,\n      showCategoryTabs: this.options.showCategoryTabs,\n      showHeader: this.options.showSearch || this.options.showCategoryTabs,\n      emojiCount: this.options.emojisPerRow * this.options.visibleRows,\n      categoryCount\n    });\n\n    this.el.style.setProperty('--category-count', categoryCount.toString());\n\n    if (!this.options.rootElement) {\n      throw new Error('Picker must be given a root element via the rootElement option');\n    }\n    \n    replaceChildren(this.options.rootElement, this.el);\n    this.setStyleProperties();\n\n    if (this.pickerReady) {\n      this.initializePickerView();\n    }\n\n    return this.el;\n  }\n\n  /**\n   * Determines what element, if any, should be automatically focused when the picker is rendered.\n   * \n   * @returns the focus target, or `null` if nothing should be focused\n   */\n  private getInitialFocusTarget() {\n    if (typeof this.options.autoFocus !== 'undefined') {\n      switch (this.options.autoFocus) {\n        case 'emojis':\n          return this.emojiArea.focusableEmoji;\n        case 'search':\n          return this.search;\n        case 'auto':\n          return this.search || this.emojiArea.focusableEmoji;\n        default:\n          return null;\n      }\n    }\n\n    if (this.options.autoFocusSearch === true) {\n      console.warn('options.autoFocusSearch is deprecated, please use options.focusTarget instead');\n      return this.search;\n    }\n  }\n\n  /**\n   * Sets the initial autofocus, depending on options.\n   */\n  setInitialFocus() {\n    if (!this.pickerReady) {\n      return;\n    }\n\n    this.getInitialFocusTarget()?.focus();\n  }\n\n  /**\n   * Resets the picker to its default, \"inactive\" state.\n   */\n  reset(performFocus = true) {\n    if (this.pickerReady) {\n      this.emojiArea.reset(performFocus);\n      this.showContent(this.emojiArea);\n    }\n\n    this.search?.clear();\n    this.hideVariantPopup();\n  }\n\n  /**\n   * Shows content in the main picker content area.\n   * If no View is specified, the built-in emoji area will be shown.\n   *\n   * The currently shown view will be removed from the DOM and destroyed.\n   *\n   * @param content The View to show\n   */\n  private showContent(content: View = this.emojiArea) {\n    if (content === this.currentView) {\n      return;\n    }\n\n    if (this.currentView !== this.emojiArea) {\n      this.currentView?.destroy();\n    }\n\n    this.ui.pickerContent.classList.toggle(classes.fullHeight, content !== this.emojiArea);\n    replaceChildren(this.ui.pickerContent, content.el);\n    this.currentView = content;\n\n    if (content === this.emojiArea) {\n      this.emojiArea.reset();\n      if (this.categoryTabs) {\n        this.ui.header.appendChild(this.categoryTabs.el);\n      }\n    } else {\n      this.categoryTabs?.el.remove();\n    }\n  }\n\n  /**\n   * Closes and destroys the variant popup.\n   */\n  private hideVariantPopup() {\n    this.variantPopup?.destroy();\n  }\n\n  /**\n   * Given a mouse event, determines if the event occurred on the picker or one of its components.\n   *\n   * @param event The mouse event\n   * @returns true if the click should be treated as on the picker, false otherwise\n   */\n  isPickerClick(event: MouseEvent) {\n    const clickedNode = event.target as Node;\n\n    const isClickInsidePicker = this.el.contains(clickedNode);\n    const isClickOnVariantPopup = this.variantPopup?.el?.contains(clickedNode);\n\n    return isClickInsidePicker || isClickOnVariantPopup;\n  }\n\n  /**\n   * Handles a click on an emoji.\n   * @param emoji The emoji that was clicked\n   * @returns a Promise that resolves when either the variant popup is shown or the emoji is rendered and emitted\n   */\n  private async selectEmoji({ emoji }: { emoji: EmojiRecord }): Promise<void> {\n    // Show the variant popup if the emoji has variants\n    if (emoji.skins?.length && this.options.showVariants && !this.isVariantPopupOpen) {\n      this.showVariantPopup(emoji);\n    } else {\n      await this.variantPopup?.animateHide();\n      this.events.emit('variantPopup:hide');\n      await this.emitEmoji(emoji);\n    }\n  }\n\n  private get isVariantPopupOpen() {\n    return this.variantPopup && !this.variantPopup.isDestroyed;\n  }\n\n  /**\n   * Shows the variant popup for an emoji.\n   *\n   * @param emoji The emoji whose variants are to be shown.\n   * @returns a Promise that resolves when the popup is shown\n   */\n  private async showVariantPopup(emoji: EmojiRecord): Promise<void> {\n    const currentFocus = document.activeElement as HTMLElement;\n    this.events.once('variantPopup:hide', () => {\n      currentFocus?.focus();\n    });\n\n    this.variantPopup = this.viewFactory.create(VariantPopup, { emoji, parent: this.el });\n    this.el.appendChild(this.variantPopup.renderSync());\n    this.variantPopup.activate();\n  }\n\n  /**\n   * Renders an emoji, and emits a public emoji:select event with the rendered result.\n   * @param emoji the emoji that was selected.\n   */\n  private async emitEmoji(emoji: EmojiRecord): Promise<void> {\n    this.externalEvents.emit('emoji:select', await this.renderer.doEmit(emoji));\n    this.options.recentsProvider.addOrUpdateRecent(emoji, this.options.maxRecents);\n    this.events.emit('recent:add', emoji);\n  }\n\n  private updaters = {\n    styleProperty: propertyName => value => this.el.style.setProperty(variableNames[propertyName], value.toString()),\n\n    theme: theme => {\n      const currentTheme = this.options.theme;\n      const container = this.el.closest(`.${currentTheme}`)\n\n      this.el.classList.remove(currentTheme);\n      container?.classList.remove(currentTheme);\n\n      this.el.classList.add(theme);\n      container?.classList.add(theme);\n    },\n\n    className: className => {\n      if (this.options.className) {\n        this.el.classList.remove(this.options.className);\n      }\n\n      this.el.classList.add(className);\n    },\n\n    emojisPerRow: this.updateStyleProperty.bind(this, 'emojisPerRow'),\n    emojiSize: this.updateStyleProperty.bind(this, 'emojiSize'),\n    visibleRows: this.updateStyleProperty.bind(this, 'visibleRows')\n  }\n\n  updateOptions(options: UpdatableOptions) {\n    Object.keys(options).forEach(option => {\n      this.updaters[option](options[option]);\n    });\n\n    Object.assign(this.options, options);\n  }\n}\n", "import { AppEvent } from './AppEvents';\nimport { DataStore } from './data/DataStore';\nimport { Events } from './events';\nimport { Bundle } from './i18n/bundle';\nimport { Renderer } from './renderers/renderer';\nimport { PickerOptions, EmojiRecord } from './types';\nimport { View } from './views/view';\n\ntype ViewFactoryOptions = {\n  data?: boolean;\n};\n\ntype DependencyMapping = {\n  events: Events<AppEvent>;\n  i18n: Bundle;\n  renderer: Renderer;\n  emojiData: Promise<DataStore>;\n  options: PickerOptions;\n  customEmojis: EmojiRecord[];\n  pickerId: string;\n};\n\nexport type ViewConstructor<T extends View> = new (...args: any[]) => T;\nexport type ViewConstructorParameters<T extends View> = ConstructorParameters<ViewConstructor<T>>;\n\nexport class ViewFactory {\n  private events: Events<AppEvent>;\n  private i18n: Bundle;\n  private renderer: Renderer;\n  private emojiData: Promise<DataStore>;\n  private options: PickerOptions;\n  private customEmojis: EmojiRecord[];\n  private pickerId: string;\n\n  constructor({ events, i18n, renderer, emojiData, options, customEmojis = [], pickerId }: DependencyMapping) {\n    this.events = events;\n    this.i18n = i18n;\n    this.renderer = renderer;\n    this.emojiData = emojiData;\n    this.options = options;\n    this.customEmojis = customEmojis;\n    this.pickerId = pickerId;\n  }\n\n  setEmojiData(emojiData: DataStore) {\n    this.emojiData = Promise.resolve(emojiData);\n  }\n\n  createWithOptions<T extends View>(options: ViewFactoryOptions = {}, constructor: ViewConstructor<T>, ...args: ViewConstructorParameters<T>): T {\n    const view = new constructor(...args);\n    \n    view.setPickerId(this.pickerId);\n    view.setEvents(this.events);\n    view.setI18n(this.i18n);\n    view.setRenderer(this.renderer);\n\n    if (options.data !== false) {\n      view.setEmojiData(this.emojiData);\n    }\n\n    view.setOptions(this.options);\n    view.setCustomEmojis(this.customEmojis);\n\n    view.viewFactory = this;\n\n    view.initialize();\n    return view;\n  }\n\n  create<T extends View>(constructor: ViewConstructor<T>, ...args: ViewConstructorParameters<T>): T {\n    return this.createWithOptions({}, constructor, ...args);\n  }\n}\n", "export type Dictionary = Record<string, string>;\n\nexport class Bundle {\n  #dictionary: Map<string, string>;\n\n  constructor(dictionary: Dictionary = {}) {\n    this.#dictionary = new Map(Object.entries(dictionary));\n  }\n\n  get(key: string, fallback = key): string {\n    return this.#dictionary.get(key) || fallback;\n  }\n}\n", "function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n", "import styleInject from 'style-inject';\nimport globalConfig from './globalConfig';\n\nexport function createStyleInjector() {\n  let isInjected = false;\n\n  return function inject(css) {\n    if (globalConfig.injectStyles && !isInjected) {\n      styleInject(css);\n      isInjected = true;\n    }\n  }\n}", "import { AppEvents } from './AppEvents';\nimport { EmojiPicker } from './views/EmojiPicker';\nimport { PickerOptions, CustomEmoji, EmojiRecord } from './types';\nimport { ViewFactory } from './viewFactory';\nexport { LazyLoader } from './LazyLoader';\nimport { DataStore } from './data/DataStore';\nimport { initDatabase } from './data/emojiData';\nimport { Bundle } from './i18n/bundle';\nimport { getOptions } from './options';\nimport { createStyleInjector } from './injectStyles';\n\nimport css from './styles/index.css?inline';\n\nfunction initData(options: PickerOptions): Promise<DataStore> {\n  return initDatabase(options.locale, options.dataStore, options.messages, options.emojiData);\n}\n\nlet pickerIndex = 0;\n\nlet emojiDataPromise;\n\nfunction getPickerId() {\n  return `picmo-${Date.now()}-${pickerIndex++}`;\n}\n\nconst styleInject = createStyleInjector();\n\n/**\n * Creates a new emoji picker.\n * @param options The options for the emoji picker.\n * @returns a Promise that resolves to the picker when it is ready.\n */\nexport function createPicker(options: Partial<PickerOptions>): EmojiPicker {\n  styleInject(css);\n  \n  const finalOptions = getOptions(options);\n  const customEmojis: EmojiRecord[] = (finalOptions?.custom || []).map((custom: CustomEmoji) => ({\n    ...custom,\n    custom: true,\n    tags: ['custom', ...(custom.tags || [])]\n  }));\n\n  const events = new AppEvents();\n  if (!emojiDataPromise) {\n    emojiDataPromise = initData(finalOptions);\n  }\n\n  const i18n = new Bundle(finalOptions.i18n);\n\n  emojiDataPromise.then(emojiData => {\n    events.emit('data:ready', emojiData);\n  }).catch(error => {\n    events.emit('error', error);\n  });\n\n  const viewFactory = new ViewFactory({\n    events,\n    i18n,\n    customEmojis,\n    renderer: finalOptions.renderer,\n    options: finalOptions,\n    emojiData: emojiDataPromise,\n    pickerId: getPickerId()\n  });\n\n  const picker = viewFactory.create(EmojiPicker);\n  picker.renderSync();\n  return picker;\n}", "export default {\n    'categories.activities': 'AktivitÃ¤ten',\n    'categories.animals-nature': 'Tiere & Natur',\n    'categories.custom': 'Benutzerdefiniert',\n    'categories.flags': 'Flaggen',\n    'categories.food-drink': 'Essen & Trinken',\n    'categories.objects': 'GegenstÃ¤nde',\n    'categories.people-body': 'Mensch & KÃ¶rper',\n    'categories.recents': 'Zuletzt genutzt',\n    'categories.smileys-emotion': 'Smileys & Emotionen',\n    'categories.symbols': 'Symbole',\n    'categories.travel-places': 'Reisen & Orte',\n    'error.load': 'Emojis wurden nicht geladen',\n    'recents.clear': 'Zuletzt genutzte Emojis lÃ¶schen',\n    'recents.none': 'Kein Emoji ausgewÃ¤hlt.',\n    'retry': 'Erneut versuchen',\n    'search.clear': 'Suche lÃ¶schen',\n    'search.error': 'Suche erfolglos',\n    'search.notFound': 'Kein Emoji gefunden',\n    'search': 'Emojis durchsuchen ...'\n  };\n  ", "export default {\n    'categories.activities': 'Aktiviteetit',\n    'categories.animals-nature': 'ElÃ¤imet & luonto',\n    'categories.custom': 'Mukautettu',\n    'categories.flags': 'Liput',\n    'categories.food-drink': 'Ruoka & juoma',\n    'categories.objects': 'Esineet',\n    'categories.people-body': 'Ihmiset & keho',\n    'categories.recents': 'Viimeksi kÃ¤ytetty',\n    'categories.smileys-emotion': 'HymiÃ¶t & tunne',\n    'categories.symbols': 'Symbolit',\n    'categories.travel-places': 'Matkustus & paikat',\n    'error.load': 'Emojien lataaminen epÃ¤onnistui',\n    'recents.clear': 'TyhjennÃ¤ viimeksi kÃ¤ytetyt emojit',\n    'recents.none': 'Et ole valinnut vielÃ¤ emojia.',\n    'retry': 'Kokeile uudestaan',\n    'search.clear': 'TyhjennÃ¤ haku',\n    'search.error': 'Emojien etsiminen epÃ¤onnistui',\n    'search.notFound': 'Emojia ei lÃ¶ytynyt',\n    'search': 'Etsi emojia...'\n  };\n  ", "export default {\n    'categories.activities': 'ActivitÃ©s',\n    'categories.animals-nature': 'Animaux et nature',\n    'categories.custom': 'PersonnalisÃ©',\n    'categories.flags': 'Drapeaux',\n    'categories.food-drink': 'Nourriture et boissons',\n    'categories.objects': 'Objets',\n    'categories.people-body': 'Personnes et corps',\n    'categories.recents': 'RÃ©cemment utilisÃ©',\n    'categories.smileys-emotion': 'Visages et Ã©motions',\n    'categories.symbols': 'Symboles',\n    'categories.travel-places': 'Voyages et lieux',\n    'error.load': 'Ã‰chec du chargement des Ã©mojis',\n    'recents.clear': 'Effacez les Ã©mojis rÃ©cents',\n    'recents.none': 'Vous n\\'avez pas encore sÃ©lectionnÃ© d\\'Ã©mojis.',\n    'retry': 'Essayez Ã  nouveau',\n    'search.clear': 'Effacer la recherche',\n    'search.error': 'Ã‰chec de la recherche d\\'Ã©mojis',\n    'search.notFound': 'Aucun Ã©moji trouvÃ©',\n    'search': 'Rechercher des Ã©mojis...'\n  };\n  ", "export default {\n    'categories.activities': 'Activiteiten',\n    'categories.animals-nature': 'Dieren & Natuur',\n    'categories.custom': 'Aangepast',\n    'categories.flags': 'Vlaggen',\n    'categories.food-drink': 'Eten & Drinken',\n    'categories.objects': 'Voorwerpen',\n    'categories.people-body': 'Mens & Lichaam',\n    'categories.recents': 'Laatst gebruikt',\n    'categories.smileys-emotion': 'Smileys en emoties',\n    'categories.symbols': 'Symbolen',\n    'categories.travel-places': 'Reizen & Plaatsen',\n    'error.load': 'Kan emoji\\'s niet laden',\n    'recents.clear': 'Wis recente emoji\\'s',\n    'recents.none': 'Geen emoji geselecteerd.',\n    'retry': 'Probeer het nog eens',\n    'search.clear': 'Zoekopdracht wissen',\n    'search.error': 'Zoeken mislukt',\n    'search.notFound': 'Geen emoji gevonden',\n    'search': 'Zoek emoji...'\n  };\n  ", "export default {\n    'categories.activities': 'Aktiviteter',\n    'categories.animals-nature': 'Dyr & natur',\n    'categories.custom': 'Tilpasset',\n    'categories.flags': 'Flagg',\n    'categories.food-drink': 'Mat & drikke',\n    'categories.objects': 'Objekter',\n    'categories.people-body': 'Mennesker & kropp',\n    'categories.recents': 'Nylig brukte',\n    'categories.smileys-emotion': 'Smilefjes & fÃ¸lelser',\n    'categories.symbols': 'Symboler',\n    'categories.travel-places': 'Reise & steder',\n    'error.load': 'Klarte ikke laste inn emojis',\n    'recents.clear': 'Fjern nylige emojis',\n    'recents.none': 'Du har ikke valgt noen emojis enda.',\n    'retry': 'PrÃ¸v igjen',\n    'search.clear': 'TÃ¸m sÃ¸k',\n    'search.error': 'Klarte ikke Ã¥ sÃ¸ke etter emojis',\n    'search.notFound': 'Ingen emojis funnet',\n    'search': 'SÃ¸k etter emojis...'\n  };\n  ", "export default {\n    'categories.activities': 'Aktiviteter',\n    'categories.animals-nature': 'Djur & natur',\n    'categories.custom': 'Anpassad',\n    'categories.flags': 'Flagga',\n    'categories.food-drink': 'Mat & dryck',\n    'categories.objects': 'Objekt',\n    'categories.people-body': 'MÃ¤nniskor & kropp',\n    'categories.recents': 'Nyligen anvÃ¤nd',\n    'categories.smileys-emotion': 'HumÃ¶r & kÃ¤nslor',\n    'categories.symbols': 'Symboler',\n    'categories.travel-places': 'Resor & platser',\n    'error.load': 'Det gick inte att ladda emojis',\n    'recents.clear': 'Ta bort de senaste emojis',\n    'recents.none': 'Du har inte valt nÃ¥gra emojis Ã¤n',\n    'retry': 'FÃ¶rsÃ¶k igen',\n    'search.clear': 'Tom sÃ¶kning',\n    'search.error': 'Det gick inte att sÃ¶ka efter emojis',\n    'search.notFound': 'Inga emojis hittades',\n    'search': 'SÃ¶k efter emojis...'\n  };\n  ", "import { isSessionStorageAvailable } from '../util';\nimport { createStorage } from '../webStorageShim';\nimport { WebStorageProvider } from './WebStorageProvider';\n\nexport class SessionStorageProvider extends WebStorageProvider {\n  constructor() {\n    super(isSessionStorageAvailable() ? sessionStorage : createStorage());\n  }\n}\n", "import { EmojiRecord } from '../types';\nimport { RecentsProvider } from './RecentsProvider';\n\nexport class InMemoryProvider extends RecentsProvider {\n  recents = [] as Array<EmojiRecord>;\n\n  clear(): void {\n    this.recents = [];\n  }\n\n  getRecents(maxCount: number): Array<EmojiRecord> {\n    return this.recents.slice(0, maxCount);\n  }\n\n  addOrUpdateRecent(emoji: EmojiRecord, maxCount: number): void {\n    this.recents = [\n      emoji,\n      ...this.getRecents(maxCount).filter(recent => recent.hexcode !== emoji.hexcode)\n    ].slice(0, maxCount);\n  }\n}\n", "import { Locale, MessagesDataset, Emoji } from 'emojibase';\nimport { initDatabase as initDatabaseInternal } from './data/emojiData';\n\nexport * from './util';\nexport * from './focusTrap';\nexport * from './options';\nexport * from './events';\nexport * from './types';\nexport * from './themes';\nexport { default as globalConfig } from './globalConfig';\nexport { createPicker } from './createPicker';\nexport { EmojiPicker } from './views/EmojiPicker';\nexport type { ExternalEvent, ExternalEventKey } from './ExternalEvents';\n\nexport { Renderer } from './renderers/renderer';\nexport { NativeRenderer } from './renderers/native';\n\nimport * as i18n from './i18n';\nexport { i18n };\n\nexport { default as en } from './i18n/lang-en';\nexport { deleteDatabase } from './data/emojiData';\nimport { DataStoreFactory } from './data/DataStore';\nexport { createStyleInjector } from './injectStyles';\nexport { IndexedDbStoreFactory } from './data/IndexedDbStore';\nexport { InMemoryStoreFactory } from './data/InMemoryStore';\n\nexport * from './recents/index';\n\nexport async function createDatabase(locale: Locale, factory: DataStoreFactory, staticMessages?: MessagesDataset, staticEmojis?: Emoji[]): Promise<void> {\n  const database = await initDatabaseInternal(locale, factory, staticMessages, staticEmojis);\n  database.close();\n}\n\n", "function getSide(placement) {\n  return placement.split('-')[0];\n}\n\nfunction getAlignment(placement) {\n  return placement.split('-')[1];\n}\n\nfunction getMainAxisFromPlacement(placement) {\n  return ['top', 'bottom'].includes(getSide(placement)) ? 'x' : 'y';\n}\n\nfunction getLengthFromAxis(axis) {\n  return axis === 'y' ? 'height' : 'width';\n}\n\nfunction computeCoordsFromPlacement(_ref, placement, rtl) {\n  let {\n    reference,\n    floating\n  } = _ref;\n  const commonX = reference.x + reference.width / 2 - floating.width / 2;\n  const commonY = reference.y + reference.height / 2 - floating.height / 2;\n  const mainAxis = getMainAxisFromPlacement(placement);\n  const length = getLengthFromAxis(mainAxis);\n  const commonAlign = reference[length] / 2 - floating[length] / 2;\n  const side = getSide(placement);\n  const isVertical = mainAxis === 'x';\n  let coords;\n\n  switch (side) {\n    case 'top':\n      coords = {\n        x: commonX,\n        y: reference.y - floating.height\n      };\n      break;\n\n    case 'bottom':\n      coords = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n\n    case 'right':\n      coords = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n\n    case 'left':\n      coords = {\n        x: reference.x - floating.width,\n        y: commonY\n      };\n      break;\n\n    default:\n      coords = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n\n  switch (getAlignment(placement)) {\n    case 'start':\n      coords[mainAxis] -= commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n\n    case 'end':\n      coords[mainAxis] += commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n  }\n\n  return coords;\n}\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a reference element when it is given a certain positioning strategy.\n *\n * This export does not have any `platform` interface logic. You will need to\n * write one for the platform you are using Floating UI with.\n */\n\nconst computePosition = async (reference, floating, config) => {\n  const {\n    placement = 'bottom',\n    strategy = 'absolute',\n    middleware = [],\n    platform\n  } = config;\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(floating));\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (platform == null) {\n      console.error(['Floating UI: `platform` property was not passed to config. If you', 'want to use Floating UI on the web, install @floating-ui/dom', 'instead of the /core package. Otherwise, you can create your own', '`platform`: https://floating-ui.com/docs/platform'].join(' '));\n    }\n\n    if (middleware.filter(_ref => {\n      let {\n        name\n      } = _ref;\n      return name === 'autoPlacement' || name === 'flip';\n    }).length > 1) {\n      throw new Error(['Floating UI: duplicate `flip` and/or `autoPlacement`', 'middleware detected. This will lead to an infinite loop. Ensure only', 'one of either has been passed to the `middleware` array.'].join(' '));\n    }\n  }\n\n  let rects = await platform.getElementRects({\n    reference,\n    floating,\n    strategy\n  });\n  let {\n    x,\n    y\n  } = computeCoordsFromPlacement(rects, placement, rtl);\n  let statefulPlacement = placement;\n  let middlewareData = {};\n  let resetCount = 0;\n\n  for (let i = 0; i < middleware.length; i++) {\n    const {\n      name,\n      fn\n    } = middleware[i];\n    const {\n      x: nextX,\n      y: nextY,\n      data,\n      reset\n    } = await fn({\n      x,\n      y,\n      initialPlacement: placement,\n      placement: statefulPlacement,\n      strategy,\n      middlewareData,\n      rects,\n      platform,\n      elements: {\n        reference,\n        floating\n      }\n    });\n    x = nextX != null ? nextX : x;\n    y = nextY != null ? nextY : y;\n    middlewareData = { ...middlewareData,\n      [name]: { ...middlewareData[name],\n        ...data\n      }\n    };\n\n    if (process.env.NODE_ENV !== \"production\") {\n      if (resetCount > 50) {\n        console.warn(['Floating UI: The middleware lifecycle appears to be running in an', 'infinite loop. This is usually caused by a `reset` continually', 'being returned without a break condition.'].join(' '));\n      }\n    }\n\n    if (reset && resetCount <= 50) {\n      resetCount++;\n\n      if (typeof reset === 'object') {\n        if (reset.placement) {\n          statefulPlacement = reset.placement;\n        }\n\n        if (reset.rects) {\n          rects = reset.rects === true ? await platform.getElementRects({\n            reference,\n            floating,\n            strategy\n          }) : reset.rects;\n        }\n\n        ({\n          x,\n          y\n        } = computeCoordsFromPlacement(rects, statefulPlacement, rtl));\n      }\n\n      i = -1;\n      continue;\n    }\n  }\n\n  return {\n    x,\n    y,\n    placement: statefulPlacement,\n    strategy,\n    middlewareData\n  };\n};\n\nfunction expandPaddingObject(padding) {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    ...padding\n  };\n}\n\nfunction getSideObjectFromPadding(padding) {\n  return typeof padding !== 'number' ? expandPaddingObject(padding) : {\n    top: padding,\n    right: padding,\n    bottom: padding,\n    left: padding\n  };\n}\n\nfunction rectToClientRect(rect) {\n  return { ...rect,\n    top: rect.y,\n    left: rect.x,\n    right: rect.x + rect.width,\n    bottom: rect.y + rect.height\n  };\n}\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nasync function detectOverflow(middlewareArguments, options) {\n  var _await$platform$isEle;\n\n  if (options === void 0) {\n    options = {};\n  }\n\n  const {\n    x,\n    y,\n    platform,\n    rects,\n    elements,\n    strategy\n  } = middlewareArguments;\n  const {\n    boundary = 'clippingAncestors',\n    rootBoundary = 'viewport',\n    elementContext = 'floating',\n    altBoundary = false,\n    padding = 0\n  } = options;\n  const paddingObject = getSideObjectFromPadding(padding);\n  const altContext = elementContext === 'floating' ? 'reference' : 'floating';\n  const element = elements[altBoundary ? altContext : elementContext];\n  const clippingClientRect = rectToClientRect(await platform.getClippingRect({\n    element: ((_await$platform$isEle = await (platform.isElement == null ? void 0 : platform.isElement(element))) != null ? _await$platform$isEle : true) ? element : element.contextElement || (await (platform.getDocumentElement == null ? void 0 : platform.getDocumentElement(elements.floating))),\n    boundary,\n    rootBoundary,\n    strategy\n  }));\n  const elementClientRect = rectToClientRect(platform.convertOffsetParentRelativeRectToViewportRelativeRect ? await platform.convertOffsetParentRelativeRectToViewportRelativeRect({\n    rect: elementContext === 'floating' ? { ...rects.floating,\n      x,\n      y\n    } : rects.reference,\n    offsetParent: await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(elements.floating)),\n    strategy\n  }) : rects[elementContext]);\n  return {\n    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,\n    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,\n    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,\n    right: elementClientRect.right - clippingClientRect.right + paddingObject.right\n  };\n}\n\nconst min = Math.min;\nconst max = Math.max;\n\nfunction within(min$1, value, max$1) {\n  return max(min$1, min(value, max$1));\n}\n\n/**\n * Positions an inner element of the floating element such that it is centered\n * to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = options => ({\n  name: 'arrow',\n  options,\n\n  async fn(middlewareArguments) {\n    // Since `element` is required, we don't Partial<> the type\n    const {\n      element,\n      padding = 0\n    } = options != null ? options : {};\n    const {\n      x,\n      y,\n      placement,\n      rects,\n      platform\n    } = middlewareArguments;\n\n    if (element == null) {\n      if (process.env.NODE_ENV !== \"production\") {\n        console.warn('Floating UI: No `element` was passed to the `arrow` middleware.');\n      }\n\n      return {};\n    }\n\n    const paddingObject = getSideObjectFromPadding(padding);\n    const coords = {\n      x,\n      y\n    };\n    const axis = getMainAxisFromPlacement(placement);\n    const alignment = getAlignment(placement);\n    const length = getLengthFromAxis(axis);\n    const arrowDimensions = await platform.getDimensions(element);\n    const minProp = axis === 'y' ? 'top' : 'left';\n    const maxProp = axis === 'y' ? 'bottom' : 'right';\n    const endDiff = rects.reference[length] + rects.reference[axis] - coords[axis] - rects.floating[length];\n    const startDiff = coords[axis] - rects.reference[axis];\n    const arrowOffsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(element));\n    let clientSize = arrowOffsetParent ? axis === 'y' ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;\n\n    if (clientSize === 0) {\n      clientSize = rects.floating[length];\n    }\n\n    const centerToReference = endDiff / 2 - startDiff / 2; // Make sure the arrow doesn't overflow the floating element if the center\n    // point is outside the floating element's bounds\n\n    const min = paddingObject[minProp];\n    const max = clientSize - arrowDimensions[length] - paddingObject[maxProp];\n    const center = clientSize / 2 - arrowDimensions[length] / 2 + centerToReference;\n    const offset = within(min, center, max); // Make sure that arrow points at the reference\n\n    const alignmentPadding = alignment === 'start' ? paddingObject[minProp] : paddingObject[maxProp];\n    const shouldAddOffset = alignmentPadding > 0 && center !== offset && rects.reference[length] <= rects.floating[length];\n    const alignmentOffset = shouldAddOffset ? center < min ? min - center : max - center : 0;\n    return {\n      [axis]: coords[axis] - alignmentOffset,\n      data: {\n        [axis]: offset,\n        centerOffset: center - offset\n      }\n    };\n  }\n\n});\n\nconst hash$1 = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nfunction getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, matched => hash$1[matched]);\n}\n\nfunction getAlignmentSides(placement, rects, rtl) {\n  if (rtl === void 0) {\n    rtl = false;\n  }\n\n  const alignment = getAlignment(placement);\n  const mainAxis = getMainAxisFromPlacement(placement);\n  const length = getLengthFromAxis(mainAxis);\n  let mainAlignmentSide = mainAxis === 'x' ? alignment === (rtl ? 'end' : 'start') ? 'right' : 'left' : alignment === 'start' ? 'bottom' : 'top';\n\n  if (rects.reference[length] > rects.floating[length]) {\n    mainAlignmentSide = getOppositePlacement(mainAlignmentSide);\n  }\n\n  return {\n    main: mainAlignmentSide,\n    cross: getOppositePlacement(mainAlignmentSide)\n  };\n}\n\nconst hash = {\n  start: 'end',\n  end: 'start'\n};\nfunction getOppositeAlignmentPlacement(placement) {\n  return placement.replace(/start|end/g, matched => hash[matched]);\n}\n\nconst sides = ['top', 'right', 'bottom', 'left'];\nconst allPlacements = /*#__PURE__*/sides.reduce((acc, side) => acc.concat(side, side + \"-start\", side + \"-end\"), []);\n\nfunction getPlacementList(alignment, autoAlignment, allowedPlacements) {\n  const allowedPlacementsSortedByAlignment = alignment ? [...allowedPlacements.filter(placement => getAlignment(placement) === alignment), ...allowedPlacements.filter(placement => getAlignment(placement) !== alignment)] : allowedPlacements.filter(placement => getSide(placement) === placement);\n  return allowedPlacementsSortedByAlignment.filter(placement => {\n    if (alignment) {\n      return getAlignment(placement) === alignment || (autoAlignment ? getOppositeAlignmentPlacement(placement) !== placement : false);\n    }\n\n    return true;\n  });\n}\n\n/**\n * Automatically chooses the `placement` which has the most space available.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  return {\n    name: 'autoPlacement',\n    options,\n\n    async fn(middlewareArguments) {\n      var _middlewareData$autoP, _middlewareData$autoP2, _middlewareData$autoP3, _middlewareData$autoP4, _placementsSortedByLe;\n\n      const {\n        x,\n        y,\n        rects,\n        middlewareData,\n        placement,\n        platform,\n        elements\n      } = middlewareArguments;\n      const {\n        alignment = null,\n        allowedPlacements = allPlacements,\n        autoAlignment = true,\n        ...detectOverflowOptions\n      } = options;\n      const placements = getPlacementList(alignment, autoAlignment, allowedPlacements);\n      const overflow = await detectOverflow(middlewareArguments, detectOverflowOptions);\n      const currentIndex = (_middlewareData$autoP = (_middlewareData$autoP2 = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP2.index) != null ? _middlewareData$autoP : 0;\n      const currentPlacement = placements[currentIndex];\n\n      if (currentPlacement == null) {\n        return {};\n      }\n\n      const {\n        main,\n        cross\n      } = getAlignmentSides(currentPlacement, rects, await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating))); // Make `computeCoords` start from the right place\n\n      if (placement !== currentPlacement) {\n        return {\n          x,\n          y,\n          reset: {\n            placement: placements[0]\n          }\n        };\n      }\n\n      const currentOverflows = [overflow[getSide(currentPlacement)], overflow[main], overflow[cross]];\n      const allOverflows = [...((_middlewareData$autoP3 = (_middlewareData$autoP4 = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP4.overflows) != null ? _middlewareData$autoP3 : []), {\n        placement: currentPlacement,\n        overflows: currentOverflows\n      }];\n      const nextPlacement = placements[currentIndex + 1]; // There are more placements to check\n\n      if (nextPlacement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: nextPlacement\n          }\n        };\n      }\n\n      const placementsSortedByLeastOverflow = allOverflows.slice().sort((a, b) => a.overflows[0] - b.overflows[0]);\n      const placementThatFitsOnAllSides = (_placementsSortedByLe = placementsSortedByLeastOverflow.find(_ref => {\n        let {\n          overflows\n        } = _ref;\n        return overflows.every(overflow => overflow <= 0);\n      })) == null ? void 0 : _placementsSortedByLe.placement;\n      const resetPlacement = placementThatFitsOnAllSides != null ? placementThatFitsOnAllSides : placementsSortedByLeastOverflow[0].placement;\n\n      if (resetPlacement !== placement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: resetPlacement\n          }\n        };\n      }\n\n      return {};\n    }\n\n  };\n};\n\nfunction getExpandedPlacements(placement) {\n  const oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeAlignmentPlacement(placement), oppositePlacement, getOppositeAlignmentPlacement(oppositePlacement)];\n}\n\n/**\n * Changes the placement of the floating element to one that will fit if the\n * initially specified `placement` does not.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  return {\n    name: 'flip',\n    options,\n\n    async fn(middlewareArguments) {\n      var _middlewareData$flip;\n\n      const {\n        placement,\n        middlewareData,\n        rects,\n        initialPlacement,\n        platform,\n        elements\n      } = middlewareArguments;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true,\n        fallbackPlacements: specifiedFallbackPlacements,\n        fallbackStrategy = 'bestFit',\n        flipAlignment = true,\n        ...detectOverflowOptions\n      } = options;\n      const side = getSide(placement);\n      const isBasePlacement = side === initialPlacement;\n      const fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipAlignment ? [getOppositePlacement(initialPlacement)] : getExpandedPlacements(initialPlacement));\n      const placements = [initialPlacement, ...fallbackPlacements];\n      const overflow = await detectOverflow(middlewareArguments, detectOverflowOptions);\n      const overflows = [];\n      let overflowsData = ((_middlewareData$flip = middlewareData.flip) == null ? void 0 : _middlewareData$flip.overflows) || [];\n\n      if (checkMainAxis) {\n        overflows.push(overflow[side]);\n      }\n\n      if (checkCrossAxis) {\n        const {\n          main,\n          cross\n        } = getAlignmentSides(placement, rects, await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating)));\n        overflows.push(overflow[main], overflow[cross]);\n      }\n\n      overflowsData = [...overflowsData, {\n        placement,\n        overflows\n      }]; // One or more sides is overflowing\n\n      if (!overflows.every(side => side <= 0)) {\n        var _middlewareData$flip$, _middlewareData$flip2;\n\n        const nextIndex = ((_middlewareData$flip$ = (_middlewareData$flip2 = middlewareData.flip) == null ? void 0 : _middlewareData$flip2.index) != null ? _middlewareData$flip$ : 0) + 1;\n        const nextPlacement = placements[nextIndex];\n\n        if (nextPlacement) {\n          // Try next placement and re-run the lifecycle\n          return {\n            data: {\n              index: nextIndex,\n              overflows: overflowsData\n            },\n            reset: {\n              placement: nextPlacement\n            }\n          };\n        }\n\n        let resetPlacement = 'bottom';\n\n        switch (fallbackStrategy) {\n          case 'bestFit':\n            {\n              var _overflowsData$map$so;\n\n              const placement = (_overflowsData$map$so = overflowsData.map(d => [d, d.overflows.filter(overflow => overflow > 0).reduce((acc, overflow) => acc + overflow, 0)]).sort((a, b) => a[1] - b[1])[0]) == null ? void 0 : _overflowsData$map$so[0].placement;\n\n              if (placement) {\n                resetPlacement = placement;\n              }\n\n              break;\n            }\n\n          case 'initialPlacement':\n            resetPlacement = initialPlacement;\n            break;\n        }\n\n        if (placement !== resetPlacement) {\n          return {\n            reset: {\n              placement: resetPlacement\n            }\n          };\n        }\n      }\n\n      return {};\n    }\n\n  };\n};\n\nfunction getSideOffsets(overflow, rect) {\n  return {\n    top: overflow.top - rect.height,\n    right: overflow.right - rect.width,\n    bottom: overflow.bottom - rect.height,\n    left: overflow.left - rect.width\n  };\n}\n\nfunction isAnySideFullyClipped(overflow) {\n  return sides.some(side => overflow[side] >= 0);\n}\n\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = function (_temp) {\n  let {\n    strategy = 'referenceHidden',\n    ...detectOverflowOptions\n  } = _temp === void 0 ? {} : _temp;\n  return {\n    name: 'hide',\n\n    async fn(middlewareArguments) {\n      const {\n        rects\n      } = middlewareArguments;\n\n      switch (strategy) {\n        case 'referenceHidden':\n          {\n            const overflow = await detectOverflow(middlewareArguments, { ...detectOverflowOptions,\n              elementContext: 'reference'\n            });\n            const offsets = getSideOffsets(overflow, rects.reference);\n            return {\n              data: {\n                referenceHiddenOffsets: offsets,\n                referenceHidden: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n\n        case 'escaped':\n          {\n            const overflow = await detectOverflow(middlewareArguments, { ...detectOverflowOptions,\n              altBoundary: true\n            });\n            const offsets = getSideOffsets(overflow, rects.floating);\n            return {\n              data: {\n                escapedOffsets: offsets,\n                escaped: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n\n        default:\n          {\n            return {};\n          }\n      }\n    }\n\n  };\n};\n\nasync function convertValueToCoords(middlewareArguments, value) {\n  const {\n    placement,\n    platform,\n    elements\n  } = middlewareArguments;\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n  const side = getSide(placement);\n  const alignment = getAlignment(placement);\n  const isVertical = getMainAxisFromPlacement(placement) === 'x';\n  const mainAxisMulti = ['left', 'top'].includes(side) ? -1 : 1;\n  const crossAxisMulti = rtl && isVertical ? -1 : 1;\n  const rawValue = typeof value === 'function' ? value(middlewareArguments) : value; // eslint-disable-next-line prefer-const\n\n  let {\n    mainAxis,\n    crossAxis,\n    alignmentAxis\n  } = typeof rawValue === 'number' ? {\n    mainAxis: rawValue,\n    crossAxis: 0,\n    alignmentAxis: null\n  } : {\n    mainAxis: 0,\n    crossAxis: 0,\n    alignmentAxis: null,\n    ...rawValue\n  };\n\n  if (alignment && typeof alignmentAxis === 'number') {\n    crossAxis = alignment === 'end' ? alignmentAxis * -1 : alignmentAxis;\n  }\n\n  return isVertical ? {\n    x: crossAxis * crossAxisMulti,\n    y: mainAxis * mainAxisMulti\n  } : {\n    x: mainAxis * mainAxisMulti,\n    y: crossAxis * crossAxisMulti\n  };\n}\n/**\n * Displaces the floating element from its reference element.\n * @see https://floating-ui.com/docs/offset\n */\n\nconst offset = function (value) {\n  if (value === void 0) {\n    value = 0;\n  }\n\n  return {\n    name: 'offset',\n    options: value,\n\n    async fn(middlewareArguments) {\n      const {\n        x,\n        y\n      } = middlewareArguments;\n      const diffCoords = await convertValueToCoords(middlewareArguments, value);\n      return {\n        x: x + diffCoords.x,\n        y: y + diffCoords.y,\n        data: diffCoords\n      };\n    }\n\n  };\n};\n\nfunction getCrossAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\n\n/**\n * Shifts the floating element in order to keep it in view when it will overflow\n * a clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  return {\n    name: 'shift',\n    options,\n\n    async fn(middlewareArguments) {\n      const {\n        x,\n        y,\n        placement\n      } = middlewareArguments;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = false,\n        limiter = {\n          fn: _ref => {\n            let {\n              x,\n              y\n            } = _ref;\n            return {\n              x,\n              y\n            };\n          }\n        },\n        ...detectOverflowOptions\n      } = options;\n      const coords = {\n        x,\n        y\n      };\n      const overflow = await detectOverflow(middlewareArguments, detectOverflowOptions);\n      const mainAxis = getMainAxisFromPlacement(getSide(placement));\n      const crossAxis = getCrossAxis(mainAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n\n      if (checkMainAxis) {\n        const minSide = mainAxis === 'y' ? 'top' : 'left';\n        const maxSide = mainAxis === 'y' ? 'bottom' : 'right';\n        const min = mainAxisCoord + overflow[minSide];\n        const max = mainAxisCoord - overflow[maxSide];\n        mainAxisCoord = within(min, mainAxisCoord, max);\n      }\n\n      if (checkCrossAxis) {\n        const minSide = crossAxis === 'y' ? 'top' : 'left';\n        const maxSide = crossAxis === 'y' ? 'bottom' : 'right';\n        const min = crossAxisCoord + overflow[minSide];\n        const max = crossAxisCoord - overflow[maxSide];\n        crossAxisCoord = within(min, crossAxisCoord, max);\n      }\n\n      const limitedCoords = limiter.fn({ ...middlewareArguments,\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      });\n      return { ...limitedCoords,\n        data: {\n          x: limitedCoords.x - x,\n          y: limitedCoords.y - y\n        }\n      };\n    }\n\n  };\n};\n\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  return {\n    options,\n\n    fn(middlewareArguments) {\n      const {\n        x,\n        y,\n        placement,\n        rects,\n        middlewareData\n      } = middlewareArguments;\n      const {\n        offset = 0,\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true\n      } = options;\n      const coords = {\n        x,\n        y\n      };\n      const mainAxis = getMainAxisFromPlacement(placement);\n      const crossAxis = getCrossAxis(mainAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      const rawOffset = typeof offset === 'function' ? offset(middlewareArguments) : offset;\n      const computedOffset = typeof rawOffset === 'number' ? {\n        mainAxis: rawOffset,\n        crossAxis: 0\n      } : {\n        mainAxis: 0,\n        crossAxis: 0,\n        ...rawOffset\n      };\n\n      if (checkMainAxis) {\n        const len = mainAxis === 'y' ? 'height' : 'width';\n        const limitMin = rects.reference[mainAxis] - rects.floating[len] + computedOffset.mainAxis;\n        const limitMax = rects.reference[mainAxis] + rects.reference[len] - computedOffset.mainAxis;\n\n        if (mainAxisCoord < limitMin) {\n          mainAxisCoord = limitMin;\n        } else if (mainAxisCoord > limitMax) {\n          mainAxisCoord = limitMax;\n        }\n      }\n\n      if (checkCrossAxis) {\n        var _middlewareData$offse, _middlewareData$offse2, _middlewareData$offse3, _middlewareData$offse4;\n\n        const len = mainAxis === 'y' ? 'width' : 'height';\n        const isOriginSide = ['top', 'left'].includes(getSide(placement));\n        const limitMin = rects.reference[crossAxis] - rects.floating[len] + (isOriginSide ? (_middlewareData$offse = (_middlewareData$offse2 = middlewareData.offset) == null ? void 0 : _middlewareData$offse2[crossAxis]) != null ? _middlewareData$offse : 0 : 0) + (isOriginSide ? 0 : computedOffset.crossAxis);\n        const limitMax = rects.reference[crossAxis] + rects.reference[len] + (isOriginSide ? 0 : (_middlewareData$offse3 = (_middlewareData$offse4 = middlewareData.offset) == null ? void 0 : _middlewareData$offse4[crossAxis]) != null ? _middlewareData$offse3 : 0) - (isOriginSide ? computedOffset.crossAxis : 0);\n\n        if (crossAxisCoord < limitMin) {\n          crossAxisCoord = limitMin;\n        } else if (crossAxisCoord > limitMax) {\n          crossAxisCoord = limitMax;\n        }\n      }\n\n      return {\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      };\n    }\n\n  };\n};\n\n/**\n * Provides data to change the size of the floating element. For instance,\n * prevent it from overflowing its clipping boundary or match the width of the\n * reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  return {\n    name: 'size',\n    options,\n\n    async fn(middlewareArguments) {\n      const {\n        placement,\n        rects,\n        platform,\n        elements\n      } = middlewareArguments;\n      const {\n        apply = () => {},\n        ...detectOverflowOptions\n      } = options;\n      const overflow = await detectOverflow(middlewareArguments, detectOverflowOptions);\n      const side = getSide(placement);\n      const alignment = getAlignment(placement);\n      let heightSide;\n      let widthSide;\n\n      if (side === 'top' || side === 'bottom') {\n        heightSide = side;\n        widthSide = alignment === ((await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating))) ? 'start' : 'end') ? 'left' : 'right';\n      } else {\n        widthSide = side;\n        heightSide = alignment === 'end' ? 'top' : 'bottom';\n      }\n\n      const xMin = max(overflow.left, 0);\n      const xMax = max(overflow.right, 0);\n      const yMin = max(overflow.top, 0);\n      const yMax = max(overflow.bottom, 0);\n      const dimensions = {\n        availableHeight: rects.floating.height - (['left', 'right'].includes(placement) ? 2 * (yMin !== 0 || yMax !== 0 ? yMin + yMax : max(overflow.top, overflow.bottom)) : overflow[heightSide]),\n        availableWidth: rects.floating.width - (['top', 'bottom'].includes(placement) ? 2 * (xMin !== 0 || xMax !== 0 ? xMin + xMax : max(overflow.left, overflow.right)) : overflow[widthSide])\n      };\n      await apply({ ...middlewareArguments,\n        ...dimensions\n      });\n      const nextDimensions = await platform.getDimensions(elements.floating);\n\n      if (rects.floating.width !== nextDimensions.width || rects.floating.height !== nextDimensions.height) {\n        return {\n          reset: {\n            rects: true\n          }\n        };\n      }\n\n      return {};\n    }\n\n  };\n};\n\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  return {\n    name: 'inline',\n    options,\n\n    async fn(middlewareArguments) {\n      var _await$platform$getCl;\n\n      const {\n        placement,\n        elements,\n        rects,\n        platform,\n        strategy\n      } = middlewareArguments; // A MouseEvent's client{X,Y} coords can be up to 2 pixels off a\n      // ClientRect's bounds, despite the event listener being triggered. A\n      // padding of 2 seems to handle this issue.\n\n      const {\n        padding = 2,\n        x,\n        y\n      } = options;\n      const fallback = rectToClientRect(platform.convertOffsetParentRelativeRectToViewportRelativeRect ? await platform.convertOffsetParentRelativeRectToViewportRelativeRect({\n        rect: rects.reference,\n        offsetParent: await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(elements.floating)),\n        strategy\n      }) : rects.reference);\n      const clientRects = (_await$platform$getCl = await (platform.getClientRects == null ? void 0 : platform.getClientRects(elements.reference))) != null ? _await$platform$getCl : [];\n      const paddingObject = getSideObjectFromPadding(padding);\n\n      function getBoundingClientRect() {\n        // There are two rects and they are disjoined\n        if (clientRects.length === 2 && clientRects[0].left > clientRects[1].right && x != null && y != null) {\n          var _clientRects$find;\n\n          // Find the first rect in which the point is fully inside\n          return (_clientRects$find = clientRects.find(rect => x > rect.left - paddingObject.left && x < rect.right + paddingObject.right && y > rect.top - paddingObject.top && y < rect.bottom + paddingObject.bottom)) != null ? _clientRects$find : fallback;\n        } // There are 2 or more connected rects\n\n\n        if (clientRects.length >= 2) {\n          if (getMainAxisFromPlacement(placement) === 'x') {\n            const firstRect = clientRects[0];\n            const lastRect = clientRects[clientRects.length - 1];\n            const isTop = getSide(placement) === 'top';\n            const top = firstRect.top;\n            const bottom = lastRect.bottom;\n            const left = isTop ? firstRect.left : lastRect.left;\n            const right = isTop ? firstRect.right : lastRect.right;\n            const width = right - left;\n            const height = bottom - top;\n            return {\n              top,\n              bottom,\n              left,\n              right,\n              width,\n              height,\n              x: left,\n              y: top\n            };\n          }\n\n          const isLeftSide = getSide(placement) === 'left';\n          const maxRight = max(...clientRects.map(rect => rect.right));\n          const minLeft = min(...clientRects.map(rect => rect.left));\n          const measureRects = clientRects.filter(rect => isLeftSide ? rect.left === minLeft : rect.right === maxRight);\n          const top = measureRects[0].top;\n          const bottom = measureRects[measureRects.length - 1].bottom;\n          const left = minLeft;\n          const right = maxRight;\n          const width = right - left;\n          const height = bottom - top;\n          return {\n            top,\n            bottom,\n            left,\n            right,\n            width,\n            height,\n            x: left,\n            y: top\n          };\n        }\n\n        return fallback;\n      }\n\n      const resetRects = await platform.getElementRects({\n        reference: {\n          getBoundingClientRect\n        },\n        floating: elements.floating,\n        strategy\n      });\n\n      if (rects.reference.x !== resetRects.reference.x || rects.reference.y !== resetRects.reference.y || rects.reference.width !== resetRects.reference.width || rects.reference.height !== resetRects.reference.height) {\n        return {\n          reset: {\n            rects: resetRects\n          }\n        };\n      }\n\n      return {};\n    }\n\n  };\n};\n\nexport { arrow, autoPlacement, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, rectToClientRect, shift, size };\n", "import { rectToClientRect, computePosition as computePosition$1 } from '@floating-ui/core';\nexport { arrow, autoPlacement, detectOverflow, flip, hide, inline, limitShift, offset, shift, size } from '@floating-ui/core';\n\nfunction isWindow(value) {\n  return value && value.document && value.location && value.alert && value.setInterval;\n}\nfunction getWindow(node) {\n  if (node == null) {\n    return window;\n  }\n\n  if (!isWindow(node)) {\n    const ownerDocument = node.ownerDocument;\n    return ownerDocument ? ownerDocument.defaultView || window : window;\n  }\n\n  return node;\n}\n\nfunction getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}\n\nfunction getNodeName(node) {\n  return isWindow(node) ? '' : node ? (node.nodeName || '').toLowerCase() : '';\n}\n\nfunction getUAString() {\n  const uaData = navigator.userAgentData;\n\n  if (uaData != null && uaData.brands) {\n    return uaData.brands.map(item => item.brand + \"/\" + item.version).join(' ');\n  }\n\n  return navigator.userAgent;\n}\n\nfunction isHTMLElement(value) {\n  return value instanceof getWindow(value).HTMLElement;\n}\nfunction isElement(value) {\n  return value instanceof getWindow(value).Element;\n}\nfunction isNode(value) {\n  return value instanceof getWindow(value).Node;\n}\nfunction isShadowRoot(node) {\n  // Browsers without `ShadowRoot` support\n  if (typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n\n  const OwnElement = getWindow(node).ShadowRoot;\n  return node instanceof OwnElement || node instanceof ShadowRoot;\n}\nfunction isOverflowElement(element) {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  const {\n    overflow,\n    overflowX,\n    overflowY\n  } = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}\nfunction isTableElement(element) {\n  return ['table', 'td', 'th'].includes(getNodeName(element));\n}\nfunction isContainingBlock(element) {\n  // TODO: Try and use feature detection here instead\n  const isFirefox = /firefox/i.test(getUAString());\n  const css = getComputedStyle(element); // This is non-exhaustive but covers the most common CSS properties that\n  // create a containing block.\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n\n  return css.transform !== 'none' || css.perspective !== 'none' || // @ts-ignore (TS 4.1 compat)\n  css.contain === 'paint' || ['transform', 'perspective'].includes(css.willChange) || isFirefox && css.willChange === 'filter' || isFirefox && (css.filter ? css.filter !== 'none' : false);\n}\nfunction isLayoutViewport() {\n  // Not Safari\n  return !/^((?!chrome|android).)*safari/i.test(getUAString()); // Feature detection for this fails in various ways\n  // â€¢ Always-visible scrollbar or not\n  // â€¢ Width of <html>, etc.\n  // const vV = win.visualViewport;\n  // return vV ? Math.abs(win.innerWidth / vV.scale - vV.width) < 0.5 : true;\n}\n\nconst min = Math.min;\nconst max = Math.max;\nconst round = Math.round;\n\nfunction getBoundingClientRect(element, includeScale, isFixedStrategy) {\n  var _win$visualViewport$o, _win$visualViewport, _win$visualViewport$o2, _win$visualViewport2;\n\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n\n  const clientRect = element.getBoundingClientRect();\n  let scaleX = 1;\n  let scaleY = 1;\n\n  if (includeScale && isHTMLElement(element)) {\n    scaleX = element.offsetWidth > 0 ? round(clientRect.width) / element.offsetWidth || 1 : 1;\n    scaleY = element.offsetHeight > 0 ? round(clientRect.height) / element.offsetHeight || 1 : 1;\n  }\n\n  const win = isElement(element) ? getWindow(element) : window;\n  const addVisualOffsets = !isLayoutViewport() && isFixedStrategy;\n  const x = (clientRect.left + (addVisualOffsets ? (_win$visualViewport$o = (_win$visualViewport = win.visualViewport) == null ? void 0 : _win$visualViewport.offsetLeft) != null ? _win$visualViewport$o : 0 : 0)) / scaleX;\n  const y = (clientRect.top + (addVisualOffsets ? (_win$visualViewport$o2 = (_win$visualViewport2 = win.visualViewport) == null ? void 0 : _win$visualViewport2.offsetTop) != null ? _win$visualViewport$o2 : 0 : 0)) / scaleY;\n  const width = clientRect.width / scaleX;\n  const height = clientRect.height / scaleY;\n  return {\n    width,\n    height,\n    top: y,\n    right: x + width,\n    bottom: y + height,\n    left: x,\n    x,\n    y\n  };\n}\n\nfunction getDocumentElement(node) {\n  return ((isNode(node) ? node.ownerDocument : node.document) || window.document).documentElement;\n}\n\nfunction getNodeScroll(element) {\n  if (isElement(element)) {\n    return {\n      scrollLeft: element.scrollLeft,\n      scrollTop: element.scrollTop\n    };\n  }\n\n  return {\n    scrollLeft: element.pageXOffset,\n    scrollTop: element.pageYOffset\n  };\n}\n\nfunction getWindowScrollBarX(element) {\n  // If <html> has a CSS width greater than the viewport, then this will be\n  // incorrect for RTL.\n  return getBoundingClientRect(getDocumentElement(element)).left + getNodeScroll(element).scrollLeft;\n}\n\nfunction isScaled(element) {\n  const rect = getBoundingClientRect(element);\n  return round(rect.width) !== element.offsetWidth || round(rect.height) !== element.offsetHeight;\n}\n\nfunction getRectRelativeToOffsetParent(element, offsetParent, strategy) {\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n  const rect = getBoundingClientRect(element, // @ts-ignore - checked above (TS 4.1 compat)\n  isOffsetParentAnElement && isScaled(offsetParent), strategy === 'fixed');\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  const offsets = {\n    x: 0,\n    y: 0\n  };\n\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && strategy !== 'fixed') {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n\n    if (isHTMLElement(offsetParent)) {\n      const offsetRect = getBoundingClientRect(offsetParent, true);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    } else if (documentElement) {\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n\n  return {\n    x: rect.left + scroll.scrollLeft - offsets.x,\n    y: rect.top + scroll.scrollTop - offsets.y,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\nfunction getParentNode(node) {\n  if (getNodeName(node) === 'html') {\n    return node;\n  }\n\n  return (// this is a quicker (but less type safe) way to save quite some bytes from the bundle\n    // @ts-ignore\n    node.assignedSlot || // step into the shadow DOM of the parent of a slotted node\n    node.parentNode || ( // DOM Element detected\n    isShadowRoot(node) ? node.host : null) || // ShadowRoot detected\n    getDocumentElement(node) // fallback\n\n  );\n}\n\nfunction getTrueOffsetParent(element) {\n  if (!isHTMLElement(element) || getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n\n  return composedOffsetParent(element);\n}\n/**\n * Polyfills the old offsetParent behavior from before the spec was changed:\n * https://github.com/w3c/csswg-drafts/issues/159\n */\n\n\nfunction composedOffsetParent(element) {\n  let {\n    offsetParent\n  } = element;\n  let ancestor = element;\n  let foundInsideSlot = false;\n\n  while (ancestor && ancestor !== offsetParent) {\n    const {\n      assignedSlot\n    } = ancestor;\n\n    if (assignedSlot) {\n      let newOffsetParent = assignedSlot.offsetParent;\n\n      if (getComputedStyle(assignedSlot).display === 'contents') {\n        const hadStyleAttribute = assignedSlot.hasAttribute('style');\n        const oldDisplay = assignedSlot.style.display;\n        assignedSlot.style.display = getComputedStyle(ancestor).display;\n        newOffsetParent = assignedSlot.offsetParent;\n        assignedSlot.style.display = oldDisplay;\n\n        if (!hadStyleAttribute) {\n          assignedSlot.removeAttribute('style');\n        }\n      }\n\n      ancestor = assignedSlot;\n\n      if (offsetParent !== newOffsetParent) {\n        offsetParent = newOffsetParent;\n        foundInsideSlot = true;\n      }\n    } else if (isShadowRoot(ancestor) && ancestor.host && foundInsideSlot) {\n      break;\n    }\n\n    ancestor = isShadowRoot(ancestor) && ancestor.host || ancestor.parentNode;\n  }\n\n  return offsetParent;\n}\n\nfunction getContainingBlock(element) {\n  let currentNode = getParentNode(element);\n\n  if (isShadowRoot(currentNode)) {\n    currentNode = currentNode.host;\n  }\n\n  while (isHTMLElement(currentNode) && !['html', 'body'].includes(getNodeName(currentNode))) {\n    if (isContainingBlock(currentNode)) {\n      return currentNode;\n    } else {\n      const parent = currentNode.parentNode;\n      currentNode = isShadowRoot(parent) ? parent.host : parent;\n    }\n  }\n\n  return null;\n} // Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\n\n\nfunction getOffsetParent(element) {\n  const window = getWindow(element);\n  let offsetParent = getTrueOffsetParent(element);\n\n  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === 'static') {\n    offsetParent = getTrueOffsetParent(offsetParent);\n  }\n\n  if (offsetParent && (getNodeName(offsetParent) === 'html' || getNodeName(offsetParent) === 'body' && getComputedStyle(offsetParent).position === 'static' && !isContainingBlock(offsetParent))) {\n    return window;\n  }\n\n  return offsetParent || getContainingBlock(element) || window;\n}\n\nfunction getDimensions(element) {\n  if (isHTMLElement(element)) {\n    return {\n      width: element.offsetWidth,\n      height: element.offsetHeight\n    };\n  }\n\n  const rect = getBoundingClientRect(element);\n  return {\n    width: rect.width,\n    height: rect.height\n  };\n}\n\nfunction convertOffsetParentRelativeRectToViewportRelativeRect(_ref) {\n  let {\n    rect,\n    offsetParent,\n    strategy\n  } = _ref;\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n\n  if (offsetParent === documentElement) {\n    return rect;\n  }\n\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  const offsets = {\n    x: 0,\n    y: 0\n  };\n\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && strategy !== 'fixed') {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n\n    if (isHTMLElement(offsetParent)) {\n      const offsetRect = getBoundingClientRect(offsetParent, true);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    } // This doesn't appear to be need to be negated.\n    // else if (documentElement) {\n    //   offsets.x = getWindowScrollBarX(documentElement);\n    // }\n\n  }\n\n  return { ...rect,\n    x: rect.x - scroll.scrollLeft + offsets.x,\n    y: rect.y - scroll.scrollTop + offsets.y\n  };\n}\n\nfunction getViewportRect(element, strategy) {\n  const win = getWindow(element);\n  const html = getDocumentElement(element);\n  const visualViewport = win.visualViewport;\n  let width = html.clientWidth;\n  let height = html.clientHeight;\n  let x = 0;\n  let y = 0;\n\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    const layoutViewport = isLayoutViewport();\n\n    if (layoutViewport || !layoutViewport && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable\n\nfunction getDocumentRect(element) {\n  var _element$ownerDocumen;\n\n  const html = getDocumentElement(element);\n  const scroll = getNodeScroll(element);\n  const body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;\n  const width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);\n  const height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);\n  let x = -scroll.scrollLeft + getWindowScrollBarX(element);\n  const y = -scroll.scrollTop;\n\n  if (getComputedStyle(body || html).direction === 'rtl') {\n    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;\n  }\n\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nfunction getNearestOverflowAncestor(node) {\n  const parentNode = getParentNode(node);\n\n  if (['html', 'body', '#document'].includes(getNodeName(parentNode))) {\n    // @ts-ignore assume body is always available\n    return node.ownerDocument.body;\n  }\n\n  if (isHTMLElement(parentNode) && isOverflowElement(parentNode)) {\n    return parentNode;\n  }\n\n  return getNearestOverflowAncestor(parentNode);\n}\n\nfunction getOverflowAncestors(node, list) {\n  var _node$ownerDocument;\n\n  if (list === void 0) {\n    list = [];\n  }\n\n  const scrollableAncestor = getNearestOverflowAncestor(node);\n  const isBody = scrollableAncestor === ((_node$ownerDocument = node.ownerDocument) == null ? void 0 : _node$ownerDocument.body);\n  const win = getWindow(scrollableAncestor);\n  const target = isBody ? [win].concat(win.visualViewport || [], isOverflowElement(scrollableAncestor) ? scrollableAncestor : []) : scrollableAncestor;\n  const updatedList = list.concat(target);\n  return isBody ? updatedList : // @ts-ignore: isBody tells us target will be an HTMLElement here\n  updatedList.concat(getOverflowAncestors(target));\n}\n\nfunction contains(parent, child) {\n  const rootNode = child.getRootNode == null ? void 0 : child.getRootNode(); // First, attempt with faster native method\n\n  if (parent.contains(child)) {\n    return true;\n  } // then fallback to custom implementation with Shadow DOM support\n  else if (rootNode && isShadowRoot(rootNode)) {\n    let next = child;\n\n    do {\n      // use `===` replace node.isSameNode()\n      if (next && parent === next) {\n        return true;\n      } // @ts-ignore: need a better way to handle this...\n\n\n      next = next.parentNode || next.host;\n    } while (next);\n  }\n\n  return false;\n}\n\nfunction getInnerBoundingClientRect(element, strategy) {\n  const clientRect = getBoundingClientRect(element, false, strategy === 'fixed');\n  const top = clientRect.top + element.clientTop;\n  const left = clientRect.left + element.clientLeft;\n  return {\n    top,\n    left,\n    x: left,\n    y: top,\n    right: left + element.clientWidth,\n    bottom: top + element.clientHeight,\n    width: element.clientWidth,\n    height: element.clientHeight\n  };\n}\n\nfunction getClientRectFromClippingAncestor(element, clippingParent, strategy) {\n  if (clippingParent === 'viewport') {\n    return rectToClientRect(getViewportRect(element, strategy));\n  }\n\n  if (isElement(clippingParent)) {\n    return getInnerBoundingClientRect(clippingParent, strategy);\n  }\n\n  return rectToClientRect(getDocumentRect(getDocumentElement(element)));\n} // A \"clipping ancestor\" is an overflowable container with the characteristic of\n// clipping (or hiding) overflowing elements with a position different from\n// `initial`\n\n\nfunction getClippingAncestors(element) {\n  const clippingAncestors = getOverflowAncestors(element);\n  const canEscapeClipping = ['absolute', 'fixed'].includes(getComputedStyle(element).position);\n  const clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;\n\n  if (!isElement(clipperElement)) {\n    return [];\n  } // @ts-ignore isElement check ensures we return Array<Element>\n\n\n  return clippingAncestors.filter(clippingAncestors => isElement(clippingAncestors) && contains(clippingAncestors, clipperElement) && getNodeName(clippingAncestors) !== 'body');\n} // Gets the maximum area that the element is visible in due to any number of\n// clipping ancestors\n\n\nfunction getClippingRect(_ref) {\n  let {\n    element,\n    boundary,\n    rootBoundary,\n    strategy\n  } = _ref;\n  const mainClippingAncestors = boundary === 'clippingAncestors' ? getClippingAncestors(element) : [].concat(boundary);\n  const clippingAncestors = [...mainClippingAncestors, rootBoundary];\n  const firstClippingAncestor = clippingAncestors[0];\n  const clippingRect = clippingAncestors.reduce((accRect, clippingAncestor) => {\n    const rect = getClientRectFromClippingAncestor(element, clippingAncestor, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromClippingAncestor(element, firstClippingAncestor, strategy));\n  return {\n    width: clippingRect.right - clippingRect.left,\n    height: clippingRect.bottom - clippingRect.top,\n    x: clippingRect.left,\n    y: clippingRect.top\n  };\n}\n\nconst platform = {\n  getClippingRect,\n  convertOffsetParentRelativeRectToViewportRelativeRect,\n  isElement,\n  getDimensions,\n  getOffsetParent,\n  getDocumentElement,\n  getElementRects: _ref => {\n    let {\n      reference,\n      floating,\n      strategy\n    } = _ref;\n    return {\n      reference: getRectRelativeToOffsetParent(reference, getOffsetParent(floating), strategy),\n      floating: { ...getDimensions(floating),\n        x: 0,\n        y: 0\n      }\n    };\n  },\n  getClientRects: element => Array.from(element.getClientRects()),\n  isRTL: element => getComputedStyle(element).direction === 'rtl'\n};\n\n/**\n * Automatically updates the position of the floating element when necessary.\n * @see https://floating-ui.com/docs/autoUpdate\n */\nfunction autoUpdate(reference, floating, update, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  const {\n    ancestorScroll: _ancestorScroll = true,\n    ancestorResize: _ancestorResize = true,\n    elementResize = true,\n    animationFrame = false\n  } = options;\n  const ancestorScroll = _ancestorScroll && !animationFrame;\n  const ancestorResize = _ancestorResize && !animationFrame;\n  const ancestors = ancestorScroll || ancestorResize ? [...(isElement(reference) ? getOverflowAncestors(reference) : []), ...getOverflowAncestors(floating)] : [];\n  ancestors.forEach(ancestor => {\n    ancestorScroll && ancestor.addEventListener('scroll', update, {\n      passive: true\n    });\n    ancestorResize && ancestor.addEventListener('resize', update);\n  });\n  let observer = null;\n\n  if (elementResize) {\n    let initialUpdate = true;\n    observer = new ResizeObserver(() => {\n      if (!initialUpdate) {\n        update();\n      }\n\n      initialUpdate = false;\n    });\n    isElement(reference) && !animationFrame && observer.observe(reference);\n    observer.observe(floating);\n  }\n\n  let frameId;\n  let prevRefRect = animationFrame ? getBoundingClientRect(reference) : null;\n\n  if (animationFrame) {\n    frameLoop();\n  }\n\n  function frameLoop() {\n    const nextRefRect = getBoundingClientRect(reference);\n\n    if (prevRefRect && (nextRefRect.x !== prevRefRect.x || nextRefRect.y !== prevRefRect.y || nextRefRect.width !== prevRefRect.width || nextRefRect.height !== prevRefRect.height)) {\n      update();\n    }\n\n    prevRefRect = nextRefRect;\n    frameId = requestAnimationFrame(frameLoop);\n  }\n\n  update();\n  return () => {\n    var _observer;\n\n    ancestors.forEach(ancestor => {\n      ancestorScroll && ancestor.removeEventListener('scroll', update);\n      ancestorResize && ancestor.removeEventListener('resize', update);\n    });\n    (_observer = observer) == null ? void 0 : _observer.disconnect();\n    observer = null;\n\n    if (animationFrame) {\n      cancelAnimationFrame(frameId);\n    }\n  };\n}\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a reference element when it is given a certain CSS positioning\n * strategy.\n */\n\nconst computePosition = (reference, floating, options) => computePosition$1(reference, floating, {\n  platform,\n  ...options\n});\n\nexport { autoUpdate, computePosition, getOverflowAncestors };\n", "import { autoUpdate, ComputePositionConfig, computePosition, Placement, flip, offset, autoPlacement, shift } from '@floating-ui/dom';\nimport { PopupPickerController } from './popupPicker';\nimport { Position, RelativePosition, FixedPosition, PositionLostStrategy } from './types';\n\nexport type PositionCleanup = () => void;\n\nexport async function setPosition(picker: PopupPickerController, pickerElement: HTMLElement, referenceElement: HTMLElement | undefined, position: Position): Promise<PositionCleanup> {\n  if (!position) {\n    throw new Error('Must provide a positioning option');\n  }\n\n  return await (typeof position === 'string' ? \n    setRelativePosition(picker, pickerElement, referenceElement, position) : \n    setFixedPosition(pickerElement, position));\n}\n\nasync function setRelativePosition(picker: PopupPickerController, pickerElement: HTMLElement, referenceElement: HTMLElement | undefined, placement: RelativePosition): Promise<PositionCleanup> {\n  if (!referenceElement) {\n    throw new Error('Reference element is required for relative positioning');\n  }\n\n  let config: Partial<ComputePositionConfig>;\n\n  if (placement === 'auto') {\n    config = {\n      middleware: [\n        autoPlacement(),\n        shift(),\n        offset({ mainAxis: 5, crossAxis: 12 })\n      ]\n    };\n  } else {\n    config = {\n      placement: placement as Placement,\n      middleware: [\n        flip(),\n        shift(),\n        offset(5)\n      ]\n    };\n  }\n\n  return autoUpdate(referenceElement, pickerElement, async () => {\n    if (!referenceElement.isConnected || !referenceElement.offsetParent) {\n      if (handlePositionLost(picker)) {\n        return;\n      }\n    }\n\n    const { x, y } = await computePosition(referenceElement, pickerElement, config);\n    Object.assign(pickerElement.style, {\n      position: 'absolute',\n      left: `${x}px`,\n      top: `${y}px`\n    });\n  });\n}\n\nfunction setFixedPosition(picker: HTMLElement, position: FixedPosition): PositionCleanup {\n  picker.style.position = 'fixed';\n\n  Object.entries(position).forEach(([key, value]) => {\n    picker.style[key] = value;\n  });\n\n  /* eslint-disable @typescript-eslint/no-empty-function */\n  return () => {};\n}\n\nfunction handlePositionLost(picker: PopupPickerController) {\n  switch (picker.options.onPositionLost) {\n    case 'close':\n      picker.close();\n      return true;\n    case 'destroy':\n      picker.destroy();\n      return true;\n    case 'hold':\n      return true;\n  }\n}", "import { PopupOptions } from './types';\n\nconst defaultOptions: Partial<PopupOptions> = {\n  hideOnClickOutside: true,\n  hideOnEmojiSelect: true,\n  hideOnEscape: true,\n  position: 'auto',\n  showCloseButton: true,\n  onPositionLost: 'none'\n};\n\nexport function getOptions(options: Partial<PopupOptions> = {}): PopupOptions {\n  return { \n    ...defaultOptions,\n    rootElement: document.body,\n    ...options \n  } as PopupOptions;\n}\n", "export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 320 512\\\"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d=\\\"M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z\\\"/></svg>\"", "import {\n  animate,\n  getOptions as getPickerOptions,\n  EmojiPicker,\n  EventCallback,\n  Events,\n  createPicker,\n  FocusTrap,\n  PickerOptions,\n  ExternalEvent,\n  getPrefixedClasses,\n} from 'picmo';\nimport { PopupEvent } from './PopupEvents';\nimport { setPosition, PositionCleanup } from './positioning';\nimport { PopupOptions, Position } from './types';\nimport { getOptions } from './options';\n\nimport closeIcon from './icons/close.svg?raw';\n\ntype OpenOptions = {\n  referenceElement?: HTMLElement;\n  triggerElement?: HTMLElement;\n}\n\nconst classes = getPrefixedClasses(\n  'popupContainer',\n  'closeButton'\n);\n\nexport class PopupPickerController {\n  picker: EmojiPicker;\n  isOpen = false;\n\n  referenceElement?: HTMLElement;\n  triggerElement?: HTMLElement;\n  options: PickerOptions & PopupOptions;\n\n  private popupEl: HTMLElement;\n  private focusTrap: FocusTrap;\n  private positionCleanup: PositionCleanup;\n\n  private closeButton: HTMLButtonElement;\n  private externalEvents = new Events<PopupEvent>();\n\n  constructor(pickerOptions: Partial<PickerOptions>, popupOptions: Partial<PopupOptions>) {\n    this.options = { ...getOptions(popupOptions), ...getPickerOptions(pickerOptions) };\n\n    this.popupEl = document.createElement('div');\n    this.popupEl.classList.add(classes.popupContainer);\n    this.popupEl.classList.add(this.options.theme);\n\n    if (popupOptions.className) {\n      this.popupEl.classList.add(popupOptions.className);\n    }\n\n    if (this.options.showCloseButton) {\n      this.closeButton = document.createElement('button');\n      this.closeButton.type = 'button';\n      this.closeButton.classList.add(classes.closeButton);\n      this.closeButton.innerHTML = closeIcon;\n      this.closeButton.addEventListener('click', () => {\n        this.close();\n      });\n      this.popupEl.appendChild(this.closeButton);\n    }\n\n    const pickerContainer = document.createElement('div');\n    this.popupEl.appendChild(pickerContainer);\n\n    this.picker = createPicker({ ...this.options, rootElement: pickerContainer });\n    this.focusTrap = new FocusTrap();\n\n    this.picker.addEventListener('data:ready', () => {\n      this.focusTrap.activate(this.picker.el);\n      this.picker.setInitialFocus();\n    });\n\n    if (this.options.hideOnEmojiSelect) {\n      this.picker.addEventListener('emoji:select', () => {\n        this.close();\n        this.triggerElement?.focus();\n      });\n    }\n\n    if (this.options.hideOnClickOutside) {\n      this.onDocumentClick = this.onDocumentClick.bind(this);\n      document.addEventListener('click', this.onDocumentClick);\n    }\n\n    if (this.options.hideOnEscape) {\n      this.handleKeydown = this.handleKeydown.bind(this);\n      this.popupEl.addEventListener('keydown', this.handleKeydown);\n    }\n\n    this.referenceElement = this.options.referenceElement;\n    this.triggerElement = this.options.triggerElement;\n  }\n\n  /**\n   * Listens for a picker event.\n   *\n   * @param event The event to listen for\n   * @param callback The callback to call when the event is triggered\n   */\n  addEventListener(event: PopupEvent, callback: EventCallback) {\n    this.externalEvents.on(event, callback);\n    this.picker.addEventListener(event as ExternalEvent, callback);\n  }\n\n  removeEventListener(event: PopupEvent, callback: EventCallback) {\n    this.externalEvents.off(event, callback);\n    this.picker.removeEventListener(event as ExternalEvent, callback);\n  }\n\n  private handleKeydown(event: KeyboardEvent) {\n    if (event.key === 'Escape') {\n      this.close();\n      this.triggerElement?.focus();\n    }\n  }\n\n  /**\n   * Destroys the picker when it is no longer needed.\n   * After calling this method, the picker will no longer be usable.\n   *\n   * If this is called while the picker is open, it will be closed first.\n   *\n   * @returns a Promise that resolves when the close/destroy is complete.\n   */\n  async destroy() {\n    if (this.isOpen) {\n      await this.close();\n    }\n\n    document.removeEventListener('click', this.onDocumentClick);\n\n    this.picker.destroy();\n    this.externalEvents.removeAll();\n  }\n\n  /**\n   * Toggles the visible state of the picker\n   * If the picker is currently open, it will be closed, and if it si currently closed, it will be opened.\n   *\n   * @returns a Promise that resolves when the visibility state change is complete\n   */\n  toggle(options?: OpenOptions): Promise<void> {\n    return this.isOpen ? this.close() : this.open(options);\n  }\n\n  /**\n   * Opens the picker.\n   *\n   * @returns a Promise that resolves when the picker is finished opening\n   */\n  async open({ triggerElement, referenceElement }: OpenOptions = {}): Promise<void> {\n    if (this.isOpen) {\n      return;\n    }\n\n    if (triggerElement) {\n      this.triggerElement = triggerElement;\n    }\n\n    if (referenceElement) {\n      this.referenceElement = referenceElement;\n    }\n\n    await this.initiateOpenStateChange(true);\n\n    // Picker must be in the DOM in order to find the\n    // Hide it with opacity until it's ready to show.\n    this.popupEl.style.opacity = '0';\n\n    // Calculate position and add to DOM\n    this.options.rootElement.appendChild(this.popupEl);\n    await this.setPosition();\n\n    // Reset to the initial category and state\n    this.picker.reset(false);\n\n    // Picker is positioned and scrolled. \n    // Now we can show it with the animation.\n    await this.animatePopup(true);\n    await this.animateCloseButton(true);\n    this.picker.setInitialFocus();\n    this.externalEvents.emit('picker:open');\n  }\n\n  /**\n   * Closes the picker.\n   *\n   * @returns a Promise that resolves when the picker is finished closing\n   */\n  async close(): Promise<void> {\n    if (!this.isOpen) {\n      return;\n    }\n\n    await this.initiateOpenStateChange(false);\n    await this.animateCloseButton(false);\n    await this.animatePopup(false);\n\n    this.popupEl.remove();\n    this.picker.reset();\n    this.positionCleanup?.();\n\n    this.focusTrap.deactivate();\n    this.externalEvents.emit('picker:close');\n  }\n\n  /**\n   * Finds any pending (running) animations on the picker element.\n   *\n   * @returns an array of Animation objects that are in the 'running' state.\n   */\n  private getRunningAnimations(): Animation[] {\n    return this.picker.el.getAnimations().filter(animation => animation.playState === 'running');\n  }\n\n  /**\n   * Sets up the picker positioning.\n   */\n  private async setPosition() {\n    this.positionCleanup?.();\n      this.positionCleanup = await setPosition(\n        this,\n        this.popupEl,\n        this.referenceElement,\n        this.options.position as Position\n      );\n  }\n\n  /**\n   * Waits for all pending animations on the picker element to finish.\n   *\n   * @returns a Promise that resolves when all animations have finished\n   */\n  private awaitPendingAnimations(): Promise<Animation[]> {\n    return Promise.all(this.getRunningAnimations().map(animation => animation.finished));\n  }\n\n  /**\n   * Handles a click on the document, so that the picker is closed\n   * if the mouse is clicked outside of it.\n   *\n   * The picker will only be closed if:\n   * - The picker is currently open\n   * - The click target is not the trigger element or any of its children\n   * - The click target is not the picker or any of its children\n   *\n   * @param event The MouseEvent that was dispatched.\n   */\n  private onDocumentClick(event: MouseEvent) {\n    const clickedNode = event.target as Node;\n\n    const isClickOnTrigger = this.triggerElement?.contains(clickedNode);\n\n    if (this.isOpen && !this.picker.isPickerClick(event) && !isClickOnTrigger) {\n      this.close();\n    }\n  }\n\n  private animatePopup(openState: boolean) {\n    return animate(\n      this.popupEl,\n      {\n        opacity: [0, 1],\n        transform: ['scale(0.9)', 'scale(1)']\n      },\n      {\n        duration: 150,\n        id: openState ? 'show-picker' : 'hide-picker',\n        easing: 'ease-in-out',\n        direction: openState ? 'normal' : 'reverse',\n        fill: 'both'\n      },\n      this.options\n    );\n  }\n\n  private animateCloseButton(openState: boolean) {\n    if (this.closeButton) {\n      return animate(this.closeButton, {\n        opacity: [0, 1]\n      },\n      {\n        duration: 25,\n        id: openState ? 'show-close' : 'hide-close',\n        easing: 'ease-in-out',\n        direction: openState ? 'normal' : 'reverse',\n        fill: 'both',\n      },\n      this.options);\n    }\n  }\n\n  /**\n   * Prepares for an animation either for opening or closing the picker.\n   * If other animations are still running (this will happen when toggled rapidly), this will wait for them to finish.\n   *\n   * It will mark the new open state immediately then wait for pending animations to finish.\n   *\n   * @param openState The desired open state\n   */\n  private async initiateOpenStateChange(openState: boolean) {\n    this.isOpen = openState;\n    await this.awaitPendingAnimations();\n  }\n}\n", "import { PickerOptions, createStyleInjector } from 'picmo';\nimport { PopupOptions } from './types';\nimport { PopupPickerController } from './popupPicker';\n\nimport css from './styles/index.css?inline';\n\nexport * from './types';\nexport { PopupPickerController };\n\nconst styleInject = createStyleInjector();\n\nexport function createPopup(pickerOptions: Partial<PickerOptions>, popupOptions: Partial<PopupOptions>) {\n  styleInject(css);\n\n  const popup = new PopupPickerController({\n    autoFocus: 'auto',\n    ...pickerOptions\n  }, popupOptions);\n  return popup;\n}\n"],
  "mappings": "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",
  "names": ["LATEST_EMOJI_VERSION", "getFetchUrl", "path", "version", "cdnUrl", "fetchUrl", "fetchFromCDN", "options", "local", "opts", "storage", "cacheKey", "cachedData", "response", "data", "ALIASES", "fetchShortcodes", "locale", "preset", "_ALIASES$preset", "joinShortcodesToEmoji", "emoji", "shortcodeDatasets", "list", "dataset", "shortcodes", "code", "skin", "flattenEmojiData", "emojis", "skins", "baseEmoji", "skinEmoji", "joinShortcodes", "fetchEmojis", "compact", "flat", "presets", "promise", "customLocale", "customPreset", "fetchMessages", "getEmojiForEvent", "event", "emojiElement", "e", "shouldAnimate", "_a", "matcher", "caseInsensitiveIncludes", "str", "search", "throttle", "fn", "wait", "timeout", "debounce", "args", "animate", "element", "keyframes", "pickerOptions", "propertyIndex", "finalState", "result", "key", "values", "toElement", "html", "template", "computeHash", "obj", "arr", "hashBuffer", "b", "getPrefixedClasses", "classNames", "className", "prefixClassName", "empty", "replaceChildren", "parent", "children", "isStorageAvailable", "isSessionStorageAvailable", "isLocalStorageAvailable", "getEmojiRecord", "queryMatches", "query", "categories", "category", "tag", "DataStore", "rules", "emojiVersion", "applyRulesToEmoji", "rule", "applyRules", "instances", "InMemoryStoreFactory", "InMemoryStore", "includeList", "a", "emojiResults", "customEmojis", "matchingEmojis", "matchingCustom", "results", "meta", "getCdnUrls", "base", "getEtag", "url", "getEtags", "emojisUrl", "messagesUrl", "checkUpdates", "db", "emojisEtag", "messagesEtag", "etags", "storedEmojisEtag", "storedMessagesEtag", "messages", "checkLocalUpdates", "hash", "storedHash", "openDatabase", "factory", "existingDb", "initDatabaseFromCdn", "initDatabaseWithLocalData", "initDatabase", "staticMessages", "staticEmojis", "FocusTrap", "rootElement", "_a", "event", "referenceElement", "targetElement", "lightTheme", "darkTheme", "autoTheme", "getPrefixedClasses", "View", "template", "classes", "parent", "customEmojis", "events", "pickerId", "args", "i18n", "renderer", "emojiDataPromise", "emojiData", "options", "templateData", "handler", "result", "key", "binding", "observer", "list", "record", "shouldAnimate", "target", "className", "clock", "flag", "frown", "gamepad", "lightbulb", "mug", "plane", "robot", "sad", "search", "smiley", "symbols", "tree", "users", "warning", "xmark", "createIcon", "iconName", "svg", "el", "toElement", "prefixClassName", "icons", "categoryIcons", "icon", "name", "size", "defaultOptions", "_templateFn", "_mode", "_renderChildViews", "renderChildViews_fn", "_bindIcons", "bindIcons_fn", "_bindPlaceholders", "bindPlaceholders_fn", "Template", "templateFn", "__privateAdd", "__privateSet", "data", "__privateGet", "__privateMethod", "placeholders", "asyncViews", "placeholder", "view", "iconKey", "replacement", "Image", "classNames", "src", "img", "Renderer", "content", "urlResolver", "image", "emoji", "lazyLoader", "resolver", "contentElement", "url", "label", "additionalClasses", "NativeRenderer", "hexcode", "en", "DATABASE_NAME", "IndexedDbStoreFactory", "locale", "IndexedDbStore", "resolve", "reject", "request", "DataStore", "emojiStore", "store", "emojisEtag", "messagesEtag", "meta", "transaction", "property", "groups", "emojis", "hash", "tasks", "categoryStore", "categories", "category", "includeList", "a", "b", "emojiVersion", "groupsIndex", "records", "e", "getEmojiRecord", "applyRules", "query", "results", "cursor", "queryMatches", "error", "storeName", "mode", "callback", "storeNames", "stores", "objects", "object", "createStorage", "value", "index", "RecentsProvider", "STORAGE_KEY", "WebStorageProvider", "storage", "maxCount", "recents", "recent", "LocalStorageProvider", "isLocalStorageAvailable", "getOptions", "_events", "_getBindings", "getBindings_fn", "_addListener", "addListener_fn", "Events", "context", "bindings", "h", "once", "globalConfig", "AppEvents", "ExternalEvents", "BaseEmojiCategory", "showVariants", "active", "focusTarget", "performFocus", "template$b", "Emoji", "FocusGrid", "columnCount", "emojiCount", "initialRow", "initialColumn", "wrap", "row", "column", "previousIndex", "template$a", "EmojiContainer", "preview", "fullHeight", "_b", "_c", "_d", "targetView", "header", "emojiArea", "from", "to", "getEmojiForEvent", "button", "template$9", "EmojiCategory", "RecentEmojiContainer", "existing", "newView", "EmojiView", "excess", "i", "template$8", "RecentEmojiCategory", "provider", "template$7", "CustomEmojiCategory", "LazyLoader", "root", "entries", "entry", "element", "categoryClasses", "getCategoryClass", "getFocusTarget", "focus", "EmojiArea", "categoryTabs", "throttle", "categoryEmojiElements", "Category", "c", "categoryView", "scroll", "categoryIndex", "targetPosition", "currentPosition", "maxScroll", "targetCategory", "errorTemplate", "classList", "message", "ErrorMessage", "template$5", "DataError", "db", "initDatabase", "tagTemplate", "tag", "EmojiPreview", "replaceChildren", "tags", "empty", "clearSearchButtonTemplate", "searchTemplate", "Search", "debounce", "accessory", "searchResults", "template$3", "animationOptions", "overlayAnimation", "popupAnimation", "VariantPopup", "animate", "hideOptions", "newIndex", "currentFocusedEmoji", "newFocusedEmoji", "baseEmoji", "variants", "variant", "template$2", "CategoryTab", "changeFocusable", "template$1", "CategoryTabs", "hasOverflowRight", "hasOverflowLeft", "oldCategory", "newCategory", "step", "TEST_EMOJIS", "determineEmojiVersion", "supportedEmoji", "supportsEmoji", "repeat", "count", "showHeader", "renderPicker", "theme", "renderPlaceholder", "categoryCount", "showSearch", "showCategoryTabs", "showPreview", "variableNames", "EmojiPicker", "propertyName", "currentTheme", "container", "isShortcut", "option", "errorView", "height", "currentView", "LATEST_EMOJI_VERSION", "clickedNode", "isClickInsidePicker", "isClickOnVariantPopup", "currentFocus", "ViewFactory", "constructor", "_dictionary", "Bundle", "dictionary", "fallback", "styleInject", "css", "ref", "insertAt", "head", "style", "createStyleInjector", "isInjected", "initData", "pickerIndex", "getPickerId", "createPicker", "finalOptions", "custom", "picker", "langDe", "langFi", "langFr", "langNl", "langNo", "langSv", "getSide", "placement", "getAlignment", "getMainAxisFromPlacement", "getLengthFromAxis", "axis", "computeCoordsFromPlacement", "_ref", "rtl", "reference", "floating", "commonX", "commonY", "mainAxis", "length", "commonAlign", "side", "isVertical", "coords", "computePosition", "config", "strategy", "middleware", "platform", "rects", "x", "y", "statefulPlacement", "middlewareData", "resetCount", "i", "name", "fn", "nextX", "nextY", "data", "reset", "expandPaddingObject", "padding", "getSideObjectFromPadding", "rectToClientRect", "rect", "detectOverflow", "middlewareArguments", "options", "_await$platform$isEle", "elements", "boundary", "rootBoundary", "elementContext", "altBoundary", "paddingObject", "element", "clippingClientRect", "elementClientRect", "min", "max", "within", "min$1", "value", "max$1", "hash$1", "getOppositePlacement", "matched", "getAlignmentSides", "alignment", "mainAlignmentSide", "hash", "getOppositeAlignmentPlacement", "sides", "allPlacements", "acc", "getPlacementList", "autoAlignment", "allowedPlacements", "autoPlacement", "_middlewareData$autoP", "_middlewareData$autoP2", "_middlewareData$autoP3", "_middlewareData$autoP4", "_placementsSortedByLe", "detectOverflowOptions", "placements", "overflow", "currentIndex", "currentPlacement", "main", "cross", "currentOverflows", "allOverflows", "nextPlacement", "placementsSortedByLeastOverflow", "a", "b", "placementThatFitsOnAllSides", "overflows", "resetPlacement", "getExpandedPlacements", "oppositePlacement", "flip", "_middlewareData$flip", "initialPlacement", "checkMainAxis", "checkCrossAxis", "specifiedFallbackPlacements", "fallbackStrategy", "flipAlignment", "fallbackPlacements", "overflowsData", "_middlewareData$flip$", "_middlewareData$flip2", "nextIndex", "_overflowsData$map$so", "d", "convertValueToCoords", "mainAxisMulti", "crossAxisMulti", "rawValue", "crossAxis", "alignmentAxis", "offset", "diffCoords", "getCrossAxis", "shift", "limiter", "mainAxisCoord", "crossAxisCoord", "minSide", "maxSide", "limitedCoords", "isWindow", "getWindow", "node", "ownerDocument", "getComputedStyle", "getNodeName", "getUAString", "uaData", "item", "isHTMLElement", "isElement", "isNode", "isShadowRoot", "OwnElement", "isOverflowElement", "overflowX", "overflowY", "isTableElement", "isContainingBlock", "isFirefox", "css", "isLayoutViewport", "round", "getBoundingClientRect", "includeScale", "isFixedStrategy", "_win$visualViewport$o", "_win$visualViewport", "_win$visualViewport$o2", "_win$visualViewport2", "clientRect", "scaleX", "scaleY", "win", "addVisualOffsets", "width", "height", "getDocumentElement", "getNodeScroll", "getWindowScrollBarX", "isScaled", "getRectRelativeToOffsetParent", "offsetParent", "isOffsetParentAnElement", "documentElement", "scroll", "offsets", "offsetRect", "getParentNode", "getTrueOffsetParent", "composedOffsetParent", "ancestor", "foundInsideSlot", "assignedSlot", "newOffsetParent", "hadStyleAttribute", "oldDisplay", "getContainingBlock", "currentNode", "parent", "getOffsetParent", "window", "getDimensions", "convertOffsetParentRelativeRectToViewportRelativeRect", "getViewportRect", "html", "visualViewport", "layoutViewport", "getDocumentRect", "_element$ownerDocumen", "body", "getNearestOverflowAncestor", "parentNode", "getOverflowAncestors", "list", "_node$ownerDocument", "scrollableAncestor", "isBody", "target", "updatedList", "contains", "child", "rootNode", "next", "getInnerBoundingClientRect", "top", "left", "getClientRectFromClippingAncestor", "clippingParent", "getClippingAncestors", "clippingAncestors", "clipperElement", "getClippingRect", "firstClippingAncestor", "clippingRect", "accRect", "clippingAncestor", "autoUpdate", "update", "_ancestorScroll", "_ancestorResize", "elementResize", "animationFrame", "ancestorScroll", "ancestorResize", "ancestors", "observer", "initialUpdate", "frameId", "prevRefRect", "frameLoop", "nextRefRect", "_observer", "computePosition$1", "setPosition", "picker", "pickerElement", "referenceElement", "position", "setRelativePosition", "setFixedPosition", "handlePositionLost", "key", "defaultOptions", "getOptions", "closeIcon", "classes", "getPrefixedClasses", "PopupPickerController", "pickerOptions", "popupOptions", "Events", "getPickerOptions", "pickerContainer", "createPicker", "FocusTrap", "_a", "event", "callback", "triggerElement", "animation", "clickedNode", "isClickOnTrigger", "openState", "animate", "styleInject", "createStyleInjector", "createPopup"]
}
